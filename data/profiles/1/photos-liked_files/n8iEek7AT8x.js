/*!CK:854662437!*//*1432925731,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["RLgEP"]); }

__d("CreditCardFormParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ACCOUNT_ID:"account_id",ACCOUNT_COUNTRY_CODE:"account_country_code",APP_ID:"app_id",CARD_EXPIRATION:"exp",CARD_FBID:"cc_fbid",CARD_ID:"cc_id",CARD_TYPE:"cardType",CITY:"city",CONTEXT_ID:"context_id",COUNTRY:"country",CSC_LENGTH:"csc_length",EMAIL:"email",FIRST_NAME:"firstName",TRACKING_ID:"tracking_id",JSFAIL_SOURCE:"jsfail_source",KEYPRESS_TIMES:"kpts",LAST_NAME:"lastName",MONTH:"month",STATE:"state",STREET:"street",STREET_2:"street2",VALIDATE_ADDRESS:"validate_address",VALIDATE_NAME:"validate_name",VALIDATE_ZIP:"validate_zip",YEAR:"year",ZIP:"zip",VALIDATOR_CHECKS:"checks",CARD_NUMBER:"creditCardNumber",CSC:"csc",CARD_NUMBER_FIRST_6:"creditCardNumber_first6",CARD_NUMBER_LAST_4:"creditCardNumber_last4",CARD_NUMBER_TOKEN:"creditCardNumber_token",CSC_TOKEN:"csc_token",AUTH_LEVEL_FLAG:"auth_level",AUTH_AMOUNT:"auth_amount",AUTH_CURRENCY:"auth_currency",AUTO_EXPAND_AUTH_LEVEL_FLAG:"auto_expand_auth_level",PAYMENT_ITEM_TYPE:"payment_item_type",CREDENTIAL_ID:"credential_id"};},null);
__d("CreditCardTypeEnum",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={VISA:86,MASTERCARD:77,DISCOVER:68,AMERICANEXPRESS:65,DINERSCLUB:64,JCB:74};},null);
__d("MercuryActionStatus",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={UNSENT:0,SUCCESS:1,UNCONFIRMED:3,FAILED_UNKNOWN_REASON:4,UNABLE_TO_CONFIRM:5,RESENT:6,RESENDING:7,ERROR:10};},null);
__d("MercuryActionType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={LOG_MESSAGE:"ma-type:log-message",USER_GENERATED_MESSAGE:"ma-type:user-generated-message",CHANGE_READ_STATUS:"ma-type:change_read_status",MARK_THREAD_SEEN:"ma-type:mark_thread_seen",CHANGE_MUTE_SETTINGS:"ma-type:change-mute-settings",SEND_MESSAGE:"ma-type:send-message",UPDATE_ACTION_ID:"ma-type:update-action-id",DELETE_MESSAGES:"ma-type:delete-messages",MARK_MESSAGES_SPAM:"ma-type:mark-messages-spam",DELETE_THREAD:"ma-type:delete-thread",CHANGE_ARCHIVED_STATUS:"ma-type:change-archived-status",CHANGE_FOLDER:"ma-type:change-folder",ADD_PARTICIPANTS:"ma-type:add-participants",CANCEL_ATTACHMENT_PLACEHOLDER:"ma-type:cancel-attachment-placeholder",CONFIRM_ATTACHMENT_PLACEHOLDER:"ma-type:confirm-attachment-placeholder",UNPIN_THREAD:"ma-type:unpin-thread",CHANGE_FLAG:"ma-type:change_flag"};},null);
__d("MercuryAPIArgsSource",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={CHAT:"chat",JEWEL:"jewel",MERCURY:"mercury",MERCURYSYNC:"mercury_sync",WEBMESSENGER:"web_messenger",MESSENGER:"messenger"};},null);
__d("MercuryAttachmentContentType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={PHOTO:"attach:image",VIDEO:"attach:video",MUSIC:"attach:music",VOICE:"attach:voice",TEXT:"attach:text",MSWORD:"attach:ms:word",MSXLS:"attach:ms:xls",MSPPT:"attach:ms:ppt",ORION:"attach:orion",SHOERACK_INVITATION:"attach:shoerackinvite",UNKNOWN:"attach:unknown"};},null);
__d("MercuryAttachmentType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ERROR:"error",FILE:"file",PHOTO:"photo",STICKER:"sticker",SHARE:"share",UNKNOWN:"unknown",VIDEO:"video",ANIMATED_IMAGE:"animated_image"};},null);
__d("MercuryAudioType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={AudioClip:"fb_voice_message",VoiceMessageWithTranscript:"fb_voice_message_with_transcript"};},null);
__d("MercuryErrorType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SERVER:1,TRANSPORT:2,TIMEOUT:3};},null);
__d("MercuryGenericConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MAX_THREAD_NAME_LENGTH:250};},null);
__d("MercuryGlobalActionType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MARK_ALL_READ:"mga-type:mark-all-read"};},null);
__d("MercuryLogMessageType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SUBSCRIBE:"log:subscribe",UNSUBSCRIBE:"log:unsubscribe",VIDEO_CALL:"log:video-call",PHONE_CALL:"log:phone-call",THREAD_NAME:"log:thread-name",THREAD_IMAGE:"log:thread-image",SERVER_ERROR:"log:error-msg",LIVE_LISTEN:"log:live-listen",WALLPAPER:"log:wallpaper",ORION:"log:orion",SWITCH_TO_WORK:"log:switch",PAGE_REPLY:"log:page-reply",GENERIC_ADMIN_TEXT:"log:generic-admin-text"};},null);
__d("MercuryMessageSourceTags",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={CHAT:"source:chat",EMAIL:"source:email",MESSENGER:"source:messenger",MOBILE:"source:mobile"};},null);
__d("MercuryParticipantTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={USER:"user",THREAD:"thread",EVENT:"event",PAGE:"page",FRIEND:"friend",FB4C:"fb4c",NON_FRIEND:"non_friend"};},null);
__d("MercuryPayloadSource",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={UNKNOWN:"unknown",CLIENT_CHANNEL_MESSAGE:"client_channel_message",CLIENT_SEND_MESSAGE:"client_send_message",CLIENT_CHANGE_ARCHIVED_STATUS:"client_change-archived_status",CLIENT_CHANGE_FOLDER:"client_change_folder",CLIENT_CHANGE_MUTE_SETTINGS:"client_change_mute_settings",CLIENT_CHANGE_READ_STATUS:"client_change_read_status",CLIENT_MARK_THREAD_SEEN:"client_mark_thread_seen",CLIENT_ADD_PARTICIPANTS:"client_add_participants",CLIENT_FETCH_PARTICIPANTS:"client_fetch_participants",CLIENT_DELETE_MESSAGES:"client_delete_messages",CLIENT_MARK_MESSAGES_SPAM:"client_mark_messages_spam",CLIENT_DELETE_THREAD:"client_delete_thread",CLIENT_HANDLE_ERROR:"client_handle_error",CLIENT_UNPIN_THREAD:"client_unpin_thread",CLIENT_CHANGE_FLAG:"client_change_flag",SERVER_INITIAL_DATA:"server_initial_data",SERVER_SEND_MESSAGE:"server_send_message",SERVER_CONFIRM_MESSAGES:"server_confirm_messages",SERVER_CHANGE_ARCHIVED_STATUS:"server_change_archived_status",SERVER_CHANGE_READ_STATUS:"server_change_read_status",SERVER_MARK_FOLDER_READ:"server_mark_folder_read",SERVER_MARK_SEEN:"server_mark_seen",SERVER_FETCH_PARTICIPANTS:"server_fetch_participants",SERVER_FETCH_THREAD_INFO:"server_fetch_thread_info",SERVER_FETCH_THREADLIST_INFO:"server_fetch_threadlist_info",SERVER_STANDALONE_NOTIFICATIONS:"server_standalone_notifications",SERVER_THREAD_SYNC:"server_thread_sync",SERVER_TAB_PRESENCE:"server_tab_presence",SERVER_UNREAD_THREADS:"server_unread_threads",SERVER_SEARCH:"server_search",SERVER_CHANGE_FLAG:"server_change_flag"};},null);
__d("MercurySendMessageFields",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"};},null);
__d("MercurySourceType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={CHAT_ORCA:"source:chat:orca",CHAT_IPHONE:"source:chat:iphone",CHAT_JABBER:"source:chat:jabber",CHAT_MEEBO:"source:chat:meebo",CHAT_WEB:"source:chat:web",CHAT_TEST:"source:chat:test",CHAT_FORWARD_DIALOG:"source:chat:forward",CHAT:"source:chat",EMAIL:"source:email",EVENT_MESSAGE_BLAST:"source:event_message_blast",GIGABOXX_API:"source:gigaboxx:api",GIGABOXX_BLAST:"source:gigaboxx:blast",GIGABOXX_EMAIL_REPLY:"source:gigaboxx:emailreply",GIGABOXX_MOBILE:"source:gigaboxx:mobile",GIGABOXX_WAP:"source:gigaboxx:wap",GIGABOXX_WEB:"source:gigaboxx:web",LEIA:"source:leia",MESSENGER_WEB:"source:messenger:web",SAM_UFI:"source:sam:ufi",SHARE_DIALOG:"source:share:dialog",SEND_PLUGIN:"source:sendplugin",SMS:"source:sms",TEST:"source:test",TITAN_WAP:"source:titan:wap",TITAN_M_BASIC:"source:titan:m_basic",TITAN_M_FREE:"source:titan:m_free_basic",TITAN_M_JAPAN:"source:titan:m_japan",TITAN_M_MINI:"source:titan:m_mini",TITAN_M_TOUCH:"source:titan:m_touch",TITAN_M_APP:"source:titan:m_app",TITAN_M_TABLET:"source:titan:m_tablet",TITAN_M_ZERO:"source:titan:m_zero",TITAN_M_TALK:"source:titan:m_talk",TITAN_WEB:"source:titan:web",TITAN_FACEWEB_ANDROID:"source:titan:faceweb_android",TITAN_FACEWEB_BUFFY:"source:titan:faceweb_buffy",TITAN_FACEWEB_IPAD:"source:titan:faceweb_ipad",TITAN_FACEWEB_IPHONE:"source:titan:faceweb_iphone",TITAN_FACEWEB_UNKNOWN:"source:titan:faceweb_unknown",TITAN_API:"source:titan:api",TITAN_API_MOBILE:"source:titan:api_mobile",TITAN_ORCA:"source:titan:orca",TITAN_EMAIL_REPLY:"source:titan:emailreply",MOBILE:"source:mobile",PAGE_PLATFORM_API:"source:page_platform_api",UNKNOWN:"source:unknown",WEB:"source:web",HELPCENTER:"source:helpcenter",NEW_SHARE_DIALOG:"source:share:dialog:new",PAID_PROMOTION:"source:paid_promotion",BUFFY_SMS:"source:buffy:sms",WEBRTC_MOBILE:"source:webrtc:mobile",MESSENGER_COMMERCE:"source:messenger:commerce"};},null);
__d("MercuryThreadMode",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={EMAIL_ORIGINATED:1,TITAN_ORIGINATED:2,OBJECT_ORIGINATED:3};},null);
__d("MercuryTimePassed",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TODAY:0,WEEK_AGO:1,MONTH_AGO:2,CURRENT_YEAR:3,OTHER_YEAR:4};},null);
__d("MessagesViewerSetID",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MESSAGES:"messages",MESSAGES_VIEW_ALL_IN_THREAD:"messages:view_all_in_thread"};},null);
__d("MessagingEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={DELETE:"delete",DELETE_MESSAGES:"delete_messages",DELIVER:"deliver",ERROR:"error",READ:"read",REPORT_SPAM:"report_spam",REPORT_SPAM_MESSAGES:"report_spam_messages",UNMARK_SPAM:"unmark_spam",SUBSCRIBE:"subscribe",CHANGE_MUTE_SETTINGS:"change_mute_settings",TAG:"tag",UNREAD:"unread",UNSUBSCRIBE:"unsubscribe",DELIVER_LOG:"deliver_log",MORE_THREADS:"more_threads",READ_ALL:"read_all",READ_RECEIPT:"read_receipt",DELIVERY_RECEIPT:"delivery_receipt",SENT_PUSH:"sent_push",DELIVER_FAST_PAST:"deliver_fast_path",MESSENGER_STATUS:"messenger_status",UPDATE_PINNED_THREADS:"update_pinned_threads",CHANGE_PAGE_THREAD_FLAG:"change_page_thread_flag"};},null);
__d("MessagingTag",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={GROUPS:"groups",UNREAD:"unread",FLAGGED:"flagged",ACTION_ARCHIVED:"action:archived",INBOX:"inbox",OTHER:"other",EVENT:"event",SENT:"sent",SMS_MUTE:"sms_mute",SPAM:"spam",UPDATES:"broadcasts_inbox",BCC:"header:bcc",FILTERED_CONTENT:"filtered_content",UNAVAILABLE_ATTACHMENT:"unavailable_attachment",ARCHIVED:"archived",EMAIL:"email",VOICEMAIL:"voicemail",SPAM_SPOOFING:"spam:spoofing",SPOOF_WARNING:"MTA:spoof_warning",SMS_TAG_ROOT:"SMSShortcode:",APP_ID_ROOT:"app_id:",DOMAIN_AUTH_PASS:"MTA:dmarc:pass",DOMAIN_AUTH_FAIL:"MTA:dmarc:fail",MTA_SYSTEM_MESSAGE:"MTA:system_message",EMAIL_MESSAGE:"source:email"};},null);
__d("MNCommerceBubbleType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FB_RETAIL_RECEIPT:1,FB_RETAIL_CANCELLATION:2,FB_RETAIL_SHIPMENT:3,FB_RETAIL_SHIPMENT_TRACKING_EVENT_ETA:4,FB_RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:5,FB_RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:6,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:7,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:8,FB_RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:9,FB_RETAIL_SHIPMENT_ETA:10};},null);
__d("MNCommerceLoggerEvents",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={GEN_CALL:"gen_call",DUPLICATE_CALL:"duplicate_call",ERROR:"error",GEN_SHIPMENT_ENT:"gen_shipment_ent",GEN_SHIPMENT_TRACKING_ENT:"gen_shipment_tracking_ent",SHIPMENT_NOTIFICATION_READY:"shipment_notification_ready",SHIPMENT_NOTIFICATION_SENT:"shipment_notification_sent",ASYNC_EXECUTION:"async_execution",ASYNC_SCHEDULE:"async_schedule",ASYNC_THROTTLE:"async_throttle",ASYNC_USER_ACCOUNT_DISABLED:"async_user_account_disabled",ASYNC_GEN_DATA_ERROR:"async_gen_data_error",TRACKING_SHUTDOWN_WITH_EXCEPTION_ERROR:"tracking_shutdown_with_exception",TRACKING_SHUTDOWN_WITH_RETRY_ERROR:"tracking_shutdown_with_retry",DELIVERED_STATS:"delivered_stats",USER_LINKED:"user_linked",USER_LINK_FAILED:"user_link_failed",USER_TOKEN_DECRYPTION_FAILED:"user_token_decryption_failed",USER_TOKEN_DELIVERY_ATTEMPT:"user_token_delivery_attempt",USER_TOKEN_DELIVERED:"user_token_delivered",USER_TOKEN_DELIVERY_FAILED:"user_token_delivery_failed",USER_TOKEN_CRITICAL_LOOKUP:"user_token_critical_lookup",USER_TOKEN_LOOKUP_FAILED:"user_token_lookup_failed",USER_UNLINKED:"user_unlinked",USER_UNLINK_FAILED:"user_unlink_failed",USER_UNLINK_BUSINESS_NOTIFIED:"user_unlink_business_notified",USER_UNLINK_BUSINESS_NOTIFICATION_FAILED:"user_unlink_business_notification_failed",PLUGIN_CLIENT_RENDERED:"plugin_client_rendered",PLUGIN_RENDERED:"plugin_rendered",PLUGIN_HIDDEN_ALREADY_LINKED:"plugin_hidden_already_linked",PLUGIN_BLOCKED:"plugin_blocked",PLUGIN_UPDATES_DISALLOWED:"plugin_updates_disallowed",PLUGIN_UPDATES_REALLOWED:"plugin_updates_reallowed",PLUGIN_ASSOC_MUTATE_FAILED:"plugin_assoc_mutate_failed",PLUGIN_ASSOC_READ_FAILED:"plugin_assoc_read_failed",ORDER_CANCELLED:"order_cancelled",ORDER_CANCELLATION_FAILED:"order_cancellation_failed",SEND_MESSAGE_WITH_ROBOTEXT:"send_message_with_robotext",SEND_MESSAGE_WITH_ATTACHMENT:"send_message_with_attachment",SEND_MESSAGE_WITH_LOG_MESSAGE:"send_message_with_log_message",SEND_MESSAGE_FAILURE:"send_message_failure",DIALOG_OPENED:"dialog_opened",DIALOG_CLOSED:"dialog_closed",DIALOG_LOAD_ERROR:"dialog_load_error",DIALOG_LOAD_SUCCESS:"dialog_load_success",NOT_YOU_CLICKED:"not_you_clicked",RECEIPTS:"receipts",CANCELLATIONS:"cancellations",SHIPMENTS:"shipments",PROCESSED_RECEIPTS:"processedreceipts"};},null);
__d("P2PChannelType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TRANSFER_STATUS_CHANGED:"P2P\/TransferStatusChanged"};},null);
__d("P2PPasswordProtectionParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={STATUS:"status"};},null);
__d("P2PPasswordProtectionStatusTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={NOT_SET:0,DISABLED:1,ENABLED:2};},null);
__d("P2PPaymentCreditCardsTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SENDING:1,RECEIVING:2};},null);
__d("P2PPaymentLoggerEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ACTN_ADD_CREDIT_CARD:"Actn_AddCreditCard",ACTN_UPDATE_CREDIT_CARD:"Actn_UpdateCreditCard",ACTN_REMOVE_CREDIT_CARD:"Actn_RemoveCreditCard",ACTN_UNLOCK_CREDIT_CARD:"Actn_UnlockCreditCard",ACTN_VALIDATE_CARD:"Actn_ValidateCard",ACTN_TRANSFER_MONEY:"Actn_TransferMoney",ACTN_TRANSFER_MONEY_REVERT:"Actn_TransferMoneyRevert",ACTN_TRANSFER_MONEY_CREATE_CONTEXT:"Actn_TransferMoneyCreateContext",ACTN_ACCEPT_MONEY:"Actn_AcceptMoney",ACTN_DECLINE_MONEY:"Actn_DeclineMoney",ACTN_SET_PRIMARY:"Actn_SetPrimary",ACTN_WITHDRAW_MONEY:"Actn_WithdrawMoney",ACTN_SEND_TRANSFER_MESSAGE:"Actn_SendTransferMessage",ACTN_SEND_TRANSFER_EMAIL:"Actn_SendTransferEmail",ACTN_SEND_EXPIRE_NOTIFICATIONS:"Actn_SendExpireNotifications",ACTN_CREATE_PAYMENT_REQUEST:"Actn_CreatePaymentRequest",ACTN_ACCEPT_PAYMENT_REQUEST:"Actn_AcceptPaymentRequest",ACTN_DECLINE_PAYMENT_REQUEST:"Actn_DeclinePaymentRequest",ACTN_AUTH_FOR_SENDER_REVIEW:"Actn_AuthForSenderReview",ACTN_COMPLETE_SENDER_REVIEW:"Actn_CompleteSenderReview",ACTN_COMPLETE_RECEIVER_REVIEW:"Actn_CompleteReceiverReview",ACTN_SUBMIT_VERIFICATION_STEP:"Actn_SubmitVerificationStep",ACTN_COMPLETE_SENDER_VERIFICATION:"Actn_CompleteSenderVerification",ACTN_COMPLETE_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_VERIFICATION:"Actn_CancelSenderVerification",ACTN_CANCEL_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_RISK:"Actn_CancelSenderRisk",ACTN_CANCEL_EXPIRE:"Actn_CancelExpire",ACTN_CANCEL_FOR_SAME_CARD:"Actn_CancelForSameCard",ACTN_CANCEL_BY_CUSTOMER_SERVICE:"Actn_CancelByCustomerService",ACTN_CANCEL_RECEIVER_REVIEW:"Actn_CancelReceiverReview",ACTN_CANCEL_SENDER_REVIEW:"Actn_CancelSenderReview",ACTN_CANCEL_ALL_PENDING_TRANSFERS:"Actn_CancelAllPendingTransfers",ACTN_ADD_PIN:"Actn_AddPIN",ACTN_UPDATE_PIN:"Actn_UpdatePIN",ACTN_REMOVE_PIN:"Actn_RemovePIN",ACTN_RESET_PIN:"Actn_ResetPIN",ACTN_ENABLE_TOUCH_ID:"Actn_EnableTouchID",ACTN_VERIFY_TOUCH_ID:"Actn_VerifyTouchID",ACTN_DISABLE_TOUCH_ID:"Actn_DisableTouchID",UI_ACTN_INITIATE_SEND:"UI_Actn_Initiate_Send",UI_ACTN_CANCEL_SEND:"UI_Actn_Send_Money_Cancelled",UI_ACTN_INITIATE_ADD_CARD:"UI_Actn_Initiate_Add_Card",UI_ACTN_CANCEL_ADD_CARD:"UI_Actn_Cancel_Add_Card",UI_ACTN_CONFIRM_CARD_DETAILS:"UI_Actn_Confirm_Card_Details",UI_ACTN_ACCEPT_WITH_CARD:"UI_Actn_Accept_With_Card",UI_ACTN_ADD_CARD_SUCCESS:"UI_Actn_Add_Card_Success",UI_ACTN_ADD_CARD_FAIL:"UI_Actn_Add_Card_Fail",UI_ACTN_CONFIRM_SEND:"UI_Actn_Confirm_Send",UI_ACTN_SEND_SUCCESS:"UI_Actn_Send_Success",UI_ACTN_SEND_MONEY_CANCELLED:"UI_Actn_Send_Money_Cancelled",UI_ACTN_SEND_FAIL:"UI_Actn_Send_Fail",UI_ACTN_INITIATE_EDIT_CARD:"UI_Actn_Initiate_Edit_Card",UI_ACTN_CANCEL_EDIT_CARD:"UI_Actn_Cancel_Edit_Card",UI_ACTN_CONFIRM_EDIT_CARD_DETAILS:"UI_Actn_Confirm_Edit_Card_Details",UI_ACTN_EDIT_CARD_SUCCESS:"UI_Actn_Edit_Card_Success",UI_ACTN_EDIT_CARD_FAIL:"UI_Actn_Edit_Card_Fail",UI_ACTN_INITIATE_REMOVE_CARD:"UI_Actn_Initiate_Remove_Card",UI_ACTN_CONFIRM_REMOVE_CARD:"UI_Actn_Confirm_Remove_Card",UI_ACTN_REMOVE_CARD_SUCCESS:"UI_Actn_Remove_Card_Success",UI_ACTN_REMOVE_CARD_FAIL:"UI_Actn_Remove_Card_Fail",UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX:"UI_Actn_Initiate_Password_Protection_NUX",UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_In_Password_Protection_NUX",UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_Out_Password_Protection_NUX",UI_ACTN_ENABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Enabled_Password_Protection_Setting",UI_ACTN_DISABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Disabled_Password_Protection_Setting",UI_ACTN_SEND_CLICKED:"UI_Actn_Send_Clicked",UI_ACTN_VERIFY_CSC:"UI_Actn_Verify_CSC",UI_ACTN_CONFIRM_AMOUNT:"UI_Actn_Confirm_Amount",UI_ACTN_EDIT_CARD:"UI_Actn_Edit_Card",UI_ACTN_CHANGE_CARD:"UI_Actn_Change_Card",UI_ACTN_INITIATE_SEND_TRIGGER:"UI_Actn_Initiate_Send_Trigger",UI_ACTN_INITIATE_GROUP_SEND:"UI_Actn_Initiate_Group_Send",UI_ACTN_GROUP_SEND_CANCELLED:"UI_Actn_Group_Send_Cancelled",UI_ACTN_INITIATE_GROUP_SEND_TRIGGER:"UI_Actn_Initiate_Group_Send_Trigger",UI_ACTN_GROUP_SEND_RECIPIENT_PICKED:"UI_Actn_Group_Send_Recipient_Picked",UI_ACTN_3RD_PARTY_LOG_MESSAGE_CLICKED:"UI_Actn_3rd_Party_Log_Message__Clicked",UI_ACTN_3RD_PARTY_LOG_MESSAGE_TRY_CLICKED:"UI_Actn_3rd_Party_Log_Message_Try_Clicked",UI_ACTN_3RD_PARTY_LOG_MESSAGE_CANCELLED:"UI_Actn_3rd_Party_Log_Message_Cancelled",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CLICKED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Clicked",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CANCELLED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Cancelled"};},null);
__d("P2PPaymentLoggerEventFlow",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={UI_FLOW_P2P_SEND:"UI_Flow_P2P_Send",UI_FLOW_P2P_RECEIVE:"UI_Flow_P2P_Receive",UI_FLOW_P2P_SETTINGS:"UI_Flow_P2P_Settings",UI_FLOW_P2P_GROUP_SEND:"UI_Flow_P2P_Group_Send"};},null);
__d("P2PTransferParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TRANSFER_ID:"transfer_id",STATUS:"status",SENDER_STATUS:"sender_status",RECEIVER_STATUS:"receiver_status",RISK_RESULT:"risk_result"};},null);
__d("P2PTransferStatus",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={PENDING_SENDER_MANUAL_REVIEW:1,PENDING_SENDER_VERIFICATION:2,CANCELED_SENDER_RISK:3,PENDING_RECIPIENT_NUX:4,CANCELED_DECLINED:5,PENDING_RECIPIENT_VERIFICATION:6,PENDING_RECIPIENT_MANUAL_REVIEW:7,PENDING_RECIPIENT_PROCESSING:8,PENDING_PUSH_FAIL:9,CANCELED_RECIPIENT_RISK:10,CANCELED_SYSTEM_FAIL:11,CANCELED_EXPIRED:12,COMPLETED:13,INTERMEDIATE_PROCESSING:14,PENDING_SENDER_INITED:15,CANCELED_SAME_CARD:16,PENDING_SENDER_VERIFICATION_PROCESSING:17,PENDING_RECIPIENT_VERIFICATION_PROCESSING:18};},null);
__d("PageMessageEnumTag",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FLAG:"flag"};},null);
__d("PhotoResizeModeConst",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={CONTAIN:"s",COVER:"p"};},null);
__d("StickerAssetType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={IMAGE:"BestEffortImage",SPRITE:"SpriteImage",PADDED_SPRITE:"PaddedSpriteImage"};},null);
__d("StoryAttachmentStyle",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",CHECKIN:"checkin",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",MINUTIAE_EVENT:"minutiae_event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",TRAVEL_SLIDESHOW_LIFE_EVENT:"travel_slideshow_life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",NOTE:"note",TOPIC:"topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",BROADCAST_REQUEST:"broadcast_request",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",DONATIONS_CAMPAIGN:"donations_campaign",DONATE_PROMPT:"donate_prompt",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",RETAIL_ITEM:"retail_item",RETAIL_RECEIPT:"retail_receipt",INSTANT_ARTICLE:"instant_article",RETAIL_CANCELLATION:"retail_cancellation",JOIN_TOPIC_CONVERSATION:"join_topic_conversation",MOMENTS_APP_INVITATION:"moments_app_invitation",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",SURVEY:"survey",MESSAGE_LOCATION:"message_location",JOB_OFFER:"job_offer",GROUP_ADD_MEMBERS:"group_add_memebers",RTC_CALL_LOG:"rtc_call_log",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile",ATTRIBUTED_SHARE:"attributed_share",VIDEO_CINEMAGRAPH:"video_cinemagraph",LOCAL_CONTEXT_SHARE:"local_context_share",H_SCROLL:"h_scroll",MEDIA_QUESTION:"media_question",RICH_MEDIA:"rich_media",SQUARE_IMAGE_SHARE:"square_image_share"};},null);
__d("TreeMap",["Map","nullthrows"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(w,x,y){this.key=w;this.value=x;this.time=y;}function j(w){this.$TreeMap0=function(x,y){var z=w(x,y);return z!==0?z:x.time-y.time;};this.$TreeMap1=new g();this.$TreeMap2=null;this.$TreeMap3=0;this.size=this.$TreeMap1.size;}j.prototype.clear=function(){this.$TreeMap1=new g();this.$TreeMap2=null;this.size=this.$TreeMap1.size;};j.prototype.has=function(w){return this.$TreeMap1.has(w);};j.prototype.set=function(w,x){if(this.has(w))this["delete"](w);var y=new i(w,x,this.$TreeMap3++);this.$TreeMap1.set(w,y);this.$TreeMap2=q(this.$TreeMap2,y,this.$TreeMap0);this.size=this.$TreeMap1.size;return this;};j.prototype.get=function(w){return this.has(w)?this.$TreeMap1.get(w).value:(void 0);};j.prototype["delete"]=function(w){if(!this.has(w))return false;var x=this.$TreeMap1.get(w);this.$TreeMap2=r(this.$TreeMap2,x,this.$TreeMap0);this.$TreeMap1["delete"](w);this.size=this.$TreeMap1.size;return true;};j.prototype.keys=function(){var w=[];v(this.$TreeMap2,w,function(x){return x.key;});return w;};j.prototype.values=function(){var w=[];v(this.$TreeMap2,w,function(x){return x.value;});return w;};j.prototype.entries=function(){var w=[];v(this.$TreeMap2,w,function(x){return {key:x.key,value:x.value};});return w;};j.prototype.range=function(w,x){var y=[],z=null;if(w)z=new i(w.key,w.value,-1);var aa=null;if(x)aa=new i(x.key,x.value,this.$TreeMap3);v(this.$TreeMap2,y,function(ba){return {key:ba.key,value:ba.value};},this.$TreeMap0,z,aa);return y;};j.prototype.min=function(){if(!this.$TreeMap2)return undefined;var w=s(h(this.$TreeMap2)),x=w.key,y=w.value;return {key:x,value:y};};j.prototype.max=function(){if(!this.$TreeMap2)return undefined;var w=t(h(this.$TreeMap2)),x=w.key,y=w.value;return {key:x,value:y};};j.prototype.__testRoot=function(){};function k(w){if(!w)return w;p(w);if(w.balanceFactor<-1){if(w.right&&w.right.balanceFactor<=0){return l(w);}else return m(w);}else if(w.balanceFactor>1){if(w.left&&w.left.balanceFactor>=0){return n(w);}else return o(w);}else return w;}function l(w){var x=w,y=h(x.right),z=y.left;x.right=z;p(x);h(y).left=x;p(y);return y;}function m(w){var x=w,y=h(x.right),z=h(y.left),aa=z.left,ba=z.right;x.right=aa;p(x);y.left=ba;p(y);z=h(z);z.left=x;z.right=y;p(z);return z;}function n(w){var x=w,y=h(x.left),z=y.right;x.left=z;p(x);y.right=x;p(y);return y;}function o(w){var x=w,y=h(x.left),z=h(y.right),aa=z.left,ba=z.right;y.right=aa;p(y);x.left=ba;p(x);z.left=y;z.right=x;p(z);return z;}function p(w){var x=w.left?w.left.height:-1,y=w.right?w.right.height:-1;w.height=Math.max(x,y)+1;w.balanceFactor=x-y;}function q(w,x,y){if(w==null)return k(x);var z=y(x,w);if(z<0){w.left=q(w.left,x,y);return k(w);}else{w.right=q(w.right,x,y);return k(w);}}function r(w,x,y){if(w==null)return null;if(w===x)if(w.left&&w.right){var z=t(w.left);w.left=u(w.left);z.left=w.left;z.right=w.right;return k(z);}else if(w.left){return k(w.left);}else if(w.right){return k(w.right);}else return null;var aa=y(x,w);if(aa<0){w.left=r(w.left,x,y);return k(w);}else{w.right=r(w.right,x,y);return k(w);}}function s(w){while(w.left)w=w.left;return w;}function t(w){while(w.right)w=w.right;return w;}function u(w){if(!w)return null;if(w.right==null)return k(w.left||null);w.right=u(w.right);return k(w);}function v(w,x,y,z,aa,ba){if(w==null)return;var ca=!z||!aa||z(w,aa)>=0,da=!z||!ba||z(w,ba)<=0;if(ca)v(w.left,x,y,z,aa,ba);if(ca&&da)x.push(y(w));if(da)v(w.right,x,y,z,aa,ba);}e.exports=j;},null);
__d("Cache",["DateConsts","Map","TreeMap"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';function j(){this.$Cache0=new h();}j.prototype.has=function(k){return this.$Cache0.has(k);};j.prototype.get=function(k,l){var m=this.__getRaw(k);if(!m)return l;return m.$Cache1;};j.prototype.getAll=function(k,l){var m=new h();k.forEach(function(n){return m.set(n,this.get(n,l));}.bind(this));return m;};j.prototype["delete"]=function(k){var l=this.__getRaw(k);if(l&&l.$Cache2)clearTimeout(l.$Cache2);return this.$Cache0["delete"](k);};j.prototype.clear=function(){this.$Cache0.forEach(function(k){if(k&&k.$Cache2)clearTimeout(k.$Cache2);});this.$Cache0.clear();};j.prototype.set=function(k,l,m,n){if(!this.shouldUpdate(k,m))return false;var o=this.__getRaw(k);if(!o)o=this.__getNewRawObject();delete o.$Cache1;delete o.$Cache3;if(o.$Cache2)clearTimeout(o.$Cache2);delete o.$Cache2;o.$Cache1=l;if(m!=null)o.$Cache3=m;if(n!=null&&n>=0)o.$Cache2=setTimeout(this["delete"].bind(this,k),n*g.MS_PER_SEC*g.SEC_PER_MIN);this.__setRaw(k,o);return true;};j.prototype.shouldUpdate=function(k,l){var m=this.__getRaw(k);return (m==null||m.$Cache3==null||l==null||l>m.$Cache3);};j.prototype.size=function(){return this.$Cache0.size;};j.prototype.__getRaw=function(k){return this.$Cache0.get(k);};j.prototype.__setRaw=function(k,l){this.$Cache0.set(k,l);};j.prototype.__getNewRawObject=function(){return {$Cache1:null,$Cache2:null,$Cache3:null,$Cache4:null,$Cache5:null};};j.prototype.__keys=function(){return this.$Cache0.keys();};e.exports=j;},null);
__d("Poller",["ArbiterMixin","AsyncRequest","CurrentUser","copyProperties","emptyFunction","mixin","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=l(g);for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(t){"use strict";this._config=j({clearOnQuicklingEvents:true,setupRequest:k,interval:null,maxRequests:Infinity,dontStart:false},t);this._handle=null;if(!this._config.dontStart)this.start();}q.prototype.start=function(){"use strict";if(this._polling)return this;this._requests=0;this.request();return this;};q.prototype.stop=function(){"use strict";this._cancelRequest();return this;};q.prototype.mute=function(){"use strict";this._muted=true;return this;};q.prototype.resume=function(){"use strict";if(this._muted){this._muted=false;if(this._handle===null&&this._polling)return this.request();}return this;};q.prototype.skip=function(){"use strict";this._skip=true;return this;};q.prototype.reset=function(){"use strict";return this.stop().start();};q.prototype.request=function(){"use strict";this._cancelRequest();this._polling=true;if(!s())return this._done();if(this._muted)return this;if(++this._requests>this._config.maxRequests)return this._done();var t=new h();t.setIsBackgroundRequest(true);var u=false;t.setInitialHandler(function(){return !u;});this._cancelRequest=function(){u=true;this._cleanup();}.bind(this);t.setFinallyHandler(r.bind(this));t.setInitialHandler=k;t.setFinallyHandler=k;this._config.setupRequest(t,this);if(this._skip){this._skip=false;setTimeout(r.bind(this),0);}else t.send();return this;};q.prototype.isPolling=function(){"use strict";return this._polling;};q.prototype.isMuted=function(){"use strict";return this._muted;};q.prototype.setInterval=function(t){"use strict";if(t){this._config.interval=t;this.start();}};q.prototype.getInterval=function(){"use strict";return this._config.interval;};q.prototype._cleanup=function(){"use strict";if(this._handle!==null)clearTimeout(this._handle);this._handle=null;this._cancelRequest=k;this._polling=false;};q.prototype._done=function(){"use strict";this._cleanup();this.inform('done',{sender:this});return this;};q.MIN_INTERVAL=2000;j(q.prototype,{_config:null,_requests:0,_muted:false,_polling:false,_skip:false,_cancelRequest:k});function r(){if(!this._polling)return;if(this._requests<this._config.maxRequests){var t=this._config.interval;t=typeof t==='function'?t(this._requests):t;t=(t>q.MIN_INTERVAL)?t:q.MIN_INTERVAL;if(this._config.clearOnQuicklingEvents){this._handle=setTimeout(this.request.bind(this),t);}else this._handle=m(this.request.bind(this),t);}else this._done();}function s(){return i.isLoggedInNow();}e.exports=q;},null);
__d("ChatImpressionLogger",["AsyncSignal","requireWeak","ChatConfig","ChatVisibility","Poller","PresencePrivacy","PresenceStatus","debounceAcrossTransitions","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=null;h(['AvailableList'],function(v){return p=v;});var q=null;function r(){if(!q)return '';return q.getCachedSortedList().toString();}function s(){if(!q||!p)return '';var v=[],w=q.getCachedSortedList();for(var x=0;x<w.length;x++)v[x]=p.get(w[x]);return v.toString();}function t(v){v.setURI('/ajax/chat/imps_logging.php').setData({list_availability:s(),sorted_list:r(),source:'periodical_imps'});}var u={init:function(v){q=v;var w=i.get('chat_impression_logging_periodical',0);if(w){var x=i.get('periodical_impression_logging_config.interval'),y=new k({interval:x,setupRequest:t,clearOnQuicklingEvents:false,dontStart:true});l.subscribe('privacy-user-presence-changed',n(function(){if(j.isOnline()){y.start();}else y.stop();}));}this.init=function(){};},logImpression:function(v,w,x){var y=i.get('chat_impression_logging_with_click'),z={list_availability:y?s():'',sorted_list:y?r():'',source:v,target:w,target_presence:m.get(w),viewport_width:document.body.clientWidth};new g('/ajax/chat/ct.php',o(z,x)).send();}};e.exports=u;},null);
__d("ChatWelcomeMessage",["ImmutableObject"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(){this.$ChatWelcomeMessage0={};}h.prototype.setWelcomeMessage=function(j,k,l){this.$ChatWelcomeMessage0[j]=new g({timestamp:Date.now(),thread_id:j,author:k,body:l});};h.prototype.getWelcomeMessage=function(j){return this.$ChatWelcomeMessage0[j];};var i=new h();e.exports=i;},null);
__d("MercuryIDs",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={isValid:function(h){if(!h||typeof h!=='string')return false;return (/^\w{3,12}:/.test(h));},isValidThreadID:function(h){if(!g.isValid(h))return false;var i=g.tokenize(h);switch(i.type){case 'user':case 'group':case 'thread':case 'root':case 'pending':return true;default:return false;}},tokenize:function(h){if(!this.isValid(h))throw ("bad_id_format "+h);var i=h.indexOf(':');return {type:h.substr(0,i),value:h.substr(i+1)};},getUserIDFromParticipantID:function(h){if(!this.isValid(h))throw ("bad_id_format "+h);var i=g.tokenize(h),j=i.type,k=i.value;if(j!='fbid')return null;return k;},getParticipantIDFromUserID:function(h){if(isNaN(h))throw ("Not a user ID: "+h);return 'fbid:'+h;},getUserIDFromThreadID:function(h){if(!this.isCanonical(h))return null;return this.tokenize(h).value;},getThreadIDFromUserID:function(h){return 'user:'+h;},getThreadIDFromParticipantID:function(h){var i=this.getUserIDFromParticipantID(h);return i?this.getThreadIDFromUserID(i):null;},getParticipantIDFromFromThreadID:function(h){return this.getParticipantIDFromUserID(this.getUserIDFromThreadID(h)||'');},isCanonical:function(h){return this.isValid(h)&&this.tokenize(h).type==='user';},isMultichat:function(h){return this.isValid(h)&&this.tokenize(h).type!=='user';}};e.exports=g;},null);
__d("MercuryAssert",["MercuryIDs"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();e.exports={isParticipantID:function(h){if(!g.isValid(h))throw ("bad_participant_id "+h);},allParticipantIDs:function(h){h.forEach(this.isParticipantID);},isUserParticipantID:function(h){var i=g.tokenize(h);if(i.type!='fbid')throw ("bad_user_id "+h);},isEmailParticipantID:function(h){var i=g.tokenize(h);if(i.type!='email')throw ("bad_email_id "+h);},allThreadID:function(h){h.forEach(this.isThreadID);},isThreadID:function(h){if(!g.isValid(h))throw ("bad_thread_id "+h);}};},null);
__d("MercuryShareAttachmentRenderLocations",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={CHAT:'chat',CHAT_PREVIEW:'chat_preview',MESSENGER:'messenger',WEB_INBOX:'web_inbox',getValues:function(){return [g.CHAT,g.CHAT_PREVIEW,g.MESSENGER,g.WEB_INBOX];},isPreview:function(h){return h===g.CHAT_PREVIEW;}};e.exports=g;},null);
__d("MercuryShareAttachmentReactShape",["React"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g,i=h.PropTypes,j=i.shape({share_id:i.string,description:i.string,media:i.shape({image:i.string,image_size:i.shape({height:i.number,width:i.number}),duration:i.number,playable:i.bool,source:i.string}),source:i.string,style_list:i.arrayOf(i.string),subattachments:i.array,target:i.object,title:i.string,properties:i.object,uri:i.string}).isRequired;e.exports=j;},null);
__d("ChatImageArrowDirection",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g({BOTH:null,LEFT:null,RIGHT:null});e.exports=h;},null);
__d("MercuryAttachmentConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={SIDE_LENGTH:9};e.exports=g;},null);
__d("ChatImageWithArrow.react",["BackgroundImage.react","ChatImageArrowDirection","Link.react","MercuryAttachmentConstants","React","XUISpinner.react","cx","getVendorPrefixedName","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=k,q=p.PropTypes,r=30,s=15,t=k.createClass({displayName:"ChatImageWithArrow",propTypes:{arrowDirection:q.oneOf(Object.keys(h)),onClick:q.func,height:q.number.isRequired,isLoading:q.bool,rootClassName:q.string,sideLength:q.number,source:q.string,width:q.number.isRequired},getDefaultProps:function(){return {sideLength:j.SIDE_LENGTH,isLoading:false};},render:function(){this._arrowWidth=Math.floor(this.props.sideLength/Math.sqrt(2));this._extendedPhotoWidth=Math.ceil(this._getWidth()+this._arrowWidth);if(this.props.isLoading)return this._renderUploadingBubble();var u=o((("_4yp6")+(this.props.arrowDirection!==h.BOTH?' '+"_2nlo":'')),this.props.rootClassName),v,w;switch(this.props.arrowDirection){case h.BOTH:v=[this._renderArrowWithBorder(h.LEFT),this._renderArrowWithBorder(h.RIGHT)];w=[this._renderArrowWithNoBorder(h.LEFT),this._renderArrowWithNoBorder(h.RIGHT)];break;case h.LEFT:case h.RIGHT:v=this._renderArrowWithBorder(this.props.arrowDirection);w=this._renderArrowWithNoBorder(this.props.arrowDirection);break;}return this._renderLink(k.createElement("div",{className:u},v,k.createElement("div",{className:"_52kr",style:{width:this._getWidth(),height:this._getHeight()}},k.createElement("div",{className:"_4yp9",style:{backgroundImage:'url('+this.props.source+')',width:this._extendedPhotoWidth,height:this._getHeight()}})),w));},_getWidth:function(){return Math.max(this.props.width,s);},_getHeight:function(){return Math.max(this.props.height,r);},_renderLink:function(u){if(this.props.onClick)return (k.createElement(i,{onClick:this.props.onClick},u));return u;},_calculateArrowTransform:function(u,v,w,x){if(v===h.LEFT){return 'translate('+w+'px, '+x+'px)'+'rotate(45deg)';}else return 'translate('+(u-w)+'px, '+x+'px)'+'rotate(45deg)';},_calculateArrowImageTransform:function(u,v,w,x){if(v===h.LEFT){return 'rotate(-45deg)'+'translate(-'+(this._arrowWidth+w)+'px,'+'-'+x+'px)';}else return 'rotate(-45deg)'+'translate(-'+(u-w)+'px, -'+x+'px)';},_renderUploadingBubble:function(){var u={width:this.props.sideLength,height:this.props.sideLength},v={width:this.props.sideLength,height:this.props.sideLength},w=n('transform');if(w){u[w]=this._calculateArrowTransform(this._getWidth(),this.props.arrowDirection,0,this.props.sideLength);v[w]=this._calculateArrowTransform(this._getWidth(),this.props.arrowDirection,0,Math.floor(this.props.sideLength-this._getHeight()));}return (k.createElement("div",{className:"_4yp6"},k.createElement("div",{className:"_4ypa",style:u}),k.createElement("div",{className:"_4ypb",style:{width:this._getWidth(),height:this._getHeight()}},k.createElement(l,{size:"small"})),k.createElement("div",{className:"_4ype",style:v})));},_renderArrowWithBorder:function(u){var v={width:this.props.sideLength,height:this.props.sideLength},w={},x=n('transform');if(x){v[x]=this._calculateArrowTransform(this._getWidth(),u,0,this.props.sideLength);w[x]=this._calculateArrowImageTransform(this._getWidth(),u,0,this.props.sideLength);return (k.createElement("div",{className:(("_4ypf")+(u===h.LEFT?' '+"_2nlp":'')+(u===h.RIGHT?' '+"_2nlq":'')),key:'border:'+u,style:v},k.createElement(g,{backgroundSize:"cover",className:"_4ypg",height:this._getHeight(),src:this.props.source,style:w,width:this._extendedPhotoWidth})));}},_renderArrowWithNoBorder:function(u){var v={width:this.props.sideLength,height:this.props.sideLength},w={},x=1,y=n('transform');if(y){v[y]=this._calculateArrowTransform(this._getWidth(),u,x,this.props.sideLength-this._getHeight());w[y]=this._calculateArrowImageTransform(this._getWidth(),u,x,this.props.sideLength);}return (k.createElement("div",{className:(("_4yph")+(u===h.LEFT?' '+"_2nlp":'')+(u===h.RIGHT?' '+"_2nlq":'')),key:'noBorder:'+u,style:v},k.createElement(g,{backgroundSize:"cover",className:"_4ypg",height:this._getHeight(),src:this.props.source,style:w,width:this._extendedPhotoWidth})));}});e.exports=t;},null);
__d("MercuryShareImage.react",["ChatImageArrowDirection","ChatImageWithArrow.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"MercuryShareImage",propTypes:{height:l.number.isRequired,source:l.string.isRequired,width:l.number.isRequired},render:function(){return (i.createElement("div",{className:"_4hsl"},i.createElement(h,{arrowDirection:g.BOTH,height:this.props.height,source:this.props.source,width:this.props.width})));}});e.exports=m;},null);
__d("MessengerAttachmentImageBlock.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"MessengerAttachmentImageBlock",propTypes:{attachment:k.object.isRequired},render:function(){return (g.createElement("div",{className:i(this.props.className,this._computeClass())},this._renderImage(),g.createElement("div",{className:"_5swm"},this.props.children)));},_renderImage:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var n=this._getDimensions(),o=n.height,p=n.width,q=o>p,r=m(o,p),s=o&&p?o/p*100:100,t=(q||r)?.2:1,u=(q||r)?s:52;return (g.createElement("div",{className:"_3xn1",style:{backgroundImage:'url('+this.props.attachment.media.image+')',paddingBottom:q&&s>150?'136px':u*t+'%'}}));},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var n=this._getDimensions(),o=n.height,p=n.width,q=o>p;return (("_3xn3")+(m(o,p)&&!q?' '+"_3xn5":'')+(q?' '+"_3xn6":'')+(p>=o?' '+"_3xn7":''));},_getDimensions:function(){var n=this.props.attachment.properties||{},o=n.height,p=n.width;if(o&&p){o=parseInt(o,10);p=parseInt(p,10);return {height:o,width:p};}return {height:0,width:0};}});function m(n,o){return n<=300&&o<=300;}e.exports=l;},null);
__d("MercuryFallbackShareAttachmentContent.react",["Image.react","ImageBlock.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MercuryShareImage.react","MessengerAttachmentImageBlock.react","React","URI","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=m,r=q.PropTypes,s=72,t=m.createClass({displayName:"MercuryFallbackShareAttachmentContent",propTypes:{attachment:j,location:r.oneOf(i.getValues())},statics:{modifyURIUsingLocation:function(u,v){if(v===i.MESSENGER&&!u.getDomain())u.setDomain('facebook.com').setSubdomain(n.getRequestURI().getSubdomain()).setProtocol('https');return u;}},render:function(){var u=this.props.attachment,v=this.props.location,w=((i.CHAT===v?"_49or":'')+(i.WEB_INBOX===v?' '+"__nm":'')+(i.CHAT_PREVIEW===v?' '+"_324d":'')+(i.CHAT!==v?' '+"_tih":'')+(!(u&&u.media.image)?' '+"_49ou":'')),x=(m.createElement("div",{className:"__6j"},m.createElement("div",{className:"__6k"},u.title),m.createElement("div",{className:"__6l"},u.description),m.createElement("div",{className:"__6m"},u.source)));if(u.media&&u.media.image){if(i.CHAT===v||i.CHAT_PREVIEW===v){return (m.createElement(h,{className:w,spacing:"medium"},m.createElement(k,{height:s,source:u.media.image,width:s}),m.createElement("div",{style:{display:'flex',justifyContent:'center',flexDirection:'column',height:s}},x)));}else if(i.MESSENGER===v)return (m.createElement(l,{className:w,attachment:u},x,this.props.children));return (m.createElement(h,{className:p(this.props.className,w)},m.createElement(g,{className:"__6n",src:u.media.image,width:s}),x,this.props.children));}return (m.createElement("div",{className:p(this.props.className,w)},x,this.props.children));}});e.exports=t;},null);
__d("MercuryFallbackShareAttachment.react",["Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React","URI","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=k.createClass({displayName:"MercuryFallbackShareAttachment",propTypes:{attachment:j,location:o.oneOf(i.getValues())},renderLink:function(q){var r=this.props.location;if(i.isPreview(r))return q;var s=h.modifyURIUsingLocation(new l(this.props.attachment.uri),r);return (k.createElement(g,{className:"_5rw4",href:s,target:"_blank"},q));},render:function(){return this.renderLink(k.createElement(h,k.__spread({},this.props)));}});e.exports=p;},null);
__d("MercuryFallbackShareAttachmentSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryFallbackShareAttachmentSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o;if(this.props.isViewerSender){o=(j._("You shared a link."));}else o=(j._("{sender name} shared a link.",[j.param("sender name",this.props.senderName)]));return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/messaging/docs/generic.png')}),o));}});e.exports=n;},null);
__d("P2PActionConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={CREDIT_CARDS_UPDATED:'credit_cards_updated',CREDIT_CARD_ADDED:'credit_card_added',CREDIT_CARD_ADDED_ERROR:'credit_card_added_error',CREDIT_CARD_DELETED:'credit_card_deleted',CREDIT_CARD_DELETED_ERROR:'credit_card_deleted_error',CREDIT_CARD_UPDATED:'credit_card_updated',CREDIT_CARD_UPDATED_ERROR:'credit_card_updated_error',PRESET_CREDIT_CARD_UPDATED:'preset_credit_card_updated',PRESET_CREDIT_CARD_UPDATED_ERROR:'preset_credit_card_updated_error',CREDIT_CARD_VERIFIED:'credit_card_verified',CREDIT_CARD_VERIFIED_ERROR:'credit_card_verified_error',TRANSFERS_UPDATED:'transfers_updated',TRANSFERS_UPDATED_ERROR:'transfers_updated_error',NUX_TRANSFERS_UPDATED:'nux_transfers_updated',TRANSFER_ADDED:'transfer_added',TRANSFER_ADDED_ERROR:'transfer_added_error',TRANSFER_UPDATED:'transfer_updated',TRANSFER_UPDATED_ERROR:'transfer_updated_error',TRANSFER_ACCEPTED:'transfer_accepted',TRANSFER_DECLINED:'transfer_declined',CHAT_SEND_VIEW_OPENED:'chat_send_view_opened',CHAT_SEND_VIEW_CLOSED:'chat_send_view_closed',BIN_NUMBER_VALIDATED:'bin_number_validated',BIN_NUMBER_VALIDATED_ERROR:'bin_number_validated_error'};e.exports=g;},null);
__d("P2PDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("P2PActions",["P2PActionConstants","P2PDispatcher"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={updateCreditCards:function(j){h.dispatch({type:g.CREDIT_CARDS_UPDATED,data:j});},addCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_ADDED,data:j});},addCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_ADDED_ERROR,data:j});},updatePresetCreditCard:function(j){h.dispatch({type:g.PRESET_CREDIT_CARD_UPDATED,data:j});},updatePresetCreditCardError:function(j){h.dispatch({type:g.PRESET_CREDIT_CARD_UPDATED_ERROR,data:j});},updateCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_UPDATED,data:j});},updateCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_UPDATED_ERROR,data:j});},deleteCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_DELETED,data:j});},deleteCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_DELETED_ERROR,data:j});},verifyCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_VERIFIED,data:j});},verifyCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_VERIFIED_ERROR,data:j});},updateTransfers:function(j){h.dispatch({type:g.TRANSFERS_UPDATED,data:j});},updateTransfersError:function(j){h.dispatch({type:g.TRANSFERS_UPDATED_ERROR,data:j});},updateNUXTransfers:function(j){h.dispatch({type:g.NUX_TRANSFERS_UPDATED,data:j});},transferAdded:function(j){h.dispatch({type:g.TRANSFER_ADDED,data:j});},transferAddedError:function(j){h.dispatch({type:g.TRANSFER_ADDED_ERROR,data:j});},transferUpdated:function(j){h.dispatch({type:g.TRANSFER_UPDATED,data:j});},transferUpdatedError:function(j){h.dispatch({type:g.TRANSFER_UPDATED_ERROR,data:j});},transferAccepted:function(){h.dispatch({type:g.TRANSFER_ACCEPTED});},transferDeclined:function(j){h.dispatch({type:g.TRANSFER_DECLINED,data:j});},chatSendViewOpened:function(j){h.dispatch({type:g.CHAT_SEND_VIEW_OPENED,data:j});},chatSendViewClosed:function(j){h.dispatch({type:g.CHAT_SEND_VIEW_CLOSED,data:j});},binNumberValidated:function(j){h.dispatch({type:g.BIN_NUMBER_VALIDATED,data:j});},binNumberValidatedError:function(j){h.dispatch({type:g.BIN_NUMBER_VALIDATED_ERROR,data:j});}};e.exports=i;},null);
__d("P2PAPIUtils",["CreditCardFormParam","fbt","guid","merge"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={genRequestID:function(){return 'id:'+i()+':'+Date.now();},getUncaughtErrorMessage:function(){return (h._("Sorry, something went wrong. Please try again later."));},prepareCardMutationData:function(l){var m={},n=l[g.CARD_NUMBER].replace(/ /g,'');m[g.CARD_NUMBER]=n;if(typeof l[g.CARD_EXPIRATION]==='string'){var o=l[g.CARD_EXPIRATION].split('/');m[g.MONTH]=o[0];m[g.YEAR]=o[1];m[g.CARD_EXPIRATION]={};m[g.CARD_EXPIRATION][g.MONTH]=m[g.MONTH];m[g.CARD_EXPIRATION][g.YEAR]=m[g.YEAR];}else{m[g.MONTH]=l[g.CARD_EXPIRATION][g.MONTH];m[g.YEAR]=l[g.CARD_EXPIRATION][g.YEAR];}return j(l,m);}};e.exports=k;},null);
__d("XP2PCardBINValidateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/card_bin\/validate\/",{bin_number:{type:"String",required:true}});},null);
__d("XP2PCreditCardDeleteController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_delete\/",{});},null);
__d("XP2PCreditCardUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_update\/",{});},null);
__d("XP2PCreditCardCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_create\/",{});},null);
__d("XP2PCreditCardVerifyController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_verify\/",{});},null);
__d("XP2PCreditCardsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/",{type:{type:"Int",defaultValue:1}});},null);
__d("XP2PPasswordProtectionStatusController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/",{});},null);
__d("XP2PPasswordProtectionStatusUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/_update\/",{});},null);
__d("XP2PPresetCreditCardSetController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/preset_credit_card\/_set\/",{});},null);
__d("XP2PTransactionsCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_create\/",{});},null);
__d("XP2PTransactionsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/",{since:{type:"Int"}});},null);
__d("XP2PTransactionsDeclineController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_decline\/",{});},null);
__d("XP2PTransactionsCancelController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_cancel\/",{});},null);
__d("P2PAPI",["AsyncRequest","CreditCardFormParam","P2PActions","P2PAPIUtils","P2PPasswordProtectionParam","P2PPaymentCreditCardsTypes","P2PTransferParam","ImmutableObject","URI","XP2PCardBINValidateController","XP2PCreditCardDeleteController","XP2PCreditCardUpdateController","XP2PCreditCardCreateController","XP2PCreditCardVerifyController","XP2PCreditCardsController","XP2PPasswordProtectionStatusController","XP2PPasswordProtectionStatusUpdateController","XP2PPresetCreditCardSetController","XP2PTransactionsCreateController","XP2PTransactionsController","XP2PTransactionsDeclineController","XP2PTransactionsCancelController","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();'use strict';var da={getAllCreditCards:function(){var ea=(u.getURIBuilder()).getURI();new g().setData({type:l.SENDING}).setURI(ea).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(fa){var ga=fa.getPayload();if(!ga.error)i.updateCreditCards(ga);}.bind(this)).send();},createTransaction:function(ea){var fa=(y.getURIBuilder()).getURI(),ga={},ha=ea.formData,ia=ea.success||ca,ja=ea.error||ca;ga[h.CREDENTIAL_ID]=ha[h.CREDENTIAL_ID];ga.amount=ha.amount;ga.receiver_id=ha.receiverId;ga.offline_threading_id=j.genRequestID();ga.group_thread_fbid=ha.group_thread_fbid;new g().setData(ga).setMethod('POST').setURI(fa).setAllowCrossPageTransition(true).setHandler(function(ka){var la=ka?ka.getPayload():{};if(la.error){ja(la.error);}else{ia(la);this.getAllCreditCards();}}.bind(this)).setErrorHandler(function(){ja({message:j.getUncaughtErrorMessage()});}.bind(this)).send();},addCreditCard:function(ea){var fa=(s.getURIBuilder()).getURI().getPath(),ga=new o('/ajax/payment/token_proxy.php').addQueryData('tpe',fa);ea=j.prepareCardMutationData(ea);var ha=new n(ea);new g().setData(ea).setMethod('POST').setURI(ga).setHandler(function(ia){var ja=ia.getPayload(),ka={};if(!ja.errors){ka[h.CREDENTIAL_ID]=ja[h.CARD_FBID];ka.isPreset=ja.isPreset;ka.isVerified=ja.isVerified;ka.passwordProtection=ja.passwordProtection;ha=n.set(ha,ka);i.addCreditCard(ha);}else i.addCreditCardError(Object.assign({requestID:ha.requestID},ja));}.bind(this)).setErrorHandler(function(){i.addCreditCardError({requestID:ha.requestID,errors:{general:{message:j.getUncaughtErrorMessage()}}});}.bind(this)).send();},getTransactions:function(ea){ea=ea||{};var fa={},ga=ea,ha=(z.getURIBuilder()).getURI(),ia=new n(ga);if(ga.since)fa.since=ga.since;return new g().setData(fa).setURI(ha).setMethod('GET').setReadOnly(true).setHandler(function(ja){var ka=ja.getPayload();if(!ka.error){i.updateTransfers(ka);}else i.updateTransfersError(Object.assign({requestID:ia.requestID},ka));}.bind(this)).setErrorHandler(function(){i.updateTransfersError({error:{message:j.getUncaughtErrorMessage()},requestID:ia.requestID});}.bind(this)).send();},getNUXTransactions:function(){var ea=(new Date()),fa=Math.round((ea.setDate(ea.getDate()-15))/1000),ga=(z.getURIBuilder()).getURI();return new g().setData({since:fa}).setURI(ga).setMethod('GET').setReadOnly(true).setHandler(function(ha){var ia=ha.getPayload();if(!ia.error)i.updateNUXTransfers(ia);}.bind(this)).send();},updatePresetCreditCard:function(ea){var fa=(x.getURIBuilder()).getURI();new g().setData(ea).setURI(fa).setMethod('POST').setHandler(function(ga){var ha=ga.getPayload();if(!ha.error){i.updatePresetCreditCard(Object.assign({},ha,{requestID:ea.requestID}));i.transferAccepted();}else i.updatePresetCreditCardError(Object.assign({},ha,{requestID:ea.requestID}));}.bind(this)).setErrorHandler(function(){i.updatePresetCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:ea.requestID});}.bind(this)).send();},updateCreditCard:function(ea){var fa=(r.getURIBuilder()).getURI().getPath(),ga=new o('/ajax/payment/token_proxy.php').addQueryData('tpe',fa);ea=j.prepareCardMutationData(ea);var ha=new n(ea);new g().setData(ea).setMethod('POST').setURI(ga).setHandler(function(ia){var ja=ia.getPayload();if(!ja.errors){i.updateCreditCard(ha);}else i.updateCreditCardError(Object.assign({},ja,{requestID:ha.requestID}));}.bind(this)).setErrorHandler(function(){i.updateCreditCardError({errors:{general:{message:j.getUncaughtErrorMessage()}},requestID:ha.requestID});}.bind(this)).send();},deleteCreditCard:function(ea){var fa=(q.getURIBuilder()).getURI();new g().setData(ea).setMethod('POST').setURI(fa).setHandler(function(ga){var ha=ga.getPayload();if(!ha.error){i.deleteCreditCard(Object.assign({},ha,{requestID:ea.requestID}));}else i.deleteCreditCardError(Object.assign({},ha,{requestID:ea.requestID}));}.bind(this)).setErrorHandler(function(){i.deleteCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:ea.requestID});}.bind(this)).send();},getPasswordProtectionSetting:function(ea){var fa=(v.getURIBuilder()).getURI(),ga=ea.success||ca,ha=ea.error||ca;new g().setURI(fa).setMethod('GET').setReadOnly(true).setHandler(function(ia){var ja=ia?ia.getPayload():[];if(ja.error){ha();}else ga(ja);}.bind(this)).setErrorHandler(function(){ha();}.bind(this)).send();},setPasswordProtectionSetting:function(ea){var fa=(w.getURIBuilder()).getURI(),ga=ea.formData,ha=ea.success||ca,ia=ea.error||ca,ja={};ja[k.STATUS]=ga[k.STATUS];new g().setData(ja).setURI(fa).setMethod('POST').setHandler(function(ka){var la=ka?ka.getPayload():{};if(la.error){ia(la.error);}else ha();}.bind(this)).setErrorHandler(function(){ia();}.bind(this)).send();},declineTransaction:function(ea){var fa=(aa.getURIBuilder()).getURI(),ga=ea.formData,ha=ea.success||ca,ia=ea.error||ca,ja={};ja[m.TRANSFER_ID]=ga[m.TRANSFER_ID];new g().setData(ja).setURI(fa).setMethod('POST').setHandler(function(ka){var la=ka?ka.getPayload():{},ma={};if(la.error){ia(la.error);}else{ha();ma[m.TRANSFER_ID]=ja[m.TRANSFER_ID];i.transferDeclined(ma);}}.bind(this)).setErrorHandler(function(){ia();}.bind(this)).send();},cancelTransaction:function(ea){var fa=(ba.getURIBuilder()).getURI(),ga=ea.formData,ha=ea.success||ca,ia=ea.error||ca,ja={};ja[m.TRANSFER_ID]=ga[m.TRANSFER_ID];new g().setData(ja).setURI(fa).setMethod('POST').setHandler(function(ka){var la=ka?ka.getPayload():{};if(la.error){ia(la.error);}else ha();}.bind(this)).setErrorHandler(function(){ia();}.bind(this)).send();},verifyCreditCard:function(ea){var fa=(t.getURIBuilder()).getURI().getPath(),ga=new o('/ajax/payment/token_proxy.php').addQueryData('tpe',fa);new g().setData(ea).setMethod('POST').setURI(ga).setHandler(function(ha){var ia=ha.getPayload();if(!ia.error){i.verifyCreditCard(Object.assign({},ia,{requestID:ea.requestID}));}else i.verifyCreditCardError(Object.assign({},ia,{requestID:ea.requestID}));}.bind(this)).setErrorHandler(function(){i.verifyCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:ea.requestID});}.bind(this)).send();},validateBINNumber:function(ea){ea=ea||{};var fa=new n(ea),ga=(p.getURIBuilder()).setString('bin_number',ea.binNumber).getURI();return new g().setURI(ga).setMethod('GET').setReadOnly(true).setHandler(function(ha){var ia=ha.getPayload();if(!ia.error){i.binNumberValidated(Object.assign({},ia,{requestID:ea.requestID}));}else i.binNumberValidatedError(Object.assign({},ia,{requestID:fa.requestID}));}.bind(this)).send();}};e.exports=da;},null);
__d("PaymentMethodUtils",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=16,h=4,i=[{pattern:/^5[1-5]/,name:'mc',cscDigits:3,digits:16,supported:true,code:77},{pattern:/^4/,name:'visa',cscDigits:3,digits:16,supported:true,code:86},{pattern:/^3[47]/,name:'amex',cscDigits:4,digits:15,supported:true,code:65},{pattern:/^35(2[8-9]|[3-8])/,name:'jcb',cscDigits:3,digits:16,supported:true,code:74},{pattern:/^(6011|65|64[4-9]|622([2-8]|1[3-9]|12[6-9]|9[0-1]|92[0-5]))/,name:'disc',cscDigits:3,digits:16,supported:true,code:68},{pattern:/^30[0-5]/,name:'diners',digits:14,cscDigits:3,supported:false,code:64},{name:'unknown',digits:16,cscDigits:3,supported:false,code:85}],j=function(l){return l.replace(/[iIl]/g,'1').replace(/[Oo]/g,'0').replace(/[^\d]/gi,'');},k={getCardType:function(l){l=j(l);l=l.substr(0,6);for(var m=0;m<i.length;m++)if(l.match(i[m].pattern))return i[m];},getCardTypeFromCode:function(l){for(var m=0;m<i.length;m++)if(l==i[m].code)return i[m];return null;},isValidCCNumber:function(l){l=j(l);var m=k.getCardType(l);if(m.digits!==l.length)return false;if(!m.supported)return false;return k.isValidLuhn(l);},isValidLuhn:function(l){l=j(l);var m=l.split('').reverse(),n='';for(var o=0;o<m.length;o++){var p=parseInt(m[o],10);if(o%2!==0)p=p*2;n=n+p;}var q=0;for(o=0;o<n.length;o++)q=q+parseInt(n.charAt(o),10);return !!(q!==0&&q%10===0);},getMaxCardLength:function(l){return g;},getMaxCSCLength:function(){return h;}};e.exports=k;},null);
__d("XUITextInput.react",["AbstractTextInput.react","React","XUIError.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h.createClass({displayName:"XUITextInput",propTypes:Object.assign({},g.propTypes,i.propTypes),render:function(){var m=(("_55r1")+(this.props.height=='tall'?' '+"_55r2":'')),n=(h.createElement(g,h.__spread({},this.props,{ref:"textInput",className:k(this.props.className,m)})));return (h.createElement(i,h.__spread({},this.props),n));},focusInput:function(){this.refs.textInput.focusInput();}});e.exports=l;},null);
__d("P2PCreditCardFormFieldMixin.react",["React","ReactInputSelection","XUITextInput.react","cx","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=49,m=g,n=m.PropTypes,o={propTypes:{onChange:n.func,reference:n.string,saveError:n.string,focused:n.bool,value:n.string,isMasked:n.bool,showFocusOutline:n.bool,showIcon:n.bool,showPlaceholder:n.bool},getDefaultProps:function(){return {onChange:k,saveError:'',focused:false,value:'',isMasked:false,showFocusOutline:true,showIcon:true,showPlaceholder:true};},getInitialState:function(){return {isValid:null,value:'',oldValue:'',focused:false,lastKeyCode:l,modified:false,cursorPosition:0,errorMessage:null};},getInputElement:function(){return this.refs.ccFormFieldInput.refs.textInput.getTextFieldDOM();},restoreCursorPosition:function(){if(!this.getUpdatedCursorPosition)return;if(this.state.oldValue===this.state.value)return;var p=this.getUpdatedCursorPosition(this.state.value,this.state.oldValue,this.state.cursorPosition);h.setSelection(this.getInputElement(),{start:p});},setAndValidate:function(p,q){var r,s=this.state.value,t=h.getSelection(this.getInputElement()),u=this.formatValue?this.formatValue(p,s,q):p;r=this.validate(u);this.setState({modified:true,value:u,oldValue:p,isValid:r,cursorPosition:t.start},this.restoreCursorPosition);this.triggerChange(u,r);},triggerChange:function(p,q){this.props.onChange(this.props.reference,p,q);},componentDidMount:function(){if(this.props.focused)setTimeout(function(){if(this.isMounted())this.focus();}.bind(this),100);this.initializeFormValue();},initializeFormValue:function(){var p;if(this.props.value){p=this.props.isMasked?true:this.validate(this.props.value);this.setState({isValid:p,modified:true,value:this.props.value});this.triggerChange(this.props.value,p);}},handleBlur:function(p){var q=this.getInputElement().value;if(q&&q!==this.state.value)this.setAndValidate(q,l);this.setState({focused:false});},handlePaste:function(p){this.setState({lastKeyCode:l});},handleChange:function(p){this.setAndValidate(p.target.value,this.state.lastKeyCode);},handleOnKeyDown:function(p){var q=p.keyCode;if(q>=96&&q<=105)q=q-48;this.setState({lastKeyCode:q});},handleFocus:function(p){this.setState({focused:true});},focus:function(){g.findDOMNode(this.refs.ccFormFieldInput).focus();},shouldShowIsValidError:function(){if(!this.state.isValid&&this.state.modified)return !this.state.focused||this.isValAtLimit();return false;},isDisabled:function(){return this.props.isMasked;},render:function(){var p=this.shouldShowIsValidError()||this.props.saveError||this.state.errorMessage;return (g.createElement("div",{className:(("_2wac")+(p?' '+"_5bqn":'')+(this.props.showFocusOutline&&!p&&this.state.focused?' '+"_5bqo":'')),onClick:this.focus},this.props.showIcon?this.getIcon():null,g.createElement(i,{autoComplete:this.getAutocompleteName(),ref:"ccFormFieldInput",defaultValue:this.props.defaultValue,value:this.state.value,onChange:this.handleChange,onPaste:this.handlePaste,onKeyDown:this.handleOnKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,placeholder:this.props.showPlaceholder?this.getPlaceholder():'',disabled:this.isDisabled(),className:(("_5bqq")+(!this.props.showIcon?' '+"_46tf":'')),xuiError:this.state.errorMessage}),g.createElement("div",{className:"_5br4"})));}};e.exports=o;},null);
__d("P2PCreditCardNumberFormFieldHelper",["Keys"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h={formatCardNumber:function(i,j,k,l,m){if(k===g.BACKSPACE||k===g.DELETE){var n=(j.split(m).length-1),o=(i.split(m).length-1);if(o!==n)return i;}i=i.replace(/\D/g,'');i=i.substr(0,l[l.length-1]);var p='';for(var q=1;q<l.length;q++){if(l[q]>i.length||(q===l.length-1)){p+=i.slice(l[q-1]);break;}p+=i.slice(l[q-1],l[q])+m;}return p;},getUpdatedCursorPosition:function(i,j,k,l){var m=0,n=0;while(m<k&&m<j.length&&n<i.length)if(j[m]===i[n]){m++;n++;}else if(!/^\d+$/.test(j[m])){m++;}else n++;if(i.substr(n,1)===l)n++;return n;}};e.exports=h;},null);
__d("P2PCreditCardNumberFormField.react",["React","PaymentMethodUtils","P2PCreditCardFormFieldMixin.react","P2PCreditCardNumberFormFieldHelper","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=g.createClass({displayName:"P2PCreditCardFormField",mixins:[i],getIcon:function(){return (g.createElement("div",{className:"_31_w _3_2h"}));},getAutocompleteName:function(){return 'cc-number';},isAmex:function(n){var o=h.getCardType(n||this.state.value);return (o.name==='amex');},getLimit:function(){return this.isAmex()?15:16;},isValAtLimit:function(){var n=this.getLimit(),o=this.state.value.replace(/ /g,'');return o.length===n;},formatValue:function(n,o,p){var q=this.isAmex(n)?[0,4,10,15]:[0,4,8,12,16];return j.formatCardNumber(n,o,p,q,' ');},getUpdatedCursorPosition:function(n,o,p){return j.getUpdatedCursorPosition(n,o,p,' ');},getPlaceholder:function(){return l._("Card Number");},validate:function(n){var o=this.isValidCardType(n);this.setState({errorMessage:!o?l._("Please enter a debit card. Credit cards can't be used."):null});return !!(h.isValidCCNumber(n)&&o);},isValidCardType:function(n){var o=['mc','visa','unknown'],p=h.getCardType(n),q=p?p.name:'',r=o.indexOf(q)>=0;return r;}});e.exports=m;},null);
__d("P2PCreditCardExpDateFormField.react",["React","P2PCreditCardFormFieldMixin.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g.createClass({displayName:"P2PCreditCardExpDateFormField",mixins:[h],getIcon:function(){return (g.createElement("div",{className:"_31_w _31_x"}));},getAutocompleteName:function(){return 'cc-exp';},isValAtLimit:function(){var l=this.state.value;return l.length===this.getLimit();},getLimit:function(){return 5;},getPlaceholder:function(){return (j._("MM\/YY"));},formatValue:function(l,m,n){var o=this.getLimit(),p=String.fromCharCode(n);l=l.replace(/[^0-9\/]+/g,'');var q=l.split('/'),r=q[0],s=q[1];if(s&&s.length===4){l=r+'/'+s.substr(-2);}else l=l.slice(0,o);if(!/^\d+$/.test(p)&&n!==191&&n!==111)return l;l=l.replace(/\D/g,'');if(/^\d$/.test(l)&&(l!=='0'&&l!=='1')){l='0'+l+'/';}else if(l.length>=2&&l.indexOf('/')===-1)l=l.substr(0,2)+'/'+l.substr(2,4);return l;},validate:function(l){var m=l.split('/'),n=(new Date()),o=parseInt(n.getFullYear().toString().substring(2),10),p=parseInt(n.getMonth()+1,10),q=parseInt(m[0],10),r=parseInt(m[1],10);if(l.length!==5||!q||!r||isNaN(q)||isNaN(r)||q<1||q>12)return false;if((r<o)||(r===o&&q<p)||q>12||q<1)return false;return true;}});e.exports=k;},null);
__d("P2PCreditCardCVCFormField.react",["CreditCardFormParam","React","P2PCreditCardFormFieldMixin.react","PaymentMethodUtils","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=h.createClass({displayName:"P2PCreditCardCVCFormField",mixins:[i],getIcon:function(){return (h.createElement("div",{className:"_31_w _5wcr"}));},getAutocompleteName:function(){return 'cc-csc';},isValAtLimit:function(){var n=this.state.value;return n.length===this.getLimit();},getLimit:function(){var n,o=this.props.cscMaxLength;if(!o){n=j.getCardType(this.props[g.CARD_NUMBER]);o=n.name==='amex'?4:3;}return o;},formatValue:function(n,o,p){var q=this.getLimit();n=n.replace(/\D/g,'');n=n.slice(0,q);return n;},getPlaceholder:function(){return l._("CVV");},validate:function(n){return n.length===this.getLimit();}});e.exports=m;},null);
__d("P2PCreditCardZipCodeFormField.react",["React","P2PCreditCardFormFieldMixin.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g.createClass({displayName:"P2PCreditCardZipCodeFormField",mixins:[h],getIcon:function(){return (g.createElement("div",{className:"_31_w _3oce"}));},getAutocompleteName:function(){return 'postal-code';},isValAtLimit:function(){var l=this.state.value;return l.length===this.getLimit();},getLimit:function(){return 5;},getPlaceholder:function(){return j._("Billing ZIP Code");},formatValue:function(l,m,n){var o=this.getLimit();l=l.replace(/\D/g,'');l=l.slice(0,o);return l;},validate:function(l){return l.length===this.getLimit();}});e.exports=k;},null);
__d("MessengerButton.react",["ReactComponentWithPureRenderMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MessengerButton",mixins:[g],propTypes:{label:l.string.isRequired,type:l.oneOf(['primary','secondary']).isRequired,use:l.oneOf(['default','danger']).isRequired},getDefaultProps:function(){return {use:'default'};},handleLinkClick:function(n){if(this.props.disabled){n.preventDefault();}else if(this.props.onClick)this.props.onClick(n);},render:function(){var n=this.props,o=n.className,p=n.label,q=(function(r,s){var t={},u=Object.prototype.hasOwnProperty;if(r==null)throw new TypeError();for(var v in r)if(u.call(r,v)&&!u.call(s,v))t[v]=r[v];return t;})(n,{className:1,label:1});return (h.createElement("a",h.__spread({className:j((("_3quh")+(' '+"_5vn4")+(' '+"_30yy")+(this.props.type==='primary'?' '+"_2t_":'')+(this.props.type==='secondary'?' '+"_2u0":'')+(this.props.use==='danger'?' '+"_3ay_":'')+(this.props.disabled?' '+"_4zab":'')),o),href:"#"},q,{onClick:this.handleLinkClick}),p));}});e.exports=m;},null);
__d("MessengerDialogButton.react",["MessengerButton.react","ReactComponentWithPureRenderMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"MessengerDialogButton",mixins:[h],propTypes:{action:m.oneOf(['button','cancel','confirm'])},render:function(){var o=this.props,p=o.action,q=o.className,r=(function(s,t){var u={},v=Object.prototype.hasOwnProperty;if(s==null)throw new TypeError();for(var w in s)if(v.call(s,w)&&!v.call(t,w))u[w]=s[w];return u;})(o,{action:1,className:1});return (i.createElement(g,i.__spread({className:k(q,(("_5ixy")+(p==='button'?' '+"layerButton":'')+(p==='cancel'?' '+"layerCancel":'')+(p==='confirm'?' '+"layerConfirm":'')))},r)));}});e.exports=n;},null);
__d("P2PButton.react",["CurrentEnvironment","MessengerDialogButton.react","React","XUIButton.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"P2PButton",render:function(){var l=g.messengerdotcom,m=l?h:j,n=this.props.type;if(!n)n=this.props.type==='confirm'?'primary':'secondary';var o=l?'default':this.props.use,p=Object.assign({},this.props,{type:n,use:o});return (i.createElement(m,i.__spread({},p),this.props.children));}});e.exports=k;},null);
__d("MessengerDialog.react",["LayerFadeOnHide","LayerHideOnEscape","React","XUIDialog.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"MessengerDialog",propTypes:{onToggle:n.func.isRequired,repositionOnUpdate:n.bool,shown:n.bool,type:n.oneOf(['alert','default']),width:n.number},getDefaultProps:function(){return {repositionOnUpdate:false,shown:true,type:'alert',width:400};},componentDidUpdate:function(){if(this.props.repositionOnUpdate)setTimeout(function(){if(this.isMounted()&&this.refs.dialog&&this.refs.dialog.layer)this.refs.dialog.layer.updatePosition();}.bind(this));},render:function(){return (i.createElement(j,i.__spread({behaviors:{LayerFadeOnHide:g,LayerHideOnEscape:h}},this.props,{className:l("_4ebx",this.props.className),ref:"dialog"}),i.createElement("div",{className:(("_4eby")+(this.props.type==='alert'?' '+"_2c9g":'')+(this.props.type==='default'?' '+"_2c9i":''))},this.props.children)));}});e.exports=o;},null);
__d("P2PDialog.react",["CurrentEnvironment","LayerFadeOnHide","MessengerDialog.react","React","XUIDialog.react","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"P2PDialog",propTypes:{onToggle:n.func,shown:n.bool,width:n.number},getDefaultProps:function(){return {onToggle:l,repositionOnUpdate:false,shown:true,width:400};},componentDidUpdate:function(){if(this.props.repositionOnUpdate)setTimeout(function(){if(this.isMounted()&&this.refs.dialog&&this.refs.dialog.layer)this.refs.dialog.layer.updatePosition();}.bind(this));},render:function(){var p=g.messengerdotcom,q=p?i:k;return (j.createElement(q,j.__spread({behaviors:{LayerFadeOnHide:h}},this.props,{ref:"dialog"}),this.props.children));}});e.exports=o;},null);
__d("MessengerDialogBody.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g.createClass({displayName:"MessengerDialogBody",render:function(){return (g.createElement("div",{className:i("_4eb-",this.props.className)},this.props.children));}});e.exports=j;},null);
__d("P2PDialogBody.react",["CurrentEnvironment","MessengerDialogBody.react","React","XUIDialogBody.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"P2PDialogBody",render:function(){var l=g.messengerdotcom,m=l?h:j;return (i.createElement(m,i.__spread({},this.props),this.props.children));}});e.exports=k;},null);
__d("MessengerDialogFooter.react",["LeftRight.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MessengerDialogFooter",propTypes:{leftContent:l.object},render:function(){return (h.createElement("div",{className:j("_4eb_",this.props.className)},h.createElement(g,null,h.createElement("div",{className:"_2_d1"},this.props.leftContent),h.createElement("div",null,this.props.children))));}});e.exports=m;},null);
__d("P2PDialogFooter.react",["CurrentEnvironment","MessengerDialogFooter.react","React","XUIDialogFooter.react","cloneWithProps","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i.createClass({displayName:"P2PDialogFooter",render:function(){var n=g.messengerdotcom,o=n?h:j,p,q=this.props.children;if(n){p=i.Children.count(this.props.children);q=i.Children.map(this.props.children,function(r,s){if(!r)return null;return k(r,{className:"_4ec0",type:s===0&&p===2?'secondary':'primary'});});}return (i.createElement(o,i.__spread({},this.props),q));}});e.exports=m;},null);
__d("MessengerDialogHeader.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g.createClass({displayName:"MessengerDialogHeader",render:function(){return (g.createElement("h4",{className:i("_4ebz",this.props.className)},this.props.children));}});e.exports=j;},null);
__d("P2PDialogTitle.react",["CurrentEnvironment","MessengerDialogHeader.react","React","XUIDialogTitle.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"P2PDialogTitle",render:function(){var l=g.messengerdotcom,m=l?h:j;return (i.createElement(m,i.__spread({},this.props),this.props.children));}});e.exports=k;},null);
__d("MessengerText.react",["ReactComponentWithPureRenderMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MessengerText",mixins:[g],propTypes:{type:l.oneOf(['primary','secondary']).isRequired,size:l.oneOf(['small'])},render:function(){return (h.createElement("div",h.__spread({},this.props,{className:j((("_39r5")+(this.props.type==='primary'?' '+"_39r6":'')+(this.props.type==='secondary'?' '+"_39r7":'')+(this.props.size==='small'?' '+"_39r8":'')),this.props.className)}),this.props.children));}});e.exports=m;},null);
__d("P2PText.react",["CurrentEnvironment","MessengerText.react","React","XUIGrayText.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"P2PText",propTypes:{type:l.oneOf(['primary','secondary']).isRequired},render:function(){var n=g.messengerdotcom,o=n?h:j,p=this.props,q=p.type,r=this.props;if(!n)r=Object.assign({},this.props,{display:this.props.display||'block',shade:q==='primary'?'dark':'light',size:'small'});return (i.createElement(o,i.__spread({},r),this.props.children));}});e.exports=m;},null);
__d("P2PErrorDialog.react",["React","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PText.react","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=g,q=p.PropTypes,r=g.createClass({displayName:"P2PErrorDialog",propTypes:{allowBack:q.bool,onBackClick:q.func,onOKClick:q.func,error:q.object,title:q.string},getDefaultProps:function(){return {allowBack:false,onBackClick:n,onOKClick:n,error:null,title:o._("Problem")};},handleBackButtonClick:function(){this.props.onBackClick();},handleOKButtonClick:function(){this.props.onOKClick();},renderBackButton:function(){var s=null;if(this.props.allowBack)s=g.createElement(h,{label:o._("Back"),onClick:this.handleBackButtonClick,use:"default"});return s;},renderErrorContent:function(){var s=this.props.error;if(s.message.__html){return (g.createElement(m,{dangerouslySetInnerHTML:s.message,type:"primary"}));}else return g.createElement(m,{type:"primary"},s.message);},render:function(){return (g.createElement(i,{layerHideOnBlur:false,shown:true,width:300},g.createElement(l,{showCloseButton:false},this.props.title),g.createElement(j,null,this.renderErrorContent()),g.createElement(k,null,this.renderBackButton(),g.createElement(h,{label:o._("OK"),onClick:this.handleOKButtonClick,use:"default"}))));}});e.exports=r;},null);
__d("XUINotice.react",["React","Image.react","XUICloseButton.react","cx","fbt","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g,o=n.PropTypes,p={notify:{altText:k._("Notice"),className:null,iconSrc:l('/images/deprecated/glyphs/flat/info-flat_m.png')},success:{altText:k._("Success"),className:"_3qh4",iconSrc:l('/images/deprecated/glyphs/flat/checkmark_white_m.png')},warn:{altText:k._("Warning"),className:"_585o",iconSrc:l('/images/deprecated/glyphs/flat/error-flat_m.png')}},q=g.createClass({displayName:"XUINotice",propTypes:{onDismiss:o.func,use:o.oneOf(Object.keys(p)),size:o.oneOf(['medium','small'])},getDefaultProps:function(){return {use:'notify',size:'medium'};},render:function(){var r=this.props,s=r.children,t=r.className,u=r.onDismiss,v=r.use,w=(function(aa,ba){var ca={},da=Object.prototype.hasOwnProperty;if(aa==null)throw new TypeError();for(var ea in aa)if(da.call(aa,ea)&&!da.call(ba,ea))ca[ea]=aa[ea];return ca;})(r,{children:1,className:1,onDismiss:1,use:1}),x=p[v];t=m("_585n",x.className,t);var y=null;if(u)y=g.createElement(i,{className:"_585q",href:"#",onClick:u});var z=(("_585r")+(u?' '+"_2i-a":'')+(this.props.size==='medium'?' '+"_50f4":'')+(this.props.size==='small'?' '+"_50f3":''));return (g.createElement("div",g.__spread({},w,{className:t}),g.createElement(h,{alt:x.altText,className:"_585p",src:x.iconSrc}),y,g.createElement("div",{className:z},s)));}});e.exports=q;},null);
__d("P2PErrorNotice.react",["React","XUINotice.react","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"P2PErrorNotice",propTypes:{error:k.object},getDefaultProps:function(){return {error:null};},renderErrorContent:function(){var m=this.props.error;if(m.message.__html){return g.createElement("span",{dangerouslySetInnerHTML:m.message});}else return g.createElement("span",null,m.message);},render:function(){return (g.createElement(h,{className:"_3-8n",use:"warn"},this.renderErrorContent()));}});e.exports=l;},null);
__d("P2PCreditCardForm.react",["CreditCardFormParam","KappaWrapper","React","P2PAPI","P2PAPIUtils","P2PCreditCardNumberFormField.react","P2PCreditCardExpDateFormField.react","P2PCreditCardCVCFormField.react","P2PCreditCardZipCodeFormField.react","P2PErrorDialog.react","P2PErrorNotice.react","ReactLayeredComponentMixin","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=i,x=w.PropTypes,y=i.createClass({displayName:"P2PCreditCardForm",mixins:[r],propTypes:{asyncRequestState:x.object,cscMaxLength:x.number,editMode:x.bool,onErrorDialogOKClick:x.func,onValidation:x.func,prefilledFormData:x.object,rendersErrorDialog:x.bool,saveErrors:x.object,validateBIN:x.bool},getDefaultProps:function(){return {cscMaxLength:null,editMode:false,onErrorDialogOKClick:t,onValidation:t,prefilledFormData:{},rendersErrorDialog:false,saveErrors:null,validateBIN:false};},getInitialState:function(){var z={};z[g.CARD_NUMBER]={};z[g.CARD_NUMBER].valid=false;z[g.CARD_NUMBER].value=this.props.prefilledFormData[g.CARD_NUMBER]||'';z[g.CARD_EXPIRATION]={};z[g.CARD_EXPIRATION].valid=false;z[g.CARD_EXPIRATION].value=this.props.prefilledFormData[g.CARD_EXPIRATION]||'';z[g.CSC]={};z[g.CSC].valid=false;z[g.CSC].value=this.props.prefilledFormData[g.CSC]||'';z[g.ZIP]={};z[g.ZIP].valid=false;z[g.ZIP].value=this.props.prefilledFormData[g.ZIP]||'';return {binError:'',isValid:false,fields:z,previousBINNumber:'',validateBINRequestID:''};},componentWillMount:function(){h.start(6,3,0);},componentWillReceiveProps:function(z){var aa=z.asyncRequestState,ba=aa?aa[this.state.validateBINRequestID]:null;if(ba){this.setState({validateBINRequestID:''});if(ba.error){this.handleValidateBINNumberError(ba.error);}else this.handleValidateBINNumberSuccess();}},handleValidateBINNumberSuccess:function(){this.setState({binError:''},this.validateForm);},handleValidateBINNumberError:function(z){this.setState({binError:z.message},this.validateForm);},handleCreditCardNumberChange:function(z,aa,ba){if(this.props.validateBIN)this.validateBIN(aa);this.handleFormValueChange(z,aa,ba);},validateBIN:function(z){var aa,ba;z=z.replace(/ /g,'');aa=z.substr(0,6);if(aa!==this.state.previousBINNumber&&aa.length>=6){ba=k.genRequestID();this.setState({validateBINRequestID:ba});j.validateBINNumber({binNumber:aa,requestID:ba});}else if(aa.length<6)this.setState({binError:'',validateBINRequestID:''});this.setState({previousBINNumber:aa});},handleFormValueChange:function(z,aa,ba){var ca=this.state.fields;ca[z]={valid:ba,value:aa};this.validateForm();},validateForm:function(){var z=true,aa=this.state.fields;z=!v(aa).some(function(ba){return !ba.valid;})&&!this.state.binError;this.setState({isValid:z});this.props.onValidation(z,this.serializeFormFields(),this.getFormFieldLoggingData());},serializeFormFields:function(){var z=this.state.fields,aa={};for(var ba in z)if(z.hasOwnProperty(ba))aa[ba]=z[ba].value;return aa;},getFormFieldLoggingData:function(){var z=this.state.fields,aa=z[g.CARD_NUMBER],ba=z[g.CARD_EXPIRATION],ca=z[g.CSC],da=z[g.ZIP],ea={card_number_digits:aa.value.replace(/ /g,'').length,is_card_number_valid:aa.valid,expiration_date_digits:ba.value.replace(/\//,'').length,is_expiration_date_valid:ba.valid,csc_digits:ca.value.length,is_csc_valid:ca.valid,billing_zip_digits:da.value.length,is_billing_zip_valid:da.valid};return {credit_card_validation_data:ea};},getSaveError:function(z){var aa='',ba=this.props.saveErrors;if(ba&&ba.fields&&ba.fields[z])aa=ba.fields[z].message;return aa;},isCreditCardNumberMasked:function(){return this.props.editMode;},isCreditCardNumberFocused:function(){return !this.props.editMode;},isExpFocused:function(){return this.props.editMode;},renderBINError:function(){if(!this.state.binError)return;return (i.createElement(q,{error:{message:this.state.binError}}));},renderGeneralError:function(){var z=this.getGeneralError();if(!z)return;return (i.createElement(q,{error:z}));},getGeneralError:function(){if(this.props.saveErrors&&this.props.saveErrors.general)return this.props.saveErrors.general;return null;},handleErrorOKClick:function(){this.props.onErrorDialogOKClick();},renderLayers:function(){var z=this.getGeneralError();if(!this.props.rendersErrorDialog||!z)return {};return {errorMessageDialog:i.createElement(p,{error:z,onOKClick:this.handleErrorOKClick,title:u._("Problem Saving Card")})};},render:function(){return (i.createElement("form",{className:"_3bez"},!this.props.rendersErrorDialog?this.renderGeneralError():null,this.renderBINError(),i.createElement("div",{className:"_2xxs _2xxt"},i.createElement(l,{reference:g.CARD_NUMBER,onChange:this.handleCreditCardNumberChange,saveError:this.getSaveError(g.CARD_NUMBER)||this.state.binError,value:this.state.fields[g.CARD_NUMBER].value,isMasked:this.isCreditCardNumberMasked(),focused:this.isCreditCardNumberFocused()})),i.createElement("div",{className:"_2xxs _2xxu"},i.createElement(m,{reference:g.CARD_EXPIRATION,focused:this.isExpFocused(),onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CARD_EXPIRATION),value:this.state.fields[g.CARD_EXPIRATION].value}),i.createElement(n,{reference:g.CSC,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CSC),cscMaxLength:this.props.cscMaxLength,creditCardNumber:this.state.fields[g.CARD_NUMBER].value,value:this.state.fields[g.CSC].value})),i.createElement("div",{className:"_2xxs _2xxv"},i.createElement(o,{reference:g.ZIP,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.ZIP),value:this.state.fields[g.ZIP].value}))));}});e.exports=y;},null);
__d("P2PCreditCard",["CreditCardFormParam","CreditCardTypeEnum","PaymentMethodUtils","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={visa:{image:k('/images/payments/icons/visa.png'),imageLarge:k('/images/payments/icons/visa-lg.png'),name:'Visa'},mc:{image:k('/images/payments/icons/mc.png'),imageLarge:k('/images/payments/icons/mc-lg.png'),name:'MasterCard'},disc:{image:k('/images/payments/icons/disc.png'),imageLarge:k('/images/payments/icons/disc-lg.png'),name:'Discover'},jcb:{image:k('/images/payments/icons/jcb.png'),imageLarge:k('/images/payments/icons/jcb-lg.png'),name:'JCB'},amex:{image:k('/images/payments/icons/amex.png'),imageLarge:k('/images/payments/icons/amex-lg.png'),name:'American Express'},unknown:{image:k('/images/brands/credit_card/credit_32.png'),imageLarge:k('/images/brands/credit_card/credit_32.png'),name:j._("Unknown Card Type")}};function m(n){this.setCredentialId(n[g.CREDENTIAL_ID]);this.setCardType(n[g.CARD_TYPE]);this.setCreditCardNumber(n[g.CARD_NUMBER]);this.setSelected(n.selected);this.setZipCode(n[g.ZIP]);this.setCSC(n[g.CSC]);this.setExp(n[g.CARD_EXPIRATION]);this.setIsPreset(n.isPreset);this.setIsVerified(n.isVerified);this.setIsMobileVerified(n.isMobileVerified);}m.prototype.getCreditCardNumber=function(){return this[g.CARD_NUMBER];};m.prototype.setCreditCardNumber=function(n){n=n.replace(/ /g,'');this.setCardProviderProps(this[g.CARD_TYPE],n);n=n.substr(n.length-4);this[g.CARD_NUMBER]=n;};m.prototype.setCardProviderProps=function(n,o){var p=this.$P2PCreditCard0(n,o);if(l[p]){this.setImage(l[p].image);this.setImageLarge(l[p].imageLarge);this.setName(l[p].name);}};m.prototype.getExp=function(){return this[g.CARD_EXPIRATION];};m.prototype.getExpFormatted=function(){var n=this[g.CARD_EXPIRATION];return n?n[g.MONTH]+'/'+n[g.YEAR]:'';};m.prototype.getExpFormattedShort=function(){var n=this[g.CARD_EXPIRATION],o='';if(n&&n[g.MONTH]&&n[g.YEAR]){o=n[g.MONTH]+'/';if(n[g.YEAR].length===4){o+=n[g.YEAR].substr(2);}else o+=n[g.YEAR];}return o;};m.prototype.setExp=function(n){if(!n)return;var o,p,q={};q[g.MONTH]=n[g.MONTH];q[g.YEAR]=n[g.YEAR];if(q[g.MONTH]&&q[g.MONTH].length===1)q[g.MONTH]='0'+q[g.MONTH];if(q[g.YEAR]&&q[g.YEAR].length===2){o=(new Date()).getFullYear()+'';p=o.substr(0,2);q[g.YEAR]=p+q[g.YEAR];}this[g.CARD_EXPIRATION]=q;};m.prototype.getCSC=function(){return this[g.CSC];};m.prototype.setCSC=function(n){this[g.CSC]=n;};m.prototype.getZipCode=function(){return this[g.ZIP];};m.prototype.setZipCode=function(n){this[g.ZIP]=n;};m.prototype.getSelected=function(){return this.$P2PCreditCard1;};m.prototype.setSelected=function(n){this.$P2PCreditCard1=n;};m.prototype.getCardType=function(){return this[g.CARD_TYPE];};m.prototype.setCardType=function(n){this[g.CARD_TYPE]=n;this.setCardProviderProps(n,this[g.CARD_NUMBER]);};m.prototype.getCredentialId=function(){return this[g.CREDENTIAL_ID];};m.prototype.setCredentialId=function(n){this[g.CREDENTIAL_ID]=n;};m.prototype.$P2PCreditCard0=function(n,o){var p='default',q,r;if(n){q=Object.keys(h).filter(function(s){return h[s]===n;})[0];p=this.$P2PCreditCard2(q);}else if(o){r=i.getCardType(o);if(r)p=r.name;}return p;};m.prototype.getImage=function(){return this.$P2PCreditCard3||l.unknown.image;};m.prototype.setImage=function(n){this.$P2PCreditCard3=n;};m.prototype.getImageLarge=function(){return this.$P2PCreditCard4||l.unknown.imageLarge;};m.prototype.setImageLarge=function(n){this.$P2PCreditCard4=n;};m.prototype.getName=function(){return this.$P2PCreditCard5||l.unknown.name;};m.prototype.setName=function(n){this.$P2PCreditCard5=n;};m.prototype.getIsPreset=function(){return this.$P2PCreditCard6;};m.prototype.setIsPreset=function(n){this.$P2PCreditCard6=n||false;};m.prototype.$P2PCreditCard2=function(n){switch(n){case 'VISA':n='visa';break;case 'AMERICANEXPRESS':n='amex';break;case 'MASTERCARD':n='mc';break;case 'DISCOVER':n='disc';break;case 'JCB':n='jcb';break;default:n='unknown';break;}return n;};m.prototype.getCreditCardNumberFormatted=function(){return '*'+this[g.CARD_NUMBER];};m.prototype.getCreditCardNumberMask=function(){return '**** **** **** '+this[g.CARD_NUMBER];};m.prototype.getMaxCSCLength=function(){var n=this.$P2PCreditCard0(this[g.CARD_TYPE],this[g.CARD_NUMBER]);return n==='amex'?4:3;};m.prototype.getIsVerified=function(){return this.$P2PCreditCard7||false;};m.prototype.setIsVerified=function(n){this.$P2PCreditCard7=n;};m.prototype.getIsMobileVerified=function(){return this.$P2PCreditCard8||false;};m.prototype.setIsMobileVerified=function(n){this.$P2PCreditCard8=n;};m.prototype.isExpired=function(){var n=this.getExp();if(!n)return false;var o=n,p=o.month,q=o.year,r=new Date(),s=r.getFullYear()+'',t=(r.getMonth()+1)+'';t=t.length===1?'0'+t:t;return q<s||(s===q&&p<t);};e.exports=m;},null);
__d("XUIRadioInput.react",["React","cx","joinClasses","invariant"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g.createClass({displayName:"XUIRadioInput",render:function(){j(!this.props.children||this.props.children.length===0);var l=i(this.props.className,"_55sh"),m=g.createElement("input",g.__spread({},this.props,{className:null,type:"radio"}),undefined);return (g.createElement("label",{className:l},m,g.createElement("span",null)));}});e.exports=k;},null);
__d("XUIRadioList.react",["InputLabel.react","React","ReactChildren","XUIRadioInput.react","cloneWithProps"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h,m=l.PropTypes,n=h.createClass({displayName:"XUIRadioList",propTypes:{name:m.string,onValueChange:m.func,selectedValue:m.any},render:function(){var o=i.map(this.props.children,function(p){return k(p,{name:this.props.name,onSelect:this.props.onValueChange,selectedValue:this.props.selectedValue});},this);return h.createElement("ul",h.__spread({},this.props,{name:null}),o);}});n.Item=h.createClass({displayName:"XUIRadioList.Item",propTypes:{name:m.string,onSelect:m.func,selectedValue:m.any,value:m.any,disabled:m.bool},render:function(){return (h.createElement("li",{className:this.props.className},h.createElement(g,{display:"inline"},h.createElement(j,{checked:this.props.selectedValue===this.props.value,name:this.props.name,onChange:this._handleChange,value:this.props.value,disabled:!!this.props.disabled}),h.createElement("label",null,this.props.children))));},_handleChange:function(event){this.props.onSelect&&this.props.onSelect(event.target.value);}});e.exports=n;},null);
__d("P2PChooseCreditCardForm.react",["CurrentEnvironment","Image.react","P2PCreditCard","React","XUIRadioList.react","XUIGrayText.react","cx","emptyFunction","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=k.Item,r=j,s=r.PropTypes,t='add_debit_card',u=g.messengerdotcom,v=j.createClass({displayName:"P2PChooseCreditCardForm",propTypes:{creditCards:s.arrayOf(s.instanceOf(i)),selectedCard:s.instanceOf(i).isRequired},getDefaultProps:function(){return {creditCards:[],selectedCard:null,onChange:n,onAddDebitCardOptionSelected:n,showAddDebitCardOption:false};},getInitialState:function(){return {selectedCard:this.props.selectedCard};},getSelectedCard:function(){return this.state.selectedCard;},onChange:function(w){var x;if(w===t){this.props.onAddDebitCardOptionSelected();}else{x=this.props.creditCards.filter(function(y){return y.getCredentialId()===w;})[0];this.setState({selectedCard:x});this.props.onChange(x);}},renderCardItem:function(w,x){return (j.createElement(q,{className:"_2x6n",key:'item-'+x,value:w.getCredentialId()},j.createElement(l,{className:"_3-8r _2jp9",shade:"dark",weight:"bold"},w.getName()),j.createElement(l,{shade:"dark",weight:"normal"},w.getCreditCardNumberFormatted()),j.createElement(h,{className:"_2x6p",height:24,src:w.getImage(),width:36})));},renderAddDebitCardRadioItem:function(){return (j.createElement(q,{className:"_2x6n _1gri",key:'item-'+this.props.creditCards.length,value:t},j.createElement(l,{className:"_3-8r _2jpa",shade:"dark"},o._("New Debit Card"))));},getRadioListItems:function(){var w=this.props.creditCards,x=w.map(this.renderCardItem);if(this.props.showAddDebitCardOption)x.push(this.renderAddDebitCardRadioItem());return x;},render:function(){return (j.createElement(k,{selectedValue:this.state.selectedCard.getCredentialId(),className:p(this.props.className,(("_2x6r")+(u?' '+"_2jpb":''))),onValueChange:this.onChange},this.getRadioListItems()));}});e.exports=v;},null);
__d("P2PLoadingMask.react",["React","XUISpinner.react","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"P2PLoadingMask",propTypes:{visible:k.bool},getDefaultProps:function(){return {visible:false};},render:function(){if(!this.props.visible)return null;return (g.createElement("div",{className:"_3de"},g.createElement(h,{background:"dark",size:"large",className:"_3df"}),g.createElement("div",{className:"_3dg"})));}});e.exports=l;},null);
__d("P2PLogger",["BanzaiLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h='P2PPaymentLoggerConfig',i={log:function(j,k){k=Object.assign({event:j},k);g.log(h,k);}};e.exports=i;},null);
__d("P2PPasswordProtectionNUXDialog.react",["CurrentEnvironment","Link.react","P2PAPI","P2PErrorDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionParam","P2PPasswordProtectionStatusTypes","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=r,ca=ba.PropTypes,da=g.messengerdotcom,ea=r.createClass({displayName:"P2PPasswordProtectionNUXDialog",propTypes:{onComplete:ca.func},getDefaultProps:function(){return {onComplete:z};},getInitialState:function(){return {saveErrorObject:null,loading:false};},componentWillMount:function(){this.log(n.UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX);},log:function(fa,ga){m.log(fa,Object.assign({www_event_flow:o.UI_FLOW_P2P_SETTINGS},ga));},onSaveClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(q.ENABLED);this.log(n.UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX);},setPasswordProtection:function(fa){var ga={};ga[p.STATUS]=fa;i.setPasswordProtectionSetting({formData:ga,success:this.handleOnSaveSuccess,error:this.handleOnSaveError});},handleOnSaveSuccess:function(){this.setState({loading:false});this.props.onComplete();},handleOnSaveError:function(fa){this.setState({loading:false,saveErrorObject:fa});},isSaveButtonDisabled:function(){return this.state.loading;},isCancelButtonDisabled:function(){return this.state.loading;},onCancelClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(q.DISABLED);this.log(n.UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX);},handleErrorBackClick:function(){this.setState({saveErrorObject:null});},handleErrorOKClick:function(){this.setState({saveErrorObject:null});this.props.onComplete();},render:function(){var fa=da?320:300;if(this.state.saveErrorObject)return (r.createElement(j,{allowBack:true,title:aa._("Problem Saving"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}));return (r.createElement(t,{className:((da?"_-el":'')),behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:fa},r.createElement(u,{showCloseButton:false},aa._("Use Password?")),r.createElement(v,null,r.createElement(x,{className:"_5sor",type:"primary"},aa._("For additional security, you can enter your Facebook password to send money. You can always update this in {link}.",[aa.param("link",r.createElement(h,{href:k.settingsWWWURI,target:"_blank"},aa._("Settings")))]))),r.createElement(w,null,r.createElement(s,{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:aa._("Not Now"),onClick:this.onCancelClick,size:"medium",use:"default"}),r.createElement(s,{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:aa._("Use Password"),onClick:this.onSaveClick,size:"medium",use:"confirm"})),r.createElement(l,{visible:this.state.loading})));}});e.exports=ea;},null);
__d("LayerSlowlyFadeOnShow",["LayerFadeOnShow"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=500,i=g.forDuration(h);e.exports=i;},null);
__d("P2PSuccessDialog.react",["CurrentEnvironment","Image.react","LayerFadeOnHide","LayerSlowlyFadeOnShow","LeftRight.react","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","ix","cx","fbt","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=l,x=w.PropTypes,y=l.createClass({displayName:"P2PSuccessDialog",propTypes:{onOKClick:x.func,title:x.string.isRequired},getDefaultProps:function(){return {onOKClick:v};},render:function(){var z=g.messengerdotcom,aa=z?350:300,ba=z?s("/images/p2p/checkmark-messenger.png"):s("/images/p2p/check_mark-sm.png"),ca=[l.createElement("div",{className:"_1tcj",key:"checkmark"},l.createElement(h,{height:50,width:50,src:ba})),l.createElement(r,{className:"_3exn",key:"confirmation_text",type:"primary"},this.props.children)];if(z)ca=l.createElement(k,{direction:"left"},ca);return (l.createElement(n,{behaviors:{LayerFadeOnShow:false,LayerSlowlyFadeOnShow:j,LayerFadeOnHide:i},className:(("_1tck")+(z?' '+"_1tcl":'')),layerHideOnBlur:false,ref:"dialog",repositionOnUpdate:true,shown:true,width:aa},l.createElement("div",{className:"_1tcm"},l.createElement(o,{className:"_1tcn",showCloseButton:false},this.props.title),l.createElement(p,null,ca),l.createElement(q,null,l.createElement(m,{use:"default",label:u._("OK"),onClick:this.props.onOKClick})))));}});e.exports=y;},null);
__d("P2PVerifyCreditCardDialog.react",["CreditCardFormParam","CurrentEnvironment","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PErrorNotice.react","P2PLoadingMask.react","React","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PCreditCardCVCFormField.react","P2PCreditCardZipCodeFormField.react","XUICloseButton.react","P2PDialogTitle.react","P2PText.react","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();var ba=n,ca=ba.PropTypes,da=h.messengerdotcom,ea=n.createClass({displayName:"P2PVerifyCreditCardDialog",propTypes:{asyncRequestState:ca.object,creditCard:ca.instanceOf(k),onCancel:ca.func,onConfirm:ca.func,isSending:ca.bool},getDefaultProps:function(){return {asyncRequestState:{},creditCard:null,isSending:true,onCancel:y,onError:y,onSuccess:y};},getInitialState:function(){var fa={};fa[g.CSC]={};fa[g.CSC].valid=false;if(this.shouldShowZIPInput()){fa[g.ZIP]={};fa[g.ZIP].valid=false;}return {isValid:false,loading:false,requestID:'',saveError:null,fields:fa};},componentWillReceiveProps:function(fa){var ga=fa.asyncRequestState?fa.asyncRequestState[this.state.requestID]:null;if(ga){this.setState({requestID:''});if(ga.error){this.handleOnSaveError(ga.error);}else this.handleOnSaveSuccess(ga);}},handleOnSaveSuccess:function(fa){this.props.onSuccess(fa);},handleOnSaveError:function(fa){this.setState({loading:false,saveError:fa});},clearSaveError:function(){this.setState({saveError:null});},handleCancelClick:function(){this.props.onCancel();},handleConfirmClick:function(){var fa={},ga=j.genRequestID();fa[g.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();fa[g.CSC]=this.state.fields[g.CSC].value;if(this.state.fields[g.ZIP])fa[g.ZIP]=this.state.fields[g.ZIP].value;this.clearSaveError();this.setState({loading:true,requestID:ga});i.verifyCreditCard(Object.assign({requestID:ga},fa));},handleFormValueChange:function(fa,ga,ha){var ia=this.state.fields;ia[fa].value=ga;ia[fa].valid=ha;this.setState({fields:ia});this.validateForm();},validateForm:function(){var fa=true,ga=this.state.fields;fa=!aa(ga).some(function(ha){return !ha.valid;});this.setState({isValid:fa});},handleCloseButtonClick:function(){this.props.onCancel();},shouldShowZIPInput:function(){var fa=!!(this.props.creditCard.getZipCode());return !fa;},renderError:function(){var fa;if(this.state.saveError)fa=n.createElement(l,{error:this.state.saveError});return fa;},renderCVCFormField:function(){return (n.createElement(s,{cscMaxLength:this.props.creditCard.getMaxCSCLength(),focused:true,onChange:this.handleFormValueChange,reference:'csc',showIcon:false,showPlaceholder:false,showFocusOutline:false}));},renderZIPFormField:function(){return (n.createElement(t,{onChange:this.handleFormValueChange,reference:'zip',showIcon:false,showPlaceholder:false,showFocusOutline:false}));},getMessage:function(){var fa=this.props.creditCard.getName(),ga=this.props.creditCard.getCreditCardNumber();if(this.props.isSending){if(this.shouldShowZIPInput()){return (n.createElement(w,{type:"primary"},z._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} and Billing ZIP Code to send this payment.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));}else return (n.createElement(w,{type:"primary"},z._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} to send this payment.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));}else if(this.shouldShowZIPInput()){return (n.createElement(w,{type:"primary"},z._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} and Billing ZIP Code to accept this payment.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));}else return (n.createElement(w,{type:"primary"},z._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} to accept this payment.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));},getInputs:function(){var fa,ga=n.createElement("div",{className:"_3yfa"},n.createElement(w,{className:"_197h",type:"primary"},z._("Security Code")),n.createElement("div",{className:"_197i"},this.renderCVCFormField()));if(this.shouldShowZIPInput())fa=n.createElement("div",{className:"_3yfb"},n.createElement(w,{className:"_197h",type:"primary"},z._("Billing ZIP Code")),n.createElement("div",{className:"_197i"},this.renderZIPFormField()));return (n.createElement("div",null,ga,fa));},render:function(){var fa,ga,ha;if(da){ha=320;fa=n.createElement(o,{use:"default",size:"medium",label:z._("Cancel"),disabled:this.state.loading,onClick:this.props.onCancel});}else{ha=300;ga=n.createElement(u,{onClick:this.handleCloseButtonClick});}return (n.createElement(p,{className:((da?"_4ypw":'')),layerHideOnBlur:false,ref:"dialog",repositionOnUpdate:true,shown:true,width:ha},n.createElement(v,{showCloseButton:false},z._("Enter Security Code"),ga),n.createElement(q,null,n.createElement("div",{className:"_197f"},this.getMessage()),this.renderError(),n.createElement("div",{className:"_197g"},this.getInputs())),n.createElement(r,null,fa,n.createElement(o,{label:z._("Confirm"),onClick:this.handleConfirmClick,disabled:!this.state.isValid||this.state.loading,use:"confirm"})),n.createElement(m,{visible:this.state.loading})));}});e.exports=ea;},null);
__d("P2PEditCreditCardDialog.react",["CreditCardFormParam","CurrentEnvironment","React","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PCreditCardForm.react","P2PLoadingMask.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PButton.react","P2PText.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=i,x=w.PropTypes,y=i.createClass({displayName:"P2PEditCreditCardDialog",propTypes:{asyncRequestState:x.object.isRequired,creditCard:x.instanceOf(l).isRequired,onCancel:x.func.isRequired,onSuccess:x.func.isRequired},getInitialState:function(){return {isValid:false,formData:{},loading:false,requestID:'',saveErrors:null};},componentWillReceiveProps:function(z){var aa=z.asyncRequestState?z.asyncRequestState[this.state.requestID]:null;if(aa){this.setState({requestID:''});if(aa.error){this.handleOnSaveError(aa.error);}else this.handleOnSaveSuccess(aa);}},clearSaveErrors:function(){this.setState({saveErrors:null});},onSaveClick:function(z){var aa={},ba=k.genRequestID();aa[g.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:true,requestID:ba});j.updateCreditCard(Object.assign({requestID:ba},aa,this.state.formData));},handleOnSaveSuccess:function(z){this.props.onSuccess(z);},onCancelClick:function(z){this.props.onCancel();},handleOnSaveError:function(z){this.setState({loading:false,saveErrors:z});},isSaveDisabled:function(){return !this.state.isValid||this.state.loading;},isCancelDisabled:function(){return this.state.loading;},handleValidation:function(z,aa){this.setState({isValid:z,formData:aa});},getPrefilledFormData:function(){var z={};z[g.CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();z[g.CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();z[g.ZIP]=this.props.creditCard.getZipCode();return z;},handleErrorDialogOKClick:function(){this.clearSaveErrors();},onToggle:function(z){if(!z)this.props.onCancel();},render:function(){var z=h.messengerdotcom,aa=z?350:300;return (i.createElement(o,{layerHideOnBlur:false,onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:aa},i.createElement(p,null,v._("Update Debit Card")),i.createElement(q,null,i.createElement(t,{className:"_3-96",type:"primary"},v._("Please update the expiration date for your card ending in {card numbers}.",[v.param("card numbers",this.props.creditCard.getCreditCardNumber())])),i.createElement(m,{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:true,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()})),i.createElement(r,null,i.createElement(s,{use:"default",size:"medium",label:v._("Cancel"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick}),i.createElement(s,{use:"confirm",size:"medium",label:v._("Save"),disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),i.createElement(n,{visible:this.state.loading})));}});e.exports=y;},null);
__d("Layout.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g.createClass({displayName:"Layout",render:function(){var k=[],l=[],m=null;g.Children.forEach(this.props.children,function(o,p){if(!o)return;var q=m!==null,r=g.cloneElement(o,{className:i(o.props.className,((q?"_4bl8":''))),key:p});if(m===null){if(o.type===j.FillColumn){m=r;}else k.push(r);}else l.push(r);});l.reverse();var n=k.concat(l);if(m)n.push(m);return (g.createElement("div",g.__spread({},this.props,{className:i(this.props.className,'clearfix')}),n));}});j.Column=g.createClass({displayName:"Layout.Column",render:function(){return (g.createElement("div",g.__spread({},this.props,{className:i(this.props.className,"_4bl7")})));}});j.FillColumn=g.createClass({displayName:"Layout.FillColumn",render:function(){return (g.createElement("div",g.__spread({},this.props,{className:i(this.props.className,"_4bl9")})));}});e.exports=j;},null);
__d("Grid.react",["React","ReactChildren","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g,l=k.PropTypes,m=g.createClass({displayName:"Grid",propTypes:{cols:l.number.isRequired,fixed:l.bool,alignv:l.oneOf(['top','middle','bottom']),alignh:l.oneOf(['left','center','right']),spacing:l.string},render:function(){var o=this.props,p=o.alignh,q=o.alignv,r=o.children,s=o.cols,t=o.fixed,u=o.spacing,v=h.count(r),w=[],x=[],y=0;h.forEach(r,function(z,aa){if(z===null||z===undefined)return;var ba=z.type===n;y+=ba?Math.max(z.props.colSpan||0,1):1;var ca=((y===s?"_51mw":''));if(!ba){z=g.createElement(n,{alignh:p,alignv:q,className:j(u,ca),key:z.key||aa},z);}else z=g.cloneElement(z,{key:z.key||aa,alignh:z.props.alignh||p,alignv:z.props.alignv||q,className:j(z.props.className,u,ca)});x.push(z);if(y%s===0||aa+1===v){if(t&&y<s){for(var da=y;da<s;da++)x.push(g.createElement(n,{key:aa+da}));y=s;}w.push(g.createElement("tr",{className:"_51mx",key:aa},x));x=[];y=0;}});return (g.createElement("table",g.__spread({},this.props,{className:j(this.props.className,(("uiGrid")+(' '+"_51mz")+(t?' '+"_5f0n":''))),cellSpacing:"0",cellPadding:"0"}),g.createElement("tbody",null,w)));}}),n=g.createClass({displayName:"GridItem",propTypes:{alignv:l.oneOf(['top','middle','bottom']),alignh:l.oneOf(['left','center','right'])},render:function(){var o=j(this.props.className,(("_51m-")+(this.props.alignv==='top'?' '+"vTop":'')+(this.props.alignv==='middle'?' '+"vMid":'')+(this.props.alignv==='bottom'?' '+"vBot":'')+(this.props.alignh==='left'?' '+"hLeft":'')+(this.props.alignh==='center'?' '+"hCent":'')+(this.props.alignh==='right'?' '+"hRght":'')));return (g.createElement("td",g.__spread({},this.props,{className:o})));}});m.GridItem=n;e.exports=m;},null);
__d("P2PAcceptMoneyDialog.react",["CreditCardFormParam","CurrentEnvironment","Link.react","P2PCreditCardForm.react","P2PAPI","P2PAPIUtils","P2PChooseCreditCardForm.react","P2PCreditCard","P2PErrorDialog.react","P2PErrorNotice.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSuccessDialog.react","P2PTransferParam","P2PVerifyCreditCardDialog.react","React","P2PButton.react","P2PDialog.react","P2PEditCreditCardDialog.react","PaymentsP2PCreditCardDialog.react","XUICloseButton.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){b.__markCompiled&&b.__markCompiled();'use strict';var na=aa,oa=na.PropTypes,pa='fbP2PAcceptMoneyDialog_learnMoreSentenceID',qa=h.messengerdotcom,ra=aa.createClass({displayName:"P2PAcceptMoneyDialog",propTypes:{asyncRequestState:oa.object,creditCards:oa.arrayOf(oa.instanceOf(n)).isRequired,useRedesignForm:oa.bool,onClose:oa.func,transfer:oa.object},getDefaultProps:function(){return {asyncRequestState:{},onClose:la,creditCards:[],useRedesignForm:false};},getInitialState:function(){return {addCreditCardRequestID:'',isValid:false,declineErrorObject:null,editCreditCardDialogShown:false,formData:{},formFieldLoggingData:{},loading:false,passwordNUXPending:false,passwordProtectionNUXDialogShown:false,presetRequestID:'',presetSaveErrorObject:null,saveErrors:null,selectedCard:this.props.creditCards[0],showConfirmation:false,showDeclineConfirmation:false,showChooseCreditCardForm:this.props.creditCards.length>0,verifyCreditCardDialogShown:false};},log:function(sa,ta){s.log(sa,Object.assign({www_event_flow:w.UI_FLOW_P2P_RECEIVE,object_id:this.props.transfer[y.TRANSFER_ID]},ta));},componentWillMount:function(){this.log(v.UI_ACTN_INITIATE_ADD_CARD);},componentWillReceiveProps:function(sa){var ta=sa.asyncRequestState,ua=ta?ta[this.state.addCreditCardRequestID]:null,va=ta?ta[this.state.presetRequestID]:null;if(ua){this.setState({addCreditCardRequestID:''});if(ua.error){this.handleAcceptAddCardError(ua.error);}else this.handleAcceptAddCardSuccess(ua);}else if(va){this.setState({presetRequestID:''});if(va.error){this.handleUpdatePresetCreditCardError(va.error);}else this.handleUpdatePresetCreditCardSuccess(va);}},handleAddCardBackButtonClick:function(){this.setState({isValid:false,formData:{},formFieldLoggingData:{},presetSaveErrorObject:null,saveErrors:null,showChooseCreditCardForm:true});},handleAcceptWithCardButtonClick:function(){this.initiateAcceptWithSelectedCard();},handleRedesignFormCancelClick:function(){if(this.props.creditCards.length!==0){this.handleAddCardBackButtonClick();}else this.handleCloseButtonClick();},initiateAcceptWithSelectedCard:function(){if(this.state.selectedCard.isExpired()){this.setState({editCreditCardDialogShown:true,verifyCreditCardDialogShown:false});this.log(v.UI_ACTN_EDIT_CARD);return;}else if(!this.state.selectedCard.getIsVerified()){this.setState({verifyCreditCardDialogShown:true,editCreditCardDialogShown:false});this.log(v.UI_ACTN_VERIFY_CSC);return;}this.acceptWithSelectedCard();},acceptWithSelectedCard:function(){this.setState({presetSaveErrorObject:null,loading:true});this.log(v.UI_ACTN_ACCEPT_WITH_CARD);this.updatePresetCreditCard(this.state.selectedCard.getCredentialId());},onVerifyCreditCardSuccess:function(){this.initiateAcceptWithSelectedCard();},onVerifyCreditCardCancel:function(){this.setState({verifyCreditCardDialogShown:false});},onEditCreditCardSuccess:function(){this.initiateAcceptWithSelectedCard();},onEditCreditCardCancel:function(){this.setState({editCreditCardDialogShown:false});},handleAddDebitCardOptionClicked:function(){this.setState({presetSaveErrorObject:null,showChooseCreditCardForm:false});},handleDeclineCardBackButtonClick:function(){this.setState({isValid:false,formData:{},formFieldLoggingData:{},presetSaveErrorObject:null,saveErrors:null,showDeclineConfirmation:false});},handleDeclineCardSubmitButtonClick:function(){var sa={};this.setState({loading:true,declineErrorObject:null});sa[y.TRANSFER_ID]=this.props.transfer[y.TRANSFER_ID];k.declineTransaction({formData:sa,success:this.handleDeclineSuccess,error:this.handleDeclineError});},handleDeclineSuccess:function(){this.props.onClose();},handleDeclineError:function(sa){this.setState({loading:false,declineErrorObject:sa});},handleNoDebitCardClick:function(){if(!this.state.loading)this.setState({showDeclineConfirmation:true});},handleAcceptAddCardClick:function(){var sa=l.genRequestID();this.setState({addCreditCardRequestID:sa,loading:true,presetSaveErrorObject:null,saveErrors:null});this.log(v.UI_ACTN_CONFIRM_CARD_DETAILS);k.addCreditCard(Object.assign({requestID:sa},this.state.formData));},handleAcceptAddCardSuccess:function(sa){this.updatePresetCreditCard(sa[g.CREDENTIAL_ID]);this.log(v.UI_ACTN_ADD_CARD_SUCCESS);},handleAcceptAddCardError:function(sa){this.setState({loading:false,saveErrors:sa});this.log(v.UI_ACTN_ADD_CARD_FAIL,{message:sa&&sa.general?sa.general.message:''});},updatePresetCreditCard:function(sa){var ta={},ua=l.genRequestID();ta[g.CREDENTIAL_ID]=sa;this.setState({presetRequestID:ua});k.updatePresetCreditCard(Object.assign({},ta,{requestID:ua}));},handleUpdatePresetCreditCardSuccess:function(sa){this.setState({loading:false,editCreditCardDialogShown:false,verifyCreditCardDialogShown:false,showConfirmation:true,passwordNUXPending:sa.passwordProtection===u.NOT_SET});},handleUpdatePresetCreditCardError:function(sa){this.setState({loading:false,presetSaveErrorObject:sa});},handleValidation:function(sa,ta,ua){this.setState({isValid:sa,formData:ta,formFieldLoggingData:ua});},handleConfirmationOKClick:function(){if(this.state.passwordNUXPending){this.setState({passwordNUXPending:false,passwordProtectionNUXDialogShown:true});}else this.props.onClose();},handleCloseButtonClick:function(){this.props.onClose();this.log(v.UI_ACTN_CANCEL_ADD_CARD,this.state.formFieldLoggingData);},handleErrorBackClick:function(){this.setState({declineErrorObject:null});},handleErrorOKClick:function(){this.setState({declineErrorObject:null});this.props.onClose();},handlePasswordProtectionNUXComplete:function(){this.setState({passwordProtectionNUXDialogShown:false});this.props.onClose();},handleCreditCardSelected:function(sa){this.setState({selectedCard:sa});},renderChooseCreditCardForm:function(){var sa,ta;if(!qa){sa=aa.createElement(fa,{onClick:this.handleCloseButtonClick});}else ta=aa.createElement(ba,{use:"default",size:"medium",label:ma._("Cancel"),disabled:this.state.loading,onClick:this.handleCloseButtonClick});return (aa.createElement("div",{className:"_2_t"},aa.createElement(ga,{showCloseButton:false},ma._("Select Debit Card"),sa),aa.createElement(ha,{className:"_2_u"},aa.createElement(ja,{type:"primary",className:"_2_w"},ma._("You can use a debit card you've already added to Facebook or add a new one.")),this.renderPresetError(),aa.createElement(m,{className:((!qa?"_2pij":'')),creditCards:this.props.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardOptionClicked,onChange:this.handleCreditCardSelected,ref:"choose_credit_card_form",selectedCard:this.state.selectedCard,showAddDebitCardOption:true})),aa.createElement(ia,null,ta,aa.createElement(ba,{disabled:this.state.loading,label:ma._("Accept"),onClick:this.handleAcceptWithCardButtonClick,size:"medium",use:"confirm"}))));},renderPresetError:function(){var sa;if(this.state.presetSaveErrorObject)sa=aa.createElement(p,{error:this.state.presetSaveErrorObject});return sa;},renderDeclineLink:function(){if(this.props.creditCards.length!==0)return null;return (aa.createElement(ja,{type:"secondary"},aa.createElement(i,{href:"#",onClick:this.handleNoDebitCardClick},ma._("Decline Payment"))));},renderAcceptMoney:function(){var sa=this.props.transfer,ta,ua=aa.createElement(ba,{disabled:this.state.loading||!this.state.isValid,label:ma._("Accept"),onClick:this.handleAcceptAddCardClick,size:"medium",use:"confirm"}),va,wa,xa;if(!qa){wa=aa.createElement(fa,{onClick:this.handleCloseButtonClick});}else va=aa.createElement(ba,{use:"default",size:"medium",label:ma._("Cancel"),disabled:this.state.loading,onClick:this.handleCloseButtonClick});if(this.props.creditCards.length===0){xa=ma._("Add Debit Card");ta=aa.createElement(ia,{leftContent:this.renderDeclineLink()},va,ua);}else{xa=ma._("New Debit Card");ta=aa.createElement(ia,null,aa.createElement(ba,{disabled:this.state.loading,label:ma._("Back"),onClick:this.handleAddCardBackButtonClick,size:"medium",use:"default"}),ua);}return (aa.createElement("div",{className:"_1p_r"},aa.createElement(ga,{showCloseButton:false},xa,wa),aa.createElement(ha,null,aa.createElement(ja,{type:"primary",className:"_3-96"},ma._("{sender_name} sent you {currency}{amount}. Add a debit card to accept it. Credit cards can't be used.",[ma.param("sender_name",sa.sender.name),ma.param("currency",sa.currency),ma.param("amount",sa.amount)])),aa.createElement("div",{className:"_1p_w"},this.renderPresetError(),aa.createElement(j,{asyncRequestState:this.props.asyncRequestState,onValidation:this.handleValidation,saveErrors:this.state.saveErrors,validateBIN:true})),aa.createElement(ja,{id:pa,type:"secondary"},ma._("Your payment info is stored securely. {Link to P2P learn more page.}",[ma.param("Link to P2P learn more page.",aa.createElement(i,{"aria-describedby":pa,href:q.addDebitCardHelpURI,target:"_blank"},ma._("Learn more.")))]))),ta));},renderDeclineConfirmation:function(){var sa=this.props.transfer,ta;if(!qa)ta=aa.createElement(fa,{onClick:this.handleCloseButtonClick});return (aa.createElement("div",{className:"_301"},aa.createElement(ga,{showCloseButton:false},ma._("Decline Payment?"),ta),aa.createElement(ha,null,aa.createElement(ja,{type:"primary"},ma._("Declining this payment will send the money back to {friendName}.",[ma.param("friendName",sa.sender.name)]))),aa.createElement(ia,null,aa.createElement(ba,{disabled:this.state.loading,label:ma._("Back"),onClick:this.handleDeclineCardBackButtonClick,size:"medium",use:"default"}),aa.createElement(ba,{disabled:this.state.loading,label:ma._("Decline"),onClick:this.handleDeclineCardSubmitButtonClick,size:"medium",use:"default"}))));},render:function(){var sa,ta=qa?350:300;if(this.state.verifyCreditCardDialogShown){return (aa.createElement(z,{creditCard:this.state.selectedCard,asyncRequestState:this.props.asyncRequestState,isSending:false,onCancel:this.onVerifyCreditCardCancel,onSuccess:this.onVerifyCreditCardSuccess}));}else if(this.state.editCreditCardDialogShown){return (aa.createElement(da,{asyncRequestState:this.props.asyncRequestState,creditCard:this.state.selectedCard,onCancel:this.onEditCreditCardCancel,onSuccess:this.onEditCreditCardSuccess}));}else if(this.state.declineErrorObject){return (aa.createElement(o,{ref:"decline_error",allowBack:true,onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.declineErrorObject,title:ma._("Problem Declining")}));}else if(this.state.passwordProtectionNUXDialogShown){return (aa.createElement(t,{onComplete:this.handlePasswordProtectionNUXComplete}));}else if(this.state.showConfirmation)return (aa.createElement(x,{onOKClick:this.handleConfirmationOKClick,title:ma._("Payment Received")},aa.createElement(ja,{type:"primary"},ma._("Money you receive from now on will automatically go on this card. You can update your card in {Link with text that goes to settings page}.",[ma.param("Link with text that goes to settings page",aa.createElement(i,{target:"_blank",href:q.settingsWWWURI},ma._("Payments Settings")))]))));if(this.state.showDeclineConfirmation){sa=this.renderDeclineConfirmation();}else if(this.state.showChooseCreditCardForm){sa=this.renderChooseCreditCardForm();}else if(this.props.useRedesignForm){return (aa.createElement(ea,{leftContent:this.renderDeclineLink(),onCancel:this.handleRedesignFormCancelClick,onSuccess:this.handleAcceptAddCardSuccess,asyncRequestState:this.props.asyncRequestState}));}else sa=this.renderAcceptMoney();return (aa.createElement(ca,{className:(("_309")+(qa?' '+"_5ktw":'')),layerHideOnBlur:false,ref:"dialog",repositionOnUpdate:true,shown:true,width:ta},sa,aa.createElement(r,{ref:"send_money_dialog_loader",visible:this.state.loading})));}});e.exports=ra;},null);
__d("P2PBigAmount.react",["CurrentEnvironment","Image.react","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"P2PBigAmount",propTypes:{amount:m.string.isRequired,isPending:m.bool},getImage:function(){if(this.isMessengerDotCom()){if(this.props.isPending){return k('/images/p2p/message-icon-dark-gray.png');}else return k('/images/p2p/message-icon-blue.png');}else if(this.props.isPending){return k('/images/p2p/message-icon-gray.png');}else return k('/images/p2p/message-icon-black.png');},isMessengerDotCom:function(){return g.messengerdotcom;},render:function(){return (i.createElement("div",{className:(("_8j6")+(this.isMessengerDotCom()?' '+"_8j7":''))},i.createElement("div",{className:"_8j8"},i.createElement(h,{height:16,src:this.getImage(),width:16})),i.createElement("div",{className:(("_8jc")+(this.props.isPending?' '+"_8jd":'')+(this.props.amount.length>=8?' '+"_8je":''))},this.props.amount)));}});e.exports=n;},null);
__d("P2PCreditCardStore",["P2PActionConstants","CreditCardFormParam","EventEmitter","ImmutableObject","P2PAPI","P2PCreditCard","P2PDispatcher"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n,o,p,q,r;function s(x,y){if(x)r[x]=new j(y);}function t(x,y){if(x)r[x]={error:y};}for(var u in i)if(i.hasOwnProperty(u))w[u]=i[u];var v=i===null?null:i.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=i;function w(){i.call(this);p=false;q=false;n=[];r={};o=m.register(this.onEventDispatched.bind(this));}w.prototype.onEventDispatched=function(x){var y=x.data,z=x.type;switch(z){case g.CREDIT_CARDS_UPDATED:this.handleCreditCardsUpdated(y);this.emit('change');break;case g.CREDIT_CARD_ADDED:this.handleCreditCardAdded(y);this.emit('change');break;case g.CREDIT_CARD_ADDED_ERROR:this.handleCreditCardAddedError(y);this.emit('change');break;case g.CREDIT_CARD_DELETED:this.handleCreditCardDeleted(y);this.emit('change');break;case g.CREDIT_CARD_DELETED_ERROR:this.handleCreditCardDeletedError(y);this.emit('change');break;case g.CREDIT_CARD_UPDATED:this.handleCreditCardUpdated(y);this.emit('change');break;case g.CREDIT_CARD_UPDATED_ERROR:this.handleCreditCardUpdatedError(y);this.emit('change');break;case g.PRESET_CREDIT_CARD_UPDATED:this.handlePresetCreditCardUpdated(y);this.emit('change');break;case g.PRESET_CREDIT_CARD_UPDATED_ERROR:this.handlePresetCreditCardUpdatedError(y);this.emit('change');break;case g.CREDIT_CARD_VERIFIED:this.handleCreditCardVerified(y);this.emit('change');break;case g.CREDIT_CARD_VERIFIED_ERROR:this.handleCreditCardVerifiedError(y);this.emit('change');break;case g.BIN_NUMBER_VALIDATED:this.handleBINNumberValidated(y);this.emit('change');break;case g.BIN_NUMBER_VALIDATED_ERROR:this.handleBINNumberValidatedError(y);this.emit('change');break;}};w.prototype.getAsyncRequestState=function(){return r;};w.prototype.isCreditCardsFetchComplete=function(){return p;};w.prototype.handleCreditCardsUpdated=function(x){p=true;n=x.map(function(y){return new l(y);});};w.prototype.handleCreditCardAdded=function(x){var y=false;s(x.requestID,x);n.forEach(function(z){if(z.getCredentialId()===x[h.CREDENTIAL_ID])y=true;});if(y)return;n.push(new l(x));};w.prototype.handleCreditCardAddedError=function(x){t(x.requestID,x.errors);};w.prototype.handleCreditCardDeleted=function(x){var y=x[h.CARD_FBID];s(x.requestID,x);n=n.filter(function(z){return z.getCredentialId()!==y;});};w.prototype.handleCreditCardDeletedError=function(x){t(x.requestID,x.error);};w.prototype.handleCreditCardUpdated=function(x){s(x.requestID,x);n.forEach(function(y,z){if(y.getCredentialId()===x[h.CREDENTIAL_ID]){y.setExp(x[h.CARD_EXPIRATION]);y.setZipCode(x[h.ZIP]);}});};w.prototype.handleCreditCardUpdatedError=function(x){t(x.requestID,x.errors);};w.prototype.handlePresetCreditCardUpdated=function(x){var y=x[h.CARD_FBID];s(x.requestID,x);var z=n.filter(function(ba){return ba.getIsPreset();})[0];if(z)z.setIsPreset(false);var aa=n.filter(function(ba){return ba.getCredentialId()===y;})[0];if(aa)aa.setIsPreset(true);};w.prototype.handlePresetCreditCardUpdatedError=function(x){t(x.requestID,x.error);};w.prototype.handleCreditCardVerified=function(x){s(x.requestID,x);n.forEach(function(y,z){if(y.getCredentialId()===x[h.CREDENTIAL_ID])y.setIsVerified(true);});};w.prototype.handleCreditCardVerifiedError=function(x){t(x.requestID,x.error);};w.prototype.handleBINNumberValidated=function(x){s(x.requestID,x);};w.prototype.handleBINNumberValidatedError=function(x){t(x.requestID,x.error);};w.prototype.getAll=function(){if(!q){q=true;k.getAllCreditCards();}return n;};w.prototype.getAllSettingsEligible=function(){var x=this.getAll();return x.filter(function(y){return y.getIsVerified()||y.getIsMobileVerified();});};w.prototype.getPresetCard=function(){var x=this.getAll();return x.filter(function(y){return y.getIsPreset();})[0];};e.exports=new w();},null);
__d("P2PNUXRendererUtils",["MercuryConstants","CurrentUser","ImmutableObject","MercuryAttachmentType","P2PTransferParam","P2PTransferStatus","StoryAttachmentStyle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g.MercurySupportedShareType,o={getTransferFromMessage:function(p){var q,r;if(!p||!p.attachments||!p.attachments.length)return;r=p.attachments[0];if(this.isShareAttachment(r)){q=r.share.target;}else if(r.share_data_type===n.FB_ORION)q=r.metadata;if(q)q=new i(q);return q;},isShareAttachment:function(p){return !!(typeof p!=='string'&&p.attach_type==j.SHARE&&p.share&&p.share.style_list&&p.share.style_list.indexOf(m.ORION)>=0);},doesNUXNeedCreditCards:function(p){var q=h.getID()===p.sender.id;return (!q&&p[k.STATUS]===l.PENDING_RECIPIENT_NUX);},isRecipientActionableStatus:function(p){var q=p[k.STATUS],r=h.getID()===p.sender.id;return (!r&&(q===l.PENDING_RECIPIENT_NUX||q===l.PENDING_RECIPIENT_VERIFICATION||q===l.PENDING_PUSH_FAIL));}};e.exports=o;},null);
__d("MercurySingletonMixin",["CurrentUser"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={_getInstances:function(){if(!this._instances)this._instances={};return this._instances;},get:function(){return this.getForFBID(g.getID());},getForFBID:function(i){var j=this._getInstances();if(!j[i])j[i]=new this(i);return j[i];}};e.exports=h;},null);
__d("MercuryThreadInformer",["ArbiterMixin","LogHistory","MercuryAssert","MercuryLoggingHelper","MercurySingletonMixin","copyProperties","mapObject","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=h.getInstance('mercury_informer'),p=n(g);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(u){this.$MercuryThreadInformer0=u;this.$MercuryThreadInformer1={};this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4=false;this.$MercuryThreadInformer5=false;this.$MercuryThreadInformer6=false;this.$MercuryThreadInformer7={};this.$MercuryThreadInformer8={};this.$MercuryThreadInformer9={};this.$MercuryThreadInformera=0;}s.prototype.updatedThread=function(u){this.$MercuryThreadInformer2[u]=true;this.$MercuryThreadInformerb();};s.prototype.deletedThread=function(u){this.$MercuryThreadInformer1[u]=true;this.$MercuryThreadInformerb();};s.prototype.updatedThreadlist=function(){this.$MercuryThreadInformer4=true;this.$MercuryThreadInformerb();};s.prototype.updatedUnseenState=function(){this.$MercuryThreadInformer5=true;this.$MercuryThreadInformerb();};s.prototype.updatedUnreadState=function(){this.$MercuryThreadInformer6=true;this.$MercuryThreadInformerb();};s.prototype.changedThreadReadState=function(u,v,w){if(!this.$MercuryThreadInformer3[u]||this.$MercuryThreadInformer3[u].timestamp<w)this.$MercuryThreadInformer3[u]={mark_as_read:v,timestamp:w};this.$MercuryThreadInformerb();};s.prototype.receivedMessage=function(u){i.isThreadID(u.thread_id);var v=u.thread_id;if(!this.$MercuryThreadInformer7[v])this.$MercuryThreadInformer7[v]=[];this.$MercuryThreadInformer7[v].push(u);this.updatedThread(v);};s.prototype.reorderedMessages=function(u,v){this.$MercuryThreadInformer8[u]={source:v};this.$MercuryThreadInformerb();};s.prototype.updatedMessage=function(u,v,w){if(!this.$MercuryThreadInformer9[u])this.$MercuryThreadInformer9[u]={};this.$MercuryThreadInformer9[u][v]={source:w};this.updatedThread(u);};s.prototype.synchronizeInforms=function(u){this.$MercuryThreadInformera++;try{u();}catch(v){throw v;}finally{this.$MercuryThreadInformera--;this.$MercuryThreadInformerb();}};s.prototype.listen=function(u,v){return this.subscribe('threads-updated',function(w,x){if(x[u])v(u);});};s.prototype.$MercuryThreadInformerb=function(){if(!this.$MercuryThreadInformera){var u=this.$MercuryThreadInformer1,v=this.$MercuryThreadInformer2,w=this.$MercuryThreadInformer3,x=this.$MercuryThreadInformer4,y=this.$MercuryThreadInformer5,z=this.$MercuryThreadInformer6,aa=this.$MercuryThreadInformer7,ba=this.$MercuryThreadInformer8,ca=this.$MercuryThreadInformer9;this.$MercuryThreadInformer1={};this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4=false;this.$MercuryThreadInformer5=false;this.$MercuryThreadInformer6=false;this.$MercuryThreadInformer7={};this.$MercuryThreadInformer8={};this.$MercuryThreadInformer9={};var da=Object.keys(v);if(da.length||x)this.$MercuryThreadInformerc('threadlist-updated',da);if(da.length)this.$MercuryThreadInformerc('threads-updated',v);for(var ea in w){this.$MercuryThreadInformerc('thread-read-changed',w);break;}for(ea in u){this.$MercuryThreadInformerc('threads-deleted',u);break;}if(y)this.$MercuryThreadInformerc('unseen-updated',null);if(z)this.$MercuryThreadInformerc('unread-updated',null);for(ea in aa){this.$MercuryThreadInformerc('messages-received',aa);break;}for(ea in ba){this.$MercuryThreadInformerc('messages-reordered',ba);break;}for(ea in ca){this.$MercuryThreadInformerc('messages-updated',ca);break;}}};s.prototype.$MercuryThreadInformerc=function(u,v){t(u,v);this.inform(u,v);};function t(u,v){var w=v;if(u=='messages-received')w=m(w,function(x){return x.map(function(y){return j.obfuscateMessage(y);});});o.debug(u,w);}l(s,k);e.exports=s;},null);
__d("P2PTransferStore",["Arbiter","P2PActionConstants","ChannelConstants","CreditCardFormParam","EventEmitter","ImmutableObject","P2PActions","P2PAPI","P2PChannelType","P2PCreditCard","P2PDispatcher","P2PNUXRendererUtils","P2PTransferParam","P2PTransferStatus","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=b('MercuryThreadInformer').get(),v,w,x,y,z,aa,ba,ca,da,ea=null,fa=false;function ga(la,ma){if(la)da[la]=new l(ma);}function ha(la,ma){if(la)da[la]={error:ma};}for(var ia in k)if(k.hasOwnProperty(ia))ka[ia]=k[ia];var ja=k===null?null:k.prototype;ka.prototype=Object.create(ja);ka.prototype.constructor=ka;ka.__superConstructor__=k;function ka(){k.call(this);v=false;x=[];da={};z=g.subscribe(i.getArbiterType(o.TRANSFER_STATUS_CHANGED),this.handleChannelTransferStatusChanged.bind(this));aa=u.subscribe('messages-received',this.handleMessageReceived.bind(this));ba=u.subscribe('messages-updated',this.handleMessageUpdated.bind(this));y=q.register(this.onEventDispatched.bind(this));}ka.prototype.onEventDispatched=function(la){var ma=la.data,na=la.type;switch(na){case h.TRANSFERS_UPDATED:this.handleTransfersUpdated(ma);this.emit('change');break;case h.TRANSFERS_UPDATED_ERROR:this.handleTransfersUpdatedError(ma);this.emit('change');break;case h.NUX_TRANSFERS_UPDATED:this.handleNUXTransfersUpdated(ma);this.emit('change');break;case h.TRANSFER_ADDED:this.handleTransferAdded(ma);this.emit('change');break;case h.TRANSFER_UPDATED:this.handleTransferUpdated(ma);this.emit('change');break;case h.TRANSFER_ACCEPTED:this.handleTransferAccepted();this.emit('change');break;case h.TRANSFER_DECLINED:this.handleTransferDeclined(ma);this.emit('change');break;}};ka.prototype.getAsyncRequestState=function(){return da;};ka.prototype.handleTransfersUpdated=function(la){ca=null;fa=true;x=la.map(function(ma){var na={};if(ma.creditCard){na[j.CREDENTIAL_ID]=ma.creditCard[j.CREDENTIAL_ID];na[j.CARD_NUMBER]=ma.creditCard[j.CARD_NUMBER];na[j.CARD_TYPE]=ma.creditCard[j.CARD_TYPE];ma.creditCard=new p(na);}return new l(ma);});};ka.prototype.handleTransfersUpdatedError=function(la){ca=la.error;ha(la.requestID,la.error);};ka.prototype.handleNUXTransfersUpdated=function(la){if(!fa)this.handleTransfersUpdated(la);};ka.prototype.handleTransferAdded=function(la){var ma=null;ga(la.requestID,la);ma=x.filter(function(na){return (na[s.TRANSFER_ID]===la[s.TRANSFER_ID]);})[0];if(ma)return;x.push(new l(la));x=x.sort(function(na,oa){return oa.creationTime-na.creationTime;});};ka.prototype.handleTransferAddedError=function(la){ha(la.requestID,la.errors);};ka.prototype.handleChannelTransferStatusChanged=function(la,ma){ma=ma.obj;m.transferUpdated(ma);};ka.prototype.getPendingMessageAttachment=function(){return ea;};ka.prototype.handleMessageReceived=function(la,ma){for(var na in ma)if(ma.hasOwnProperty(na)){var oa=ma[na];for(var pa=0;pa<oa.length;pa++)if(oa[pa].attachments&&oa[pa].attachments.length){ea=oa[pa];return;}}};ka.prototype.handleMessageUpdated=function(la,ma){if(!ea)return;for(var na in ma)if(ma.hasOwnProperty(na)){var oa=ma[na];for(var pa in oa)if(oa.hasOwnProperty(pa)&&ea.message_id===pa){var qa=r.getTransferFromMessage(ea);if(qa){m.transferAdded(qa);ea=null;return;}}}};ka.prototype.handleTransferUpdated=function(la){for(var ma=0,na=x.length;ma<na;ma++)if(x[ma][s.TRANSFER_ID]===la[s.TRANSFER_ID])x[ma]=l.set(x[ma],la);};ka.prototype.handleTransferAccepted=function(){var la;for(var ma=0,na=x.length;ma<na;ma++)if(x[ma][s.STATUS]===t.PENDING_RECIPIENT_NUX){la={};la[s.STATUS]=t.COMPLETED;x[ma]=l.set(x[ma],la);}};ka.prototype.handleTransferDeclined=function(la){var ma;for(var na=0,oa=x.length;na<oa;na++)if(x[na][s.TRANSFER_ID]===la[s.TRANSFER_ID]&&x[na][s.STATUS]===t.PENDING_RECIPIENT_NUX){ma={};ma[s.STATUS]=t.CANCELED_DECLINED;x[na]=l.set(x[na],ma);break;}};ka.prototype.handleTransferUpdatedError=function(la){ha(la.requestID,la.errors);};ka.prototype.getTransferByID=function(la){return x.filter(function(ma){return la===ma[s.TRANSFER_ID];})[0];};ka.prototype.getAll=function(la){if(!v){v=true;n.getTransactions(la);}return x;};ka.prototype.getNUXTransfer=function(){var la=x.filter(function(ma){return r.isRecipientActionableStatus(ma);})[0];if(!la&&!w&&!v){w=true;n.getNUXTransactions();}return la;};ka.prototype.hasTransfers=function(){return x.length>0;};ka.prototype.hasReceivedFromSender=function(la){for(var ma=0,na=x.length;ma<na;ma++)if(x[ma].sender.id===la)return true;return false;};ka.prototype.getTransferFetchError=function(){return ca;};e.exports=new ka();},null);
__d("P2PVerificationFlowHelper",["AsyncDialog","AsyncRequest","P2PAPI","P2PTransferParam","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=null,m=null,n=null,o={startVerificationFlow:function(p,q,r){l=p;m=q;n=r||k;g.send(new h('/p2p/verify/dialog/?id='+p));},setupFlowExitHandler:function(p,q,r,s){var t=function(w){n(w);l=null;m=null;n=null;p.destroy();q.destroy();};if(r){p.subscribe('hide',function(){t(s);});}else{var u=false,v=false;p.subscribe('confirm',function(){u=true;});p.subscribe('hide',function(){if(u){p.destroy();q.destroy();}else if(m){q.show();}else t(false);});q.subscribe('confirm',function(){v=true;var w={};w[j.TRANSFER_ID]=l;i.cancelTransaction({formData:w});t(false);});q.subscribe('hide',function(){if(!v)p.show();});}}};e.exports=o;},null);
__d("XP2PTransactionDetailController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transaction\/",{id:{type:"String",required:true}});},null);
__d("P2PMercuryAttachment.react",["CurrentUser","Link.react","P2PAcceptMoneyDialog.react","P2PActions","P2PBigAmount.react","P2PButton.react","P2PCreditCardStore","P2PNUXRendererUtils","P2PTransferParam","P2PTransferStatus","P2PTransferStore","P2PVerificationFlowHelper","React","ReactLayeredComponentMixin","XP2PTransactionDetailController","cx","formatDate","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();'use strict';var y=s,z=y.PropTypes,aa=s.createClass({displayName:"P2PMercuryAttachment",mixins:[t],propTypes:{metadata:z.object.isRequired,theme:z.string},getInitialState:function(){var ba={acceptMoneyDialogShown:false},ca=this.props.metadata,da=q.getTransferByID(ca[o.TRANSFER_ID]);if(da){ca=da;}else j.transferAdded(ca);ba.transfer=ca;ba.viewerIsSender=g.getID()===ba.transfer.sender.id;if(n.doesNUXNeedCreditCards(ba.transfer))ba.creditCardAsyncRequestState=m.getAsyncRequestState(),ba.creditCards=m.getAll();return ba;},componentDidMount:function(){this.creditCardStoreSub=m.addListener('change',this.onCreditCardStoreChange);this.transferStoreSub=q.addListener('change',this.onTransferStoreChange);},componentWillUnmount:function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}if(this.transferStoreSub){this.transferStoreSub.remove();this.transferStoreSub=null;}},onCreditCardStoreChange:function(){this.setState({creditCardAsyncRequestState:m.getAsyncRequestState(),creditCards:m.getAll()});},onTransferStoreChange:function(){var ba={},ca=q.getTransferByID(this.state.transfer[o.TRANSFER_ID]);if(ca&&ca[o.STATUS]!==this.state.transfer[o.STATUS]){ba.transfer=ca;if(n.doesNUXNeedCreditCards(ba.transfer))ba.creditCardAsyncRequestState=m.getAsyncRequestState(),ba.creditCards=m.getAll();this.setState(ba);}},getStatus:function(){var ba=x._("Pending"),ca=x._("Completed"),da=x._("Canceled"),ea=x._("Sent"),fa=this.state.viewerIsSender;switch(this.state.transfer[o.STATUS]){case p.PENDING_RECIPIENT_PROCESSING:case p.INTERMEDIATE_PROCESSING:return fa?ea:ca;case p.PENDING_RECIPIENT_NUX:case p.PENDING_RECIPIENT_VERIFICATION:case p.PENDING_RECIPIENT_MANUAL_REVIEW:case p.PENDING_RECIPIENT_VERIFICATION_PROCESSING:case p.PENDING_PUSH_FAIL:case p.PENDING_SENDER_INITED:return fa?ea:ba;case p.PENDING_SENDER_MANUAL_REVIEW:case p.PENDING_SENDER_VERIFICATION:case p.PENDING_SENDER_VERIFICATION_PROCESSING:return ba;case p.CANCELED_SENDER_RISK:case p.CANCELED_DECLINED:case p.CANCELED_RECIPIENT_RISK:case p.CANCELED_SYSTEM_FAIL:case p.CANCELED_EXPIRED:case p.CANCELED_SAME_CARD:return da;case p.COMPLETED:return ca;}},isGrayStatus:function(){switch(this.state.transfer[o.STATUS]){case p.PENDING_RECIPIENT_VERIFICATION:case p.PENDING_RECIPIENT_VERIFICATION_PROCESSING:case p.PENDING_RECIPIENT_MANUAL_REVIEW:case p.PENDING_RECIPIENT_NUX:case p.PENDING_PUSH_FAIL:if(this.state.viewerIsSender)return false;return true;case p.PENDING_SENDER_MANUAL_REVIEW:case p.PENDING_SENDER_VERIFICATION:case p.PENDING_SENDER_VERIFICATION_PROCESSING:case p.CANCELED_SENDER_RISK:case p.CANCELED_DECLINED:case p.CANCELED_RECIPIENT_RISK:case p.CANCELED_SYSTEM_FAIL:case p.CANCELED_EXPIRED:case p.CANCELED_SAME_CARD:return true;case p.COMPLETED:case p.INTERMEDIATE_PROCESSING:case p.PENDING_SENDER_INITED:case p.PENDING_RECIPIENT_PROCESSING:return false;}},shouldRenderBannerFooter:function(){if(n.doesNUXNeedCreditCards(this.state.transfer)&&!m.isCreditCardsFetchComplete())return false;return (n.isRecipientActionableStatus(this.state.transfer));},handleConfirmInfoButtonClicked:function(){r.startVerificationFlow(this.state.transfer[o.TRANSFER_ID],false);},handleAddCardButtonClicked:function(){this.setState({acceptMoneyDialogShown:true});},handleAcceptMoneyDialogClose:function(){this.setState({acceptMoneyDialogShown:false});},renderInlineBanner:function(){var ba=this.state.transfer[o.STATUS];if(ba===p.PENDING_RECIPIENT_NUX){return this.renderPendingRecipientNUX();}else if(ba===p.PENDING_RECIPIENT_VERIFICATION){return this.renderPendingRecipientVerification();}else if(ba===p.PENDING_PUSH_FAIL)return this.renderPendingPushFail();return null;},renderPendingRecipientNUX:function(){var ba=this.state.transfer;return (s.createElement("div",{className:"_3asb"},s.createElement("div",{className:"_3asc"},x._("{sender_name} Sent You Money!",[x.param("sender_name",ba.sender.name)])),s.createElement("div",{className:"_3asd"},x._("It's free to accept it. Just add a debit card.")),s.createElement("div",{className:"_5abs"},s.createElement(l,{use:"confirm",className:"_5abt",size:"medium",label:x._("Add Debit Card"),type:"primary",onClick:this.handleAddCardButtonClicked}))));},renderPendingRecipientVerification:function(){return (s.createElement("div",{className:"_3asb"},s.createElement("div",{className:"_3asc"},x._("Please Confirm Your Info")),s.createElement("div",{className:"_3asd"},x._("To accept the money {sender_name} sent you, please confirm your information.",[x.param("sender_name",this.state.transfer.sender.name)])),s.createElement("div",{className:"_5abs"},s.createElement(l,{use:"confirm",className:"_5abt",size:"medium",label:x._("Confirm Info"),type:"primary",onClick:this.handleConfirmInfoButtonClicked}))));},renderPendingPushFail:function(){return (s.createElement("div",{className:"_3asb"},s.createElement("div",{className:"_3asc"},x._("Update Your Card")),s.createElement("div",{className:"_3asd"},x._("It looks like your card is expired or invalid. Please update it to get {currency}{amount} from {sender_name}.",[x.param("currency",this.state.transfer.currency),x.param("amount",this.state.transfer.amount),x.param("sender_name",this.state.transfer.sender.name)])),s.createElement("div",{className:"_5abs"},s.createElement(l,{use:"confirm",size:"medium",className:"_5abt",label:x._("Update Card"),type:"primary",href:this.getTransferDetailsURI(),target:"_blank"}))));},getStatusHeaderText:function(){if(this.isMessengerDotComView()){return (x._("Status"));}else return (x._("STATUS"));},getActionHeaderText:function(){var ba=this.state.transfer[o.STATUS],ca=this.isMessengerDotComView(),da=this.state.viewerIsSender,ea=ca?x._("Sent on"):x._("SENT ON"),fa=ca?x._("Received on"):x._("RECEIVED ON"),ga=ca?x._("Canceled on"):x._("CANCELED ON");switch(ba){case p.PENDING_SENDER_MANUAL_REVIEW:case p.PENDING_RECIPIENT_MANUAL_REVIEW:case p.PENDING_RECIPIENT_PROCESSING:case p.INTERMEDIATE_PROCESSING:case p.COMPLETED:return da?ea:fa;case p.PENDING_RECIPIENT_NUX:case p.PENDING_RECIPIENT_VERIFICATION:case p.PENDING_RECIPIENT_VERIFICATION_PROCESSING:case p.PENDING_PUSH_FAIL:case p.PENDING_SENDER_INITED:return da?ea:null;case p.PENDING_SENDER_VERIFICATION:case p.PENDING_SENDER_VERIFICATION_PROCESSING:return null;case p.CANCELED_SENDER_RISK:case p.CANCELED_DECLINED:case p.CANCELED_RECIPIENT_RISK:case p.CANCELED_SYSTEM_FAIL:case p.CANCELED_EXPIRED:case p.CANCELED_SAME_CARD:return ga;}},isMessengerDotComView:function(){return this.props.theme==='messenger';},isMessagesView:function(){return this.props.theme==='messages';},getTransferStatusDate:function(){var ba,ca=this.state.transfer[o.STATUS];switch(ca){case p.PENDING_RECIPIENT_PROCESSING:case p.INTERMEDIATE_PROCESSING:case p.COMPLETED:ba=this.state.transfer.completedTime;break;case p.CANCELED_SENDER_RISK:case p.CANCELED_DECLINED:case p.CANCELED_RECIPIENT_RISK:case p.CANCELED_SYSTEM_FAIL:case p.CANCELED_EXPIRED:case p.CANCELED_SAME_CARD:ba=this.state.transfer.updatedTime;break;}if(!ba)ba=this.state.transfer.creationTime;return w(ba,'M jS, g:ia');},renderStatusFooter:function(){var ba=this.getActionHeaderText(),ca;if(ba)ca=s.createElement("div",{className:"_4ybr"},s.createElement("div",{className:"_1nkr"},s.createElement("div",{className:"_4ybp"},ba),s.createElement("div",{className:"_4ybq"},this.getTransferStatusDate())));return (s.createElement("div",{className:"_4ybn"},s.createElement("div",{className:"_4ybo"},s.createElement("div",{className:"_1nkq"},s.createElement("div",{className:"_4ybp"},this.getStatusHeaderText()),s.createElement("div",{className:"_4ybq"},this.getStatus()))),ca));},renderLayers:function(){var ba={};if(this.state.acceptMoneyDialogShown)ba.acceptDialog=s.createElement(i,{asyncRequestState:this.state.creditCardAsyncRequestState,creditCards:this.state.creditCards,onClose:this.handleAcceptMoneyDialogClose,transfer:this.state.transfer});return ba;},getTransferDetailsURI:function(){return ((u.getURIBuilder()).setString('id',this.state.transfer[o.TRANSFER_ID]).getURI());},renderBigAmount:function(){return (s.createElement(k,{amount:this.state.transfer.amount,isPending:this.isGrayStatus()}));},render:function(){var ba,ca,da="_4ybm",ea=this.getTransferDetailsURI();if(this.shouldRenderBannerFooter()){ba=s.createElement("div",{className:da},this.renderInlineBanner());}else ca=s.createElement("div",{className:da},this.renderStatusFooter());return (s.createElement("div",{className:(("_30of")+(this.state.viewerIsSender?' '+"_4ybf":'')+(this.isMessagesView()?' '+"_4ybg":'')+(this.isMessengerDotComView()?' '+"_4ybh":''))},s.createElement("div",{className:"_3ase"},s.createElement(h,{className:"_3asf",href:ea,target:"_blank"},s.createElement("div",{className:"_4ybi"},this.renderBigAmount()),ca),ba)));}});e.exports=aa;},null);
__d("P2PMercuryShareAttachment.react",["MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","P2PMercuryAttachment.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=j,m=l.PropTypes,n=j.createClass({displayName:"P2PMercuryShareAttachment",propTypes:{attachment:g,location:m.oneOf(h.getValues())},render:function(){var o={metadata:this.props.attachment.target};if(this.props.location===h.MESSENGER){o.theme='messenger';}else if(this.props.location===h.WEB_INBOX)o.theme='messages';return (j.createElement("div",{className:"_3fyk"},j.createElement(i,j.__spread({},o))));}});e.exports=n;},null);
__d("MercuryAttachmentSnippetType",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g({PHOTO:null,GIF:null,VIDEO:null,AUDIO_CLIP:null,STICKER:null,ORION:null,SHARE:null,ERROR:null,MIXED:null});e.exports=h;},null);
__d("MercuryAttachmentSnippetRenderer",["MercuryAttachment","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryConstants","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={getAttachmentSnippetType:function(m){if(this._hasOnlyPhotos(m))return h.PHOTO;if(this._hasOnlyAnimatedImages(m))return h.GIF;if(this._hasOnlyVideo(m))return h.VIDEO;if(this._hasAudioClip(m))return h.AUDIO_CLIP;if(this._hasSticker(m))return h.STICKER;if(this._hasOrion(m))return h.ORION;if(this._hasShare(m))return h.SHARE;if(this._hasError(m))return h.ERROR;return h.MIXED;},renderAttachmentSnippetText:function(m,n,o,p){switch(m){case h.PHOTO:return this._renderPhotoAttachmentSnippetText(n,o,this._getPhotoAttachments(p));case h.GIF:return this._renderAnimatedImagesAttachmentSnippetText(n,o,this._getAnimatedImageAttachments(p));case h.VIDEO:return n?k._("You sent a video."):k._("{sender name} sent a video.",[k.param("sender name",o)]);case h.AUDIO_CLIP:return n?k._("You sent a voice message."):k._("{name} sent a voice message.",[k.param("name",o)]);case h.STICKER:return n?k._("You sent a sticker."):k._("{name} sent a sticker.",[k.param("name",o)]);case h.ORION:if(p&&p[0]&&p[0].metadata)return this.renderOrionSnippetText(n,o,p[0].metadata);break;case h.SHARE:return n?k._("You shared a link."):k._("{sender name} shared a link.",[k.param("sender name",o)]);case h.ERROR:return n?k._("You sent an attachment."):k._("{sender name} sent an attachment.",[k.param("sender name",o)]);default:return '';}},_hasOnlyPhotos:function(m){return this._getPhotoAttachments(m).length===m.length;},_hasOnlyAnimatedImages:function(m){return this._getAnimatedImageAttachments(m).length===m.length;},_hasOnlyVideo:function(m){return (m.length===1&&m[0].attach_type===i.VIDEO);},_hasAudioClip:function(m){return !!(m.length===1&&m[0].metadata&&g.isVoiceMessage(m[0].metadata.type));},_hasSticker:function(m){return (m.length===1&&m[0].attach_type===i.STICKER);},_hasOrion:function(m){return this._hasSingleAttachmentOfShareDataType(m,j.MercurySupportedShareType.FB_ORION);},_hasSingleAttachmentOfShareDataType:function(m,n){return (m.length===1&&m[0].share_data_type===n);},_hasShare:function(m){return (m.length===1&&m[0].attach_type===i.SHARE);},_hasError:function(m){return (m.length===1&&m[0].attach_type===i.ERROR);},_getPhotoAttachments:function(m){if(!m)return [];return m.filter(function(n){return n.attach_type===i.PHOTO;});},_getAnimatedImageAttachments:function(m){if(!m)return [];return m.filter(function(n){return n.attach_type===i.ANIMATED_IMAGE;});},_renderPhotoAttachmentSnippetText:function(m,n,o){if(o.length===1){if(m){return (k._("You sent a photo."));}else return (k._("{name} sent a photo.",[k.param("name",n)]));}else if(m){return (k._({"*":"You sent {num_photos} photos."},[k.param("num_photos",o.length,[0])]));}else return (k._({"*":"{name} sent {num_photos} photos."},[k.param("name",n),k.param("num_photos",o.length,[0])]));},_renderAnimatedImagesAttachmentSnippetText:function(m,n,o){if(o.length===1){if(m){return (k._("You sent a GIF."));}else return (k._("{name} sent a GIF.",[k.param("name",n)]));}else if(m){return (k._("You sent {num_animated_images} GIFs.",[k.param("num_animated_images",o.length)]));}else return (k._("{name} sent {num_animated_images} GIFs.",[k.param("name",n),k.param("num_animated_images",o.length)]));},renderOrionSnippetText:function(m,n,o,p){if(m){return (k._("You sent {currency}{amount}.",[k.param("currency",o),k.param("amount",p)]));}else return (k._("{name} sent you {currency}{amount}.",[k.param("name",n),k.param("currency",o),k.param("amount",p)]));}};e.exports=l;},null);
__d("P2PMercuryAttachmentSnippet.react",["CurrentUser","Image.react","MercuryAttachmentSnippetRenderer","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"P2PMercuryAttachment",propTypes:{sender:n.object,receiver:n.object,amount:n.string,currency:n.string},getDefaultProps:function(){return {sender:{},receiver:{}};},render:function(){var p=i.renderOrionSnippetText(g.getID()===this.props.sender.id,this.props.sender.name,this.props.currency,this.props.amount);return (j.createElement("span",{className:"uiIconText _3l6h _3_io"},j.createElement(h,{height:12,src:l('/images/p2p/attachment-snippet-icon.png'),width:12}),p));}});e.exports=o;},null);
__d("P2PMercuryShareAttachmentSnippet.react",["MercuryShareAttachmentReactShape","P2PMercuryAttachmentSnippet.react","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i.createClass({displayName:"P2PMercuryShareAttachmentSnippet",propTypes:{attachment:g},render:function(){var k=this.props.attachment?this.props.attachment.target:{};return (i.createElement(h,i.__spread({},k)));}});e.exports=j;},null);
__d("MessengerDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("keyMirrorRecursive",["invariant"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(k,l){return i(k,l);}function i(k,l){var m={},n;g(j(k));for(n in k){if(!k.hasOwnProperty(n))continue;var o=k[n],p=l?l+'.'+n:n;if(j(o)){o=i(o,p);}else o=p;m[n]=o;}return m;}function j(k){return k instanceof Object&&!Array.isArray(k);}e.exports=h;},null);
__d("MNCommerceActionTypes",["keyMirrorRecursive"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g({RECEIPT:{LOADED:null,LOAD_ERROR:null},SHIPMENT:{LOADED:null,LOAD_ERROR:null},DIALOG:{SHOW:null,HIDE:null}});e.exports=h;},null);
__d("MNCommerceDialogStateActions",["MessengerDispatcher","MNCommerceActionTypes"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={showDialog:function(j,k){g.dispatch({type:h.DIALOG.SHOW,dialogContainer:j,state:k});},hideDialog:function(){g.dispatch({type:h.DIALOG.HIDE});}};e.exports=i;},null);
__d("MNCommerceLoggingConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={DIALOG_SURFACE:{SHIPMENT:'shipment',RECEIPT:'receipt',UNLINK:'unlink',UNLINK_ERROR:'unlink_error'}};e.exports=g;},null);
__d("FluxStore",["EventEmitter","invariant"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i='change';function j(k){var l=this.constructor;this.__className=l.name;this.__changed=false;this.__dispatcher=k;this.__changeEvent=this.$FluxStore0();this.__emitter=new g();this.$FluxStore1=k.register(function(m){this.__validateAction(m);this.__invokeOnDispatch(m);}.bind(this));}j.prototype.addListener=function(k){return this.__emitter.addListener(this.__changeEvent,k);};j.prototype.getDispatcher=function(){return this.__dispatcher;};j.prototype.getDispatchToken=function(){return this.$FluxStore1;};j.prototype.hasChanged=function(){h(this.__dispatcher.isDispatching());return this.__changed;};j.prototype.__emitChange=function(){h(this.__dispatcher.isDispatching());this.__changed=true;};j.prototype.__validateAction=function(k){if(k.action){h(k.action.type||k.action.actionType);}else h(k.type);};j.prototype.__invokeOnDispatch=function(k){this.__changed=false;this.__onDispatch(k);if(this.__changed)this.__emitter.emit(this.__changeEvent);};j.prototype.__onDispatch=function(k){h(false);};j.prototype.$FluxStore0=function(){return i;};e.exports=j;},null);
__d("MNCommerceDialogStateStore",["FluxStore","MessengerDispatcher","MNCommerceActionTypes"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';for(var j in g)if(g.hasOwnProperty(j))l[j]=g[j];var k=g===null?null:g.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=g;function l(){g.call(this,h);this.$MNCommerceDialogStateStore0=null;this.$MNCommerceDialogStateStore1=null;}l.prototype.__onDispatch=function(m){var n=m.type;switch(n){case i.DIALOG.SHOW:this.$MNCommerceDialogStateStore0=m.dialogContainer;this.$MNCommerceDialogStateStore1=m.state;this.__emitChange();break;case i.DIALOG.HIDE:this.$MNCommerceDialogStateStore0=null;this.$MNCommerceDialogStateStore1=null;this.__emitChange();break;}};l.prototype.getDialogContainer=function(){return this.$MNCommerceDialogStateStore0;};l.prototype.getState=function(){return this.$MNCommerceDialogStateStore1;};e.exports=new l();},null);
__d("MNCommerceAddress.react",["React"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g,i=h.PropTypes,j=g.createClass({displayName:"MNCommerceAddress",propTypes:{name:i.string,rawAddress:i.string,address:i.shape({street_1:i.string,street_2:i.string,city:i.string,state:i.string,postal_code:i.string})},render:function(){if(this.props.rawAddress)return this._renderFallbackAddress();return this._renderProperAddress();},_renderProperAddress:function(){if(!this.props.address)return null;return (g.createElement("div",null,this._renderName(),g.createElement("div",null,this.props.address.street_1),g.createElement("div",null,this.props.address.street_2),g.createElement("div",null,this._getCityStateZip())));},_getCityStateZip:function(){var k=null;if(this.props.address.city)k=this.props.address.city;if(this.props.address.state){k+=k?', ':'';k+=this.props.address.state;}if(this.props.address.postal_code){k+=k?' ':'';k+=this.props.address.postal_code;}return k;},_renderFallbackAddress:function(){return (g.createElement("div",null,this._renderName(),g.createElement("div",null,this.props.rawAddress)));},_renderName:function(){if(this.props.name)return (g.createElement("div",null,this.props.name));}});e.exports=j;},null);
__d("MNCommerceAttachmentConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={XLARGE_IMAGE_DIMENSION:72,LARGE_IMAGE_DIMENSION:60,SMALL_IMAGE_DIMENSION:32,SINGLE_IMAGE_HEIGHT:108,BUBBLE_PADDING:6,UNLINK_ERROR_DIALOG:{WIDTH:300},DIALOG:{WIDTH:445,PADDING:12},MDOTCOMDIALOG:{WIDTH:495},ORDER_DETAIL:{SUB_TOTAL:'subTotal',SHIPPING:'shippingCost',TAX:'tax',TOTAL:'totalCost'}};e.exports=g;},null);
__d("MNCommerceDetailSection.react",["React","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g,j=i.PropTypes,k=g.createClass({displayName:"MNCommerceDetailSection",propTypes:{headerLabel:j.string.isRequired,margin:j.number},getDefaultProps:function(){return {margin:0};},render:function(){return (g.createElement("div",{className:this.props.className},g.createElement("div",{className:"_5171",style:{marginBottom:this.props.margin}},this.props.headerLabel),this.props.children));}});e.exports=k;},null);
__d("MNCommerceItemText.react",["MNCommerceOrderStatus","React","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MNCommerceItemText",propTypes:{metalines:m.shape({metaline_1:m.string,metaline_2:m.string,metaline_3:m.string}),title:m.string,size:m.oneOf(['large','small']),status:m.string},getDefaultProps:function(){return {size:'small'};},render:function(){var o=this.props,p=o.className,q=(function(s,t){var u={},v=Object.prototype.hasOwnProperty;if(s==null)throw new TypeError();for(var w in s)if(v.call(s,w)&&!v.call(t,w))u[w]=s[w];return u;})(o,{className:1}),r=(("_swr")+(q.size==='small'?' '+"_sws":''));return (h.createElement("div",h.__spread({className:k(p,r)},q),h.createElement("div",{className:"_51fw"},this.props.title),h.createElement("div",{className:"_2y0f"},this._renderMetaData())));},_renderMetaData:function(){if(this.props.metalines)return (h.createElement("div",null,this._renderMetaDataSection(this.props.metalines.metaline_1),this._renderMetaDataSection(this.props.metalines.metaline_2),this._renderPriceMetaDataSection()));},_renderMetaDataSection:function(o){if(o)return (h.createElement("div",null,o));},_renderPriceMetaDataSection:function(){if(this.props.size!=='large')return null;if(this.props.status===g.CANCELED)return (h.createElement("div",null,h.createElement("span",{className:"__hz"},j._("Canceled"),' \u00b7 '),this.props.metalines.metaline_3));return (h.createElement("div",null,this.props.metalines.metaline_3));}});e.exports=n;},null);
__d("MNCommerceSingleListItem.react",["Image.react","MNCommerceItemText.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"MNCommerceSingleListItem",propTypes:{description:m.string,thumbURL:m.string,imageDimension:m.number.isRequired,status:m.string},render:function(){return (i.createElement("div",{className:k(this.props.className,"_39q_"),style:{height:this.props.imageDimension,width:this.props.width}},i.createElement("div",{className:"_1fld"},this._renderImage()),i.createElement(h,i.__spread({className:"_1flf",style:{left:this.props.imageDimension},size:this.props.size,status:this.props.status},this.props))));},_renderImage:function(){var o=this.props.imageDimension;if(this.props.thumbURL){return (i.createElement(g,{className:"_1fle",height:o,src:this.props.thumbURL,width:o}));}else return (i.createElement("div",{className:"_1prr",style:{height:o,width:o}}));}});e.exports=n;},null);
__d("MNCommerceItemList.react",["List.react","MNCommerceSingleListItem.react","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=10,o=i.createClass({displayName:"MNCommerceItemList",propTypes:{items:m.array,imageDimension:m.number.isRequired,size:m.oneOf(['large','small']),width:m.number},render:function(){var p=this._getItems(),q=this.props.items.length;if(q>n)p.push(i.createElement("li",{key:"andMore",className:"_24ry",style:{width:this.props.width}},k._("And {Number of items not visible} more",[k.param("Number of items not visible",q-n)])));return (i.createElement("div",null,i.createElement(g,{border:"none",spacing:"none"},p)));},_getItems:function(){var p=this.props,q=p.imageDimension,r=p.items,s=r.map(function(t){return i.createElement("li",{key:t.id,className:(("_24rx")+(this.props.size==='large'?' '+"_1n5y":'')),style:{width:this.props.width}},i.createElement(h,i.__spread({imageDimension:q,size:this.props.size,width:this.props.width},t)));}.bind(this)).slice(0,n);return s;}});e.exports=o;},null);
__d("MNCommerceLogoHeader.react",["Image.react","React","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=h,k=j.PropTypes,l=h.createClass({displayName:"MNCommerceLogoHeader",propTypes:{logo:k.object,label:k.string},render:function(){var m=this._renderLogo();if(this.props.label){return (h.createElement("div",{className:"_56rt"},h.createElement("div",{className:"_56ru"},h.createElement("div",{className:"_56rv"},this.props.label)),h.createElement("div",{className:"_56ru"},m)));}else return m;},_renderLogo:function(){var m=this.props.logo;if(!m||!m.src)return null;return (h.createElement(g,{className:"_56rs",height:m.height,src:m.src,width:m.width}));}});e.exports=l;},null);
__d("MNCommerceDialog.react",["CurrentEnvironment","LayerFadeOnHide","LayerHideOnEscape","MNCommerceAttachmentConstants","MessengerDialog.react","React","XUIDialog.react","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=l,r=q.PropTypes,s=l.createClass({displayName:"MNCommerceDialog",propTypes:{onToggle:r.func,shown:r.bool,width:r.number.isRequired},getDefaultProps:function(){return {onToggle:o,repositionOnUpdate:true,shown:true,width:g.messengerdotcom?j.MDOTCOMDIALOG.WIDTH:j.DIALOG.WIDTH};},componentDidUpdate:function(){if(this.props.repositionOnUpdate)setTimeout(function(){if(this.isMounted()&&this.refs.dialog&&this.refs.dialog.layer)this.refs.dialog.layer.updatePosition();}.bind(this));},render:function(){var t=g.messengerdotcom,u=t?k:m;return (l.createElement(u,l.__spread({behaviors:{LayerFadeOnHide:h,LayerHideOnEscape:i}},this.props,{className:p(this.props.className,((t?"_3rx0":''))),ref:"dialog"}),this.props.children));}});e.exports=s;},null);
__d("MNCommerceDialogBody.react",["CurrentEnvironment","MessengerDialogBody.react","React","XUIDialogBody.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"MNCommerceDialogBody",render:function(){var l=g.messengerdotcom,m=l?h:j;return (i.createElement(m,i.__spread({},this.props),this.props.children));}});e.exports=k;},null);
__d("MNCommerceDialogTitle.react",["CurrentEnvironment","MessengerDialogHeader.react","React","XUIDialogTitle.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"MNCommerceDialogTitle",render:function(){var l=g.messengerdotcom,m=l?h:j;return (i.createElement(m,i.__spread({},this.props),this.props.children));}});e.exports=k;},null);
__d("mergeDeepInto",["invariant","mergeHelpers"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=h.ArrayStrategies,j=h.checkArrayStrategy,k=h.checkMergeArrayArgs,l=h.checkMergeLevel,m=h.checkMergeObjectArgs,n=h.isTerminal,o=h.normalizeMergeArg,p=function(t,u,v,w){m(t,u);l(w);var x=u?Object.keys(u):[];for(var y=0;y<x.length;y++){var z=x[y];r(t,u,z,v,w);}},q=function(t,u,v,w){k(t,u);l(w);var x=Math.max(t.length,u.length);for(var y=0;y<x;y++)r(t,u,y,v,w);},r=function(t,u,v,w,x){var y=u[v],z=u.hasOwnProperty(v),aa=z&&n(y),ba=z&&Array.isArray(y),ca=z&&!ba&&!ba,da=t[v],ea=t.hasOwnProperty(v),fa=ea&&n(da),ga=ea&&Array.isArray(da),ha=ea&&!ga&&!ga;if(fa){if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else if(!z)t[v]=da;}else if(ga){if(aa){t[v]=y;}else if(ba){g(i[w]);if(w===i.Clobber)da.length=0;q(da,y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else !z;}else if(ha){if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){p(da,y,w,x+1);}else !z;}else if(!ea)if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else !z;},s=function(t,u,v){var w=o(u);j(v);p(t,w,v,0);};e.exports=s;},null);
__d("mergeDeep",["mergeHelpers","mergeDeepInto"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g.checkArrayStrategy,j=g.checkMergeObjectArgs,k=g.normalizeMergeArg,l=function(m,n,o){var p=k(m),q=k(n);j(p,q);i(o);var r={};h(r,p,o);h(r,q,o);return r;};e.exports=l;},null);
__d("MNCommerceOrderDetailsDialog.react",["MNCommerceAddress.react","MNCommerceAttachmentConstants","MNCommerceDetailSection.react","MNCommerceItemList.react","MNCommerceLogoHeader.react","React","MNCommerceDialog.react","MNCommerceDialogBody.react","MNCommerceDialogTitle.react","XUISpinner.react","cx","fbt","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();'use strict';var t=l,u=t.PropTypes,v=[h.ORDER_DETAIL.SUB_TOTAL,h.ORDER_DETAIL.SHIPPING,h.ORDER_DETAIL.TAX,h.ORDER_DETAIL.TOTAL],w={};w[h.ORDER_DETAIL.SUB_TOTAL]=r._("Subtotal");w[h.ORDER_DETAIL.SHIPPING]=r._("Shipping");w[h.ORDER_DETAIL.TAX]=r._("Tax");w[h.ORDER_DETAIL.TOTAL]=r._("Total");var x=l.createClass({displayName:"MNCommerceOrderDetailsDialog",propTypes:{receipt:u.object,shown:u.bool.isRequired,error:u.object,loading:u.bool.isRequired},getDefaultProps:function(){return {shown:false};},getInitialState:function(){return this._calculateState(this.props);},componentWillReceiveProps:function(y){this.setState(this._calculateState(y));},_calculateState:function(y){if(!y.receipt)return {};var z=y.receipt,aa=Array.isArray(z.structured_address)?null:z.structured_address;return {address:aa,items:this._processItems(z.items),logo:z.partner_logo?{height:z.partner_logo.height,width:z.partner_logo.width,src:z.partner_logo.url}:null,name:z.recipient_name,orderDate:z.order_time,orderNumber:z.order_id,orderStatus:z.status,payment:z.payment_method,rawAddress:z.address,shippingCost:z.shipping_cost,subTotal:z.subtotal,tax:z.total_tax,totalCost:z.total_cost};},render:function(){var y=null;if(this.props.loading){y=this._renderLoadingDetailsSection();}else if(this.props.error){y=this._renderErrorDetailsSection();}else y=this._renderFullDetailsSection();return (l.createElement(m,{className:"_1eio",onToggle:this.props.onToggle,shown:this.props.shown},l.createElement(o,null,r._("Order Details")),l.createElement(n,{useCustomPadding:true},l.createElement("div",{className:"_4vx2"},y))));},_renderErrorDetailsSection:function(){return (l.createElement("div",{className:"_289q"},l.createElement("p",{className:"_289r"},"Sorry, Something Went Wrong"),l.createElement("p",{className:"_289s"},"Your order details couldn't be shown.")));},_renderLoadingDetailsSection:function(){return (l.createElement("div",{className:"_p43"},l.createElement(p,{background:"light",size:"large",paused:false})));},_renderFullDetailsSection:function(){return (l.createElement("div",null,this._renderLogo(),this._renderItems(),l.createElement("div",{className:"_2hsz"}),l.createElement("div",null,l.createElement(i,{className:"_4vx4 _4vx5",headerLabel:r._("Ordered on")},this.state.orderDate),l.createElement(i,{className:"_4vx4",headerLabel:r._("Ship to")},l.createElement(g,{name:this.state.name,address:this.state.address,rawAddress:this.state.rawAddress})),l.createElement(i,{className:"_4vx4",headerLabel:r._("Paid with")},this.state.payment),l.createElement(i,{className:"_4vx4",headerLabel:r._("Summary")},this._renderOrderSummary())),l.createElement("div",{className:"_4vx6"},r._("Order number: {order number}",[r.param("order number",this.state.orderNumber)]))));},_processItems:function(y){if(!y)return null;var z=Object.keys(y).map(function(aa){var ba=y[aa],ca=s({},ba);ca.id=aa;ca.thumbURL=ba.thumb_url;return ca;});return z;},_renderLogo:function(){if(!this.state.logo)return null;return (l.createElement("div",{className:"_4vx3"},l.createElement(k,{logo:this.state.logo})));},_renderItems:function(){var y=h.DIALOG.WIDTH-2*h.DIALOG.PADDING;return (l.createElement("div",{className:"_39yr"},l.createElement(j,{imageDimension:h.XLARGE_IMAGE_DIMENSION,items:this.state.items,size:"large",width:y})));},_renderOrderSummary:function(){var y=v.map(function(z){var aa=this.state[z];return (l.createElement("div",{className:((z==='totalCost'?"_4vx9":'')),key:z},l.createElement("div",{className:"_4vx5"},w[z]),l.createElement("div",{className:"_4vx5"},aa||'--')));}.bind(this));return y;}});e.exports=x;},null);
__d("LoadObjectOperations",["keyMirrorRecursive"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g({CREATING:'',DELETING:'',LOADING:'',UPDATING:''});e.exports=h;},null);
__d("LoadObject",["immutable","LoadObjectOperations","Map","invariant","nullthrows"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=[(void 0),null,false,true,0,''],m='SECRET_'+Math.random(),n=new i(new i(l.map(function(s){return [s,new i([[true,new i()],[false,new i()]])];}))),o=g.Record({operation:(void 0),value:(void 0),error:(void 0),internalHasValue:false});for(var p in o)if(o.hasOwnProperty(p))r[p]=o[p];var q=o===null?null:o.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=o;function r(s,t,u,v,w){j(s===m);o.call(this,{operation:t,value:u,error:v,internalHasValue:w});}r.$LoadObject0=function(s,t,u,v){var w=r.$LoadObject1(s,t,u,v);return (w||new r(m,s,t,u,v));};r.$LoadObject1=function(s,t,u,v){if(u!==(void 0)||!n.has(t))return null;var w=k(n.get(t)),x=k(w.get(v));if(!x.has(s)){var y=new r(m,s,t,u,v);x.set(s,y);}return k(x.get(s));};r.prototype.getOperation=function(){return this.get('operation');};r.prototype.getValue=function(){return this.get('value');};r.prototype.getValueEnforcing=function(){j(this.hasValue());var s=this.getValue();return (s);};r.prototype.getError=function(){return this.get('error');};r.prototype.hasValue=function(){return !!this.get('internalHasValue');};r.prototype.hasOperation=function(){return this.getOperation()!==(void 0);};r.prototype.hasError=function(){return this.getError()!==(void 0);};r.prototype.isEmpty=function(){return !this.hasValue()&&!this.hasOperation()&&!this.hasError();};r.prototype.setOperation=function(s){var t=r.$LoadObject1(s,this.getValue(),this.getError(),this.hasValue());return t||this.set('operation',s);};r.prototype.setValue=function(s){var t=r.$LoadObject1(this.getOperation(),s,this.getError(),true);return t||this.set('value',s).set('internalHasValue',true);};r.prototype.setError=function(s){var t=r.$LoadObject1(this.getOperation(),this.getValue(),s,this.hasValue());return t||this.set('error',s);};r.prototype.removeOperation=function(){var s=this.remove('operation'),t=r.$LoadObject1(s.getOperation(),s.getValue(),s.getError(),s.hasValue());return t||s;};r.prototype.removeValue=function(){var s=this.remove('value').remove('internalHasValue'),t=r.$LoadObject1(s.getOperation(),s.getValue(),s.getError(),s.hasValue());return t||s;};r.prototype.removeError=function(){var s=this.remove('error'),t=r.$LoadObject1(s.getOperation(),s.getValue(),s.getError(),s.hasValue());return t||s;};r.prototype.isCreating=function(){return this.getOperation()===h.CREATING;};r.prototype.isDeleting=function(){return this.getOperation()===h.DELETING;};r.prototype.isDone=function(){return !this.hasOperation();};r.prototype.isLoading=function(){return this.getOperation()===h.LOADING;};r.prototype.isUpdating=function(){return this.getOperation()===h.UPDATING;};r.prototype.creating=function(){return this.setOperation(h.CREATING);};r.prototype.deleting=function(){return this.setOperation(h.DELETING);};r.prototype.done=function(){return this.removeOperation();};r.prototype.loading=function(){return this.setOperation(h.LOADING);};r.prototype.updating=function(){return this.setOperation(h.UPDATING);};r.prototype.map=function(s){if(!this.hasValue())return (this);var t=this.getValueEnforcing(),u=s(t),v=this.setValue(u);return (v);};r.creating=function(){return r.$LoadObject0(h.CREATING,(void 0),(void 0),false);};r.deleting=function(){return r.$LoadObject0(h.DELETING,(void 0),(void 0),false);};r.empty=function(){return r.$LoadObject0((void 0),(void 0),(void 0),false);};r.loading=function(){return r.$LoadObject0(h.LOADING,(void 0),(void 0),false);};r.updating=function(){return r.$LoadObject0(h.UPDATING,(void 0),(void 0),false);};e.exports=r;},null);
__d("MNCommerceCacheTimeoutLimits",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={SUCCESS_TIMEOUT:10,ERROR_TIMEOUT:1};e.exports=g;},null);
__d("MNCommerceReceiptActions",["MessengerDispatcher","MNCommerceActionTypes"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={receiptLoaded:function(j){g.dispatch({type:h.RECEIPT.LOADED,receipt:j});},receiptLoadError:function(j){g.dispatch({type:h.RECEIPT.LOAD_ERROR,receiptID:j});}};e.exports=i;},null);
__d("XMNCommerceOrderDetailsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/messages\/commerce\/order_details\/",{receipt_id:{type:"String",required:true}});},null);
__d("MNCommerceReceiptDataManager",["AsyncRequest","MNCommerceReceiptActions","XMNCommerceOrderDetailsController"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';function j(){}j.prototype.fetchReceipt=function(k){var l=i.getURIBuilder().setString('receipt_id',k).getURI();new g().setURI(l).setHandler(this.$MNCommerceReceiptDataManager0).setErrorHandler(this.$MNCommerceReceiptDataManager1).send();};j.prototype.$MNCommerceReceiptDataManager0=function(k){h.receiptLoaded(k.payload);};j.prototype.$MNCommerceReceiptDataManager1=function(k){var l=k.getRequest().uri.getQueryData(),m=l.receipt_id;h.receiptLoadError(m);};e.exports=new j();},null);
__d("MNCommerceReceiptStore",["Cache","FluxStore","LoadObject","MessengerDispatcher","MNCommerceActionTypes","MNCommerceCacheTimeoutLimits","MNCommerceReceiptDataManager"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';for(var n in h)if(h.hasOwnProperty(n))p[n]=h[n];var o=h===null?null:h.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=h;function p(){h.call(this,j);this.$MNCommerceReceiptStore0=new g();}p.prototype.__onDispatch=function(q){var r=q.type;switch(r){case k.RECEIPT.LOADED:var s=q.receipt;this.$MNCommerceReceiptStore0.set(s.receipt_id,i.empty().setValue(s),null,l.SUCCESS_TIMEOUT);this.__emitChange();break;case k.RECEIPT.LOAD_ERROR:var t=q.receiptID;this.$MNCommerceReceiptStore0.set(t,i.empty().setError(new Error('Unable to load receipt: '+t)),null,l.ERROR_TIMEOUT);this.__emitChange();break;}};p.prototype.getReceipt=function(q){if(q&&!this.$MNCommerceReceiptStore0.has(q)){this.$MNCommerceReceiptStore0.set(q,i.loading().setValue({receiptID:q}));m.fetchReceipt(q);}return this.$MNCommerceReceiptStore0.get(q)||i.empty();};e.exports=new p();},null);
__d("StoreBasedStateMixinHelper",["SubscriptionsHandler","invariant"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(j){this.$StoreBasedStateMixinHelper0=j;this.$StoreBasedStateMixinHelper1=new g();}i.prototype.subscribeCallback=function(j){var k=this.$StoreBasedStateMixinHelper0.map(function(l){if(l.hasChanged&&l.getDispatchToken&&l.addListener){return l.addListener(j);}else if(l.subscribe){return l.subscribe('change',j);}else if(l.addListener){return l.addListener('change',j);}else h(false);});this.$StoreBasedStateMixinHelper1.addSubscriptions.apply(this.$StoreBasedStateMixinHelper1,k);};i.prototype.release=function(){this.$StoreBasedStateMixinHelper1.release();};e.exports=i;},null);
__d("PureStoreBasedStateMixin",["StoreBasedStateMixinHelper","invariant","setImmediate"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=function(){for(var k=[],l=0,m=arguments.length;l<m;l++)k.push(arguments[l]);return {getInitialState:function(){return this.constructor.calculateState();},componentWillMount:function(){h(this.constructor.calculateState);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState());this._recalculateStateID=null;}.bind(this);this._mixin=new g(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=i(n);}.bind(this));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}.bind(this);e.exports=j;},null);
__d("MNCommerceOrderDetailsDialogContainer.react",["BanzaiLogger","MNCommerceDialogStateActions","MNCommerceDialogStateStore","MNCommerceLoggingConstants","MNCommerceLoggerEvents","MNCommerceOrderDetailsDialog.react","MNCommerceReceiptStore","PureStoreBasedStateMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=o.createClass({displayName:"MNCommerceOrderDetailsDialogContainer",mixins:[n(m)],statics:{calculateState:function(){var q=i.getState(),r=null;if(q)r=q.receiptID;var s=m.getReceipt(r);if(!s.isLoading())g.log('MessengerCommerceLoggerConfig',{event:(s.hasError()?k.DIALOG_LOAD_ERROR:k.DIALOG_LOAD_SUCCESS),debug_data:JSON.stringify({dialog_surface:j.DIALOG_SURFACE.RECEIPT,receipt_id:r})});return {shown:!!q,loading:s.isLoading(),receipt:s.getValue(),error:s.getError()};}},render:function(){return (o.createElement(l,{loading:this.state.loading,error:this.state.error,onToggle:this._onToggle,shown:this.state.shown,receipt:this.state.receipt}));},_onToggle:function(q){if(!q){g.log('MessengerCommerceLoggerConfig',{event:k.DIALOG_CLOSED,debug_data:JSON.stringify({dialog_surface:j.DIALOG_SURFACE.RECEIPT,receipt_id:this.state.receipt.receipt_id})});h.hideDialog();}}});e.exports=p;},null);
__d("MNCommerceFooterTypes",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g({TOTAL:null,REFUND:null});e.exports=h;},null);
__d("MNCommerceTotalCostFooter.react",["LeftRight.react","MNCommerceFooterTypes","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"MNCommerceTotalCostFooter",propTypes:{type:m.oneOf(Object.keys(h)),totalCost:m.string},render:function(){var o,p;switch(this.props.type){case h.TOTAL:o=(k._("Total"));p="_28k2";break;case h.REFUND:o=(k._("Refund"));p="_28k3";break;default:o='';p='';break;}return (i.createElement(g,{className:p},i.createElement("div",null,o),i.createElement("div",{className:"_28k4"},this.props.totalCost)));}});e.exports=n;},null);
__d("MNCommerceReceiptMercuryAttachment.react",["MNCommerceFooterTypes","MNCommerceItemList.react","MNCommerceAttachmentConstants","MNCommerceLogoHeader.react","MNCommerceItemText.react","MNCommerceTotalCostFooter.react","MercuryShareAttachmentRenderLocations","MercuryShareImage.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=o,s=r.PropTypes,t=o.createClass({displayName:"MNCommerceReceiptMercuryAttachment",propTypes:{items:s.array.isRequired,location:s.oneOf(m.getValues()),logo:s.object,totalCost:s.string,width:s.number,onAttachmentClick:s.func,status:s.string},render:function(){var u=this.props.items.length>1?"_abt":"_abu",v=this.props.logo,w=v?o.createElement("div",{className:u},o.createElement(j,{logo:v})):null;return (o.createElement("div",{className:q((("_1xjh")+(this.props.location===m.WEB_INBOX?' '+"_1hf9":'')),this.props.className),onClick:this.props.onAttachmentClick},this._renderSingleImage(),o.createElement("div",{className:"_4qgg"},w,o.createElement("div",{className:"_xmt"},this._renderItemDescriptions()),o.createElement("div",{className:"_xmx"},o.createElement(l,{totalCost:this.props.totalCost,type:g.TOTAL})))));},_renderSingleImage:function(){if(!this.props.items.length||this.props.items.length>1)return null;var u=this.props.items[0];if(this.props.location===m.CHAT)return (o.createElement(n,{height:i.SINGLE_IMAGE_HEIGHT,source:u.thumbURL,width:this.props.width}));return (o.createElement("div",{className:"_xm1",style:{backgroundImage:'url('+u.thumbURL+')'}}));},_renderItemDescriptions:function(){if(!this.props.items.length)return null;var u=this.props.width-2*i.BUBBLE_PADDING,v={size:'small',width:u};if(this.props.items.length===1){var w=this.props.items[0];return (o.createElement(k,o.__spread({description:w.description,title:w.title,status:w.status,metalines:w.metalines},v)));}return (o.createElement(h,o.__spread({items:this.props.items,imageDimension:i.LARGE_IMAGE_DIMENSION},v)));}});e.exports=t;},null);
__d("MNCommerceReceiptMercuryShareAttachment.react",["BanzaiLogger","MercuryShareAttachmentReactShape","MNCommerceDialogStateActions","MNCommerceLoggingConstants","MNCommerceLoggerEvents","MNCommerceOrderDetailsDialogContainer.react","MNCommerceReceiptMercuryAttachment.react","React","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=n,q=p.PropTypes,r=n.createClass({displayName:"MNCommerceReceiptMercuryShareAttachment",propTypes:{attachment:h,maxWidth:q.number},render:function(){var s=this.props.attachment,t=[],u=s.target.items;Object.keys(u).forEach(function(w){var x=u[w],y=o({},x);y.id=w;y.thumbURL=x.thumb_url;t.push(y);});var v={items:t,totalCost:s.target.total_cost,width:this.props.maxWidth,onAttachmentClick:this._onAttachmentClick,location:this.props.location,logo:s.target.partner_logo?{height:s.target.partner_logo.height,width:s.target.partner_logo.width,src:s.target.partner_logo.url}:null,status:s.target.status};return (n.createElement(m,n.__spread({},v)));},_onAttachmentClick:function(){g.log('MessengerCommerceLoggerConfig',{event:k.DIALOG_OPENED,debug_data:JSON.stringify({dialog_surface:j.DIALOG_SURFACE.RECEIPT,receipt_id:this.props.attachment.target.receipt_id})});i.showDialog(l,{receiptID:this.props.attachment.target.receipt_id});}});e.exports=r;},null);
__d("MNCommerceHeaderLabels",["fbt"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={CANCELED:{plural:(g._("Canceled Items")),single:(g._("Canceled Item"))},RETURNED:{plural:(g._("Returned Items")),single:(g._("Returned Item"))}};e.exports=h;},null);
__d("MNCommerceCancelReturnMercuryAttachment.react",["MNCommerceHeaderLabels","MNCommerceItemList.react","MNCommerceAttachmentConstants","MNCommerceLogoHeader.react","MercuryShareAttachmentRenderLocations","React","StoryAttachmentStyle","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=l,q=p.PropTypes,r='retail_return',s=l.createClass({displayName:"MNCommerceCancelReturnMercuryAttachment",propTypes:{items:q.array.isRequired,logo:q.object,type:q.string,width:q.number,onAttachmentClick:q.func,status:q.string},render:function(){var t=this._getHeaderLabelText();return (l.createElement("div",{onClick:this.props.onAttachmentClick,className:o((("_l4o")+(this.props.location===k.WEB_INBOX?' '+"_1hf9":'')),this.props.className)},l.createElement("div",{className:"_l4p"},l.createElement(j,{label:t,logo:this.props.logo})),l.createElement("div",{className:"_l4q"},this._renderItemDescriptions())));},_getHeaderLabelText:function(){var t;switch(this.props.type){case m.RETAIL_CANCELLATION:t=g.CANCELED;break;case r:t=g.RETURNED;break;}var u;if(t)if(this.props.items.length===1){u=t.single;}else u=t.plural;return u;},_renderItemDescriptions:function(){if(!this.props.items.length)return null;var t=this.props.width-2*i.BUBBLE_PADDING;return (l.createElement(h,{items:this.props.items,imageDimension:i.LARGE_IMAGE_DIMENSION,size:"small",status:this.props.status,width:t}));}});e.exports=s;},null);
__d("MNCommerceCancelReturnMercuryShareAttachment.react",["MercuryShareAttachmentReactShape","MNCommerceCancelReturnMercuryAttachment.react","MNCommerceDialogStateActions","MNCommerceOrderDetailsDialogContainer.react","StoryAttachmentStyle","React"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=l,n=m.PropTypes,o=l.createClass({displayName:"MNCommerceCancelReturnMercuryShareAttachment",propTypes:{attachment:g,maxWidth:n.number},render:function(){var p=this.props.attachment,q=[],r=p.target.items;Object.keys(r).forEach(function(t){var u=r[t],v=Object.assign({},u);v.id=t;v.thumbURL=u.thumb_url;q.push(v);});var s={items:q,location:this.props.location,onAttachmentClick:this._onAttachmentClick,type:k.RETAIL_CANCELLATION,width:this.props.maxWidth,status:p.target.status};return (l.createElement(h,l.__spread({},s)));},_onAttachmentClick:function(){i.showDialog(j,{receiptID:this.props.attachment.target.receipt_id});}});e.exports=o;},null);
__d("nearlyEqualNumbers",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h,i){if(h===i)return true;var j=Math.abs(h-i);if(j<Number.EPSILON)return true;var k=Math.abs(h),l=Math.abs(i);return j/(k+l)<Number.EPSILON;}e.exports=g;},null);
__d("GeoCoordinates",["ImmutableObject","nearlyEqualNumbers"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';for(var i in g)if(g.hasOwnProperty(i))k[i]=g[i];var j=g===null?null:g.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=g;function k(l,m){g.call(this,{latitude:l,longitude:m});}k.prototype.nearlyEquals=function(l){return (h(this.latitude,l.latitude)&&h(this.longitude,l.longitude));};e.exports=k;},null);
__d("cssVar",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){throw new Error('cssVar'+'("'+h+'"): Unexpected class transformation.');}e.exports=g;},null);
__d("LeafletView",["GeoCoordinates","ImmutableObject","invariant","nearlyEqualNumbers"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';for(var k in h)if(h.hasOwnProperty(k))m[k]=h[k];var l=h===null?null:h.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=h;function m(n){i(n);i(n.center instanceof g);i(typeof n.zoom==='number');h.call(this,n);}m.prototype.nearlyEquals=function(n){return (this.center.nearlyEquals(n.center)&&j(this.zoom,n.zoom));};m.prototype.setZoom=function(n){return new m({center:this.center,zoom:n});};m.DEFAULT=new m({center:new g(0,0),zoom:0});e.exports=m;},null);
__d("LeafletUtils",["GeoCoordinates","leaflet","LeafletView","TilesMapConfig","invariant","mod"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j.OSM_RECTS_RAW.map(function(v){return h.latLngBounds([v[2],v[1]],[v[0],v[3]]);}),n=h.CRS.EPSG3857,o=360,p=o/2,q=h.LatLng.DEG_TO_RAD,r=h.LatLng.RAD_TO_DEG,s=h.Projection.Mercator.R_MAJOR;function t(v){var w=v.zoomRange;k(Array.isArray(w)&&w.length===2);return w;}var u={fromLatLng:function(v){return new g(v.lat,v.lng);},normalizedBounds:function(v,w){var x=u.wrapLongitude(v.lng);w=h.latLng(w.lat,w.lng+x-v.lng);v=h.latLng(v.lat,x);return h.latLngBounds(v,w);},fitBounds:function(v,w,x){var y=x.crs||n,z=t(x),aa=u.getBoundsZoom(v,w,{zoomRange:z,crs:y});if(aa===null)aa=z[0];var ba=y.latLngToPoint(v.getSouthWest(),aa),ca=y.latLngToPoint(v.getNorthEast(),aa),da=u.fromLatLng(y.pointToLatLng(ba.add(ca).divideBy(2),aa));return new i({center:da,zoom:aa});},getBoundsZoom:function(v,w,x){var y=x.crs||n,z=t(x),aa=h.point(w.width,w.height),ba=v.getNorthWest(),ca=v.getSouthEast(),da=z[0]-1;for(;da<=z[1];++da){var ea=y.latLngToPoint(ca,da+1),fa=y.latLngToPoint(ba,da+1),ga=ea.subtract(fa).floor();if(!aa.contains(ga))break;}if(da<z[0])return null;if(da<=z[1])return da;return da-1;},getViewBounds:function(v,w,x){x=x||n;var y=w.width/2,z=w.height/2,aa=u.toLatLng(v.center),ba=x.latLngToPoint(aa,v.zoom),ca=x.pointToLatLng(h.point(ba.x-y,ba.y+z),v.zoom),da=x.pointToLatLng(h.point(ba.x+y,ba.y-z),v.zoom);return u.normalizedBounds(ca,da);},isViewInBounds:function(v,w,x,y){var z=u.getViewBounds(v,w,y),aa=u.shiftBoundsLng(z,o);return x.some(function(ba){return ba.contains(z)||ba.contains(aa);});},projectCircle:function(v,w,x){x=x||n;var y=v.center.latitude,z=v.center.longitude,aa=(v.radius/s)*r,ba=x.latLngToPoint(h.latLng(y+aa,z),w),ca=x.latLngToPoint(h.latLng(y-aa,z),w),da=ba.add(ca).divideBy(2),ea=x.pointToLatLng(da,w).lat,fa=y*q,ga=ea*q,ha=Math.acos((Math.cos(aa*q)-Math.sin(fa)*Math.sin(ga))/(Math.cos(fa)*Math.cos(ga)))*r,ia=isNaN(ha)?0:Math.max(Math.round(da.x-x.latLngToPoint(h.latLng(ea,z-ha),w).x),1),ja=Math.max(Math.round(da.y-ba.y),1);return {center:da,radius:h.point(ia,ja)};},circleBounds:function(v,w,x){x=x||n.projection;var y=v.lat,z=v.lng,aa=(w/s)*r,ba=x.project(h.latLng(y+aa,z)),ca=x.project(h.latLng(y-aa,z)),da=ba.add(ca).divideBy(2),ea=x.unproject(da).lat,fa=y*q,ga=ea*q,ha=Math.acos((Math.cos(aa*q)-Math.sin(fa)*Math.sin(ga))/(Math.cos(fa)*Math.cos(ga)))*r;return h.latLngBounds(h.latLng(ea-aa,z-ha),h.latLng(ea+aa,z+ha));},shiftBoundsLng:function(v,w){return h.latLngBounds([v.getSouthWest().lat,v.getSouthWest().lng+w],[v.getNorthEast().lat,v.getNorthEast().lng+w]);},shouldShowAttribution:function(v,w,x){if(Math.min(w.height,w.width)<250)return false;if(v.zoom<j.OSM_ZOOM_THRESHOLD)return true;return !u.isViewInBounds(v,w,m,x);},toLatLng:function(v){return new h.LatLng(v.latitude,v.longitude);},wrapLongitude:function(v){return l(v+p,o)-p;}};e.exports=u;},null);
__d("FBOverlayBase.react",["React"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g.createClass({displayName:"FBOverlayBase",render:function(){return g.Children.only(this.props.children);}});e.exports=h;},null);
__d("FBOverlayElement.react",["React","cloneWithProps","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g,l=k.PropTypes,m={horizontal:{left:"_32rg",right:"_32rh",fit:j("_32rg","_32rh")},vertical:{top:"_32ri",bottom:"_32rj",fit:j("_32ri","_32rj")}},n=g.createClass({displayName:"FBOverlayElement",propTypes:{horizontal:l.oneOf(['left','right','fit']),vertical:l.oneOf(['top','bottom','fit'])},getDefaultProps:function(){return {horizontal:'fit',vertical:'fit'};},render:function(){var o=j("_32rk",m.horizontal[this.props.horizontal],m.vertical[this.props.vertical]);return h(g.Children.only(this.props.children),{className:o});}});e.exports=n;},null);
__d("FBOverlayContainer.react",["FBOverlayBase.react","FBOverlayElement.react","React","cx","invariant","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=i.createClass({displayName:"FBOverlayContainer",propTypes:{children:function(n,o){var p=n[o],q=0;i.Children.forEach(p,function(r){if(r===null||r===(void 0))return;switch(r.type){case g:q++;break;case h:break;default:k(false);}});k(q===1);}},render:function(){return (i.createElement("div",i.__spread({},this.props,{className:l(this.props.className,"_23n-")}),this.props.children));}});e.exports=m;},null);
__d("FBTilesMapZoomOverlay.react",["Image.react","React","ReactComponentWithPureRenderMixin","XUIButton.react","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=h,n=m.PropTypes,o=h.createElement(g,{src:l('/images/ads/common/zoom_icon/icon_plus.png')}),p=h.createElement(g,{src:l('/images/ads/common/zoom_icon/icon_minus.png')}),q=h.createClass({displayName:"FBTilesMapZoomOverlay",mixins:[i],propTypes:{onZoomIn:n.func,onZoomOut:n.func},render:function(){var r=this.props,s=r.onZoomIn,t=r.onZoomOut,u=(function(v,w){var x={},y=Object.prototype.hasOwnProperty;if(v==null)throw new TypeError();for(var z in v)if(y.call(v,z)&&!y.call(w,z))x[z]=v[z];return x;})(r,{onZoomIn:1,onZoomOut:1});return (h.createElement("div",h.__spread({},u),h.createElement("div",null,h.createElement(j,{disabled:s==null,image:o,onClick:s})),h.createElement("div",null,h.createElement(j,{className:"_3d8x",disabled:t==null,image:p,onClick:t}))));}});e.exports=q;},null);
__d("LeafletAttributionLogo.react",["React","TilesMapConfig","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g.createClass({displayName:"LeafletAttributionLogo",render:function(){var l=h.LOGO.url;return (g.createElement("div",{className:j(this.props.className,"_11kj"),style:{backgroundImage:("url("+l+")"),height:h.LOGO.height+'px',width:h.LOGO.width+'px'}}));}});e.exports=k;},null);
__d("SubscriptionList",["invariant"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i,j){"use strict";this.$SubscriptionList0=[];this.$SubscriptionList1=i;this.$SubscriptionList2=j;}h.prototype.$SubscriptionList3=function(i){"use strict";var j=this.$SubscriptionList0.indexOf(i);g(j!==-1);this.$SubscriptionList0.splice(j,1);if(this.$SubscriptionList0.length===0)this.$SubscriptionList2.call();};h.prototype.add=function(i){"use strict";var j={callback:i};this.$SubscriptionList0.push(j);if(this.$SubscriptionList0.length===1)this.$SubscriptionList1.call();return {remove:this.$SubscriptionList3.bind(this,j)};};h.prototype.getCallbacks=function(){"use strict";return this.$SubscriptionList0.map(function(i){return i.callback;});};h.prototype.fireCallbacks=function(){"use strict";for(var i=[],j=0,k=arguments.length;j<k;j++)i.push(arguments[j]);this.$SubscriptionList0.forEach(function(l){l.callback.apply(null,i);});};e.exports=h;},null);
__d("ElementResizeEmitter",["DOM","EventListener","SubscriptionList","cx","invariant","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=!!navigator.userAgent.match(/Trident/);for(var n in i)if(i.hasOwnProperty(n))p[n]=i[n];var o=i===null?null:i.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=i;function p(q){k(getComputedStyle(q).position!=='static');this.$ElementResizeEmitter0=q;this.$ElementResizeEmitter1=false;i.call(this,this.$ElementResizeEmitter2.bind(this),this.$ElementResizeEmitter3.bind(this));}p.prototype.$ElementResizeEmitter2=function(){var q=document.createElement('iframe');if(m)q.src=("javascript:void((function(){document.open();document.domain="+JSON.stringify(document.domain)+";document.close();})())");q.className="_3dtr";q.onload=this.$ElementResizeEmitter4.bind(this);this.$ElementResizeEmitter0.appendChild(q);this.$ElementResizeEmitter5=q;};p.prototype.$ElementResizeEmitter3=function(){if(this.$ElementResizeEmitter6!=(void 0))this.$ElementResizeEmitter6.remove();if(this.$ElementResizeEmitter5){g.remove(this.$ElementResizeEmitter5);this.$ElementResizeEmitter5=(void 0);}};p.prototype.$ElementResizeEmitter4=function(){this.$ElementResizeEmitter7();var q;try{q=this.$ElementResizeEmitter5.contentWindow;q.document;}catch(r){return;}this.$ElementResizeEmitter6=h.listen(q,'resize',this.$ElementResizeEmitter7.bind(this));};p.prototype.$ElementResizeEmitter7=function(){if(this.$ElementResizeEmitter1)return;this.$ElementResizeEmitter1=true;l(function(){this.fireCallbacks();this.$ElementResizeEmitter1=false;}.bind(this));};e.exports=p;},null);
__d("LeafletMapLayer.react",["React","invariant","onlyChild"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"LeafletMapLayer",propTypes:{onAddLayer:k.func.isRequired,onRemoveLayer:k.func.isRequired},componentDidMount:function(){var m=i(this.props.children);h(m.type.mutate);h(m.type.toLayer);this._createLayer(m);this._prevChild=m;},componentDidUpdate:function(m,n){var o=i(this.props.children);if(!this._mutate(o)){this.props.onRemoveLayer(this._layer);this._createLayer(o);}this._prevChild=o;},componentWillUnmount:function(){this.props.onRemoveLayer(this._layer);this._layer=null;},render:function(){return null;},_createLayer:function(m){this._layer=m.type.toLayer(m.props);this.props.onAddLayer(this._layer);},_mutate:function(m){if(m.type!==this._prevChild.type)return false;if(m.props===this._prevChild.props)return true;return m.type.mutate(this._layer,m.props,this._prevChild.props);}});e.exports=l;},null);
__d("forEachDifference",["forEachObject"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(i,j,k){g(i,function(l,m){if(Object.prototype.hasOwnProperty.call(j,m)){k.onBoth&&k.onBoth(l,j[m],m);}else k.onLeft&&k.onLeft(l,m);});g(j,function(l,m){if(!Object.prototype.hasOwnProperty.call(i,m))k.onRight&&k.onRight(l,m);});}e.exports=h;},null);
__d("LeafletMap.react",["ElementResizeEmitter","leaflet","LeafletMapLayer.react","LeafletUtils","LeafletView","React","Set","debounceCore","emptyFunction","forEachDifference","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();'use strict';var s=l,t=s.PropTypes,u=100,v=10,w=new m(['dragging','touchZoom','doubleClickZoom','scrollWheelZoom','boxZoom','keyboard','tab']),x=t.instanceOf(k),y=r({STILL:undefined,MOVING:undefined,MOVING_STALE:undefined});function z(ca){var da=ca.getCenter();return new k({center:j.fromLatLng(da),zoom:ca.getZoom()});}function aa(ca,da){return {center:[ca.center.latitude,ca.center.longitude],zoom:ca.zoom,attributionControl:false,layers:da,trackResize:false};}var ba=l.createClass({displayName:"LeafletMap",propTypes:{className:t.string,defaultOptions:t.object,defaultView:x,eventHandlers:t.object,onSizeSettled:t.func,onViewChange:t.func,options:t.object,style:t.object,view:function(ca,da,ea){var fa=x(ca,da,ea);if(!ca[da]||fa)return fa;if(ca[da]&&ca.defaultView)return new Error('You provided both `view` and `defaultView` props to LeafletMap. '+'`defaultView` will be discarded.');if(ca.onViewChange)return;return new Error('You provided a `view` prop to LeafletMap without an '+'`onViewChange` handler. This will prevent the user to move the '+'view. If the view should be movable use `defaultView`. Otherwise, '+'set `onViewChange`.');}},componentDidMount:function(){var ca=Object.assign({},this.props.defaultOptions,this.props.options,aa(this._getView(),this._getInitLayers()));this._map=h.map(l.findDOMNode(this),ca);this._initLayers=null;this._setViewFromPropDebounced=n(this._setViewFromProp,u);this._updateEventHandlers({});this._map.on('movestart',this._onMoveStart);this._map.on('moveend',this._onMoveEnd);this._internalViewState=y.STILL;this._warnings=new m();this._setView=n(function(da,ea){if(this._map)this._map.setView(da,ea);}.bind(this),v);this._resizeListener=(new g(l.findDOMNode(this))).add(function(){this._map.invalidateSize();this.props.onSizeSettled(this._map.getSize());}.bind(this));},componentDidUpdate:function(ca,da){this._updateEventHandlers(ca.eventHandlers);this._updateOptions(ca.options);this._updateView(ca.view);},componentWillUnmount:function(){this._resizeListener.remove();this._map.remove();this._map=null;},getDefaultProps:function(){return {eventHandlers:{},onSizeSettled:o,options:{}};},render:function(){var ca=l.Children.map(this.props.children,function(da,ea){if(!da)return da;return (l.createElement(i,{key:da.key,onAddLayer:this._onAddLayer,onRemoveLayer:this._onRemoveLayer},da));}.bind(this));return (l.createElement("div",{className:this.props.className,style:Object.assign({display:'relative'},this.props.style)},ca));},_getInitLayers:function(){if(!this._initLayers)this._initLayers=[];return this._initLayers;},_getView:function(){if(this.props.view)return this.props.view;if(this.props.defaultView)return this.props.defaultView;return k.DEFAULT;},_onAddLayer:function(ca){if(this._map){this._map.addLayer(ca);return;}this._getInitLayers().push(ca);},_onMoveEnd:function(ca){if(!this._map)return;var da=z(this._map),ea=this._internalViewState;this._internalViewState=y.STILL;if(this.props.view){if(ea===y.MOVING_STALE){this._setViewFromProp();return;}if(da.nearlyEquals(this.props.view))return;this._setViewFromPropDebounced();}if(!this.props.onViewChange)return;this.props.onViewChange(da);},_onMoveStart:function(){if(!this._map)return;if(this._internalViewState===y.STILL)this._internalViewState=y.MOVING;},_onRemoveLayer:function(ca){q(this._map!==undefined);if(this._map!==null)this._map.removeLayer(ca);},_setOption:function(ca,da){if(!w.has(ca))throw new Error('cannot change Leaflet option `'+ca+'` during component lifetime');this._map[ca][da?'enable':'disable']();},_setViewFromProp:function(){this._setViewFromPropDebounced.reset();if(this._internalViewState===y.MOVING)this._internalViewState=y.MOVING_STALE;var ca=this.props.view;if(ca.nearlyEquals(z(this._map)))return;this._setView([ca.center.latitude,ca.center.longitude],ca.zoom);},_updateEventHandlers:function(ca){p(this.props.eventHandlers,ca,{onLeft:function(da,ea){this._map.on(ea,da);}.bind(this),onRight:function(da,ea){this._map.off(ea,da);}.bind(this),onBoth:function(da,ea,fa){if(da!==ea){this._map.off(fa,ea);this._map.on(fa,da);}}.bind(this)});},_updateOptions:function(ca){if(this.props.options===ca)return;p(this.props.options,ca,{onLeft:function(da,ea){return this._setOption(ea,da);}.bind(this),onRight:function(da,ea){throw new Error('reverting Leaflet option `'+ea+'` back to default is not supported');},onBoth:function(da,ea,fa){if(da!==ea)this._setOption(fa,da);}.bind(this)});},_updateView:function(ca){var da=this.props.view;if(!da||!this._map||da===ca||da.nearlyEquals(ca))return;this._setViewFromProp();},_warnForDefaultProp:function(ca,da){if(ca[da]!==this.props[da]&&!this._warnings.has(da))this._warnings.add(da);}});e.exports=ba;},null);
__d("LeafletTileLayer.react",["React","leaflet","areEqual"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"LeafletMapTileLayer",propTypes:{options:k.object,urlTemplate:k.string.isRequired},statics:{mutate:function(m,n,o){var p=o.options||{},q=p.opacity,r=p.zIndex,s=(function(x,y){var z={},aa=Object.prototype.hasOwnProperty;if(x==null)throw new TypeError();for(var ba in x)if(aa.call(x,ba)&&!aa.call(y,ba))z[ba]=x[ba];return z;})(p,{opacity:1,zIndex:1}),t=n.options||{},u=t.opacity,v=t.zIndex,w=(function(x,y){var z={},aa=Object.prototype.hasOwnProperty;if(x==null)throw new TypeError();for(var ba in x)if(aa.call(x,ba)&&!aa.call(y,ba))z[ba]=x[ba];return z;})(t,{opacity:1,zIndex:1});if(!i(w,s))return false;if(u!==q)m.setOpacity(u);if(v!==r)m.setZIndex(v);if(n.urlTemplate!==o.urlTemplate)m.setUrl(n.urlTemplate);return true;},toLayer:function(m){return h.tileLayer(m.urlTemplate,m.options);}},render:function(){return null;}});e.exports=l;},null);
__d("TilesMapUtils",["CurrentLocale","GeoCoordinates","GeoRectangle","LeafletView","TilesMapConfig"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={DEFAULT_VIEW:new j({center:new h(0,0),zoom:k.ZOOM_RANGE.MIN}),getTileURLTemplate:function(m){if(!m)m=g.get();return k.TILE_URL_TEMPLATE+'&language='+m;},getOSMRects:function(){return l.getOSMRectsFromRaw(k.OSM_RECTS_RAW);},getOSMRectsFromRaw:function(m){return m.map(function(n){return new i(n[0],n[1],n[2],n[3]);});}};e.exports=l;},null);
__d("FBTilesMap.react",["FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","FBTilesMapZoomOverlay.react","LeafletAttributionLogo.react","LeafletMap.react","LeafletTileLayer.react","LeafletUtils","React","TilesMapConfig","TilesMapUtils","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();'use strict';var s=o,t=s.PropTypes,u=q.getTileURLTemplate(),v={maxZoom:p.ZOOM_RANGE.MAX,minZoom:p.ZOOM_RANGE.MIN};function w(ba,ca){if(ca!=null&&ca.type===i)return ba?ca:undefined;return ba?undefined:ca;}var x=function(ba){return o.Children.map(ba,w.bind(undefined,false));},y=function(ba){return o.Children.map(ba,w.bind(undefined,true));};function z(ba){return {overlays:y(ba),others:x(ba)};}var aa=o.createClass({displayName:"FBTilesMap",propTypes:{className:t.string,showZoomControls:t.bool,style:t.object},getInitialState:function(){return {size:undefined};},render:function(){var ba=this.props,ca=ba.children,da=ba.className,ea=ba.style,fa=(function(ja,ka){var la={},ma=Object.prototype.hasOwnProperty;if(ja==null)throw new TypeError();for(var na in ja)if(ma.call(ja,na)&&!ma.call(ka,na))la[na]=ja[na];return la;})(ba,{children:1,className:1,style:1}),ga=z(ca),ha=ga.others,ia=ga.overlays;return (o.createElement(h,{className:da,style:ea},o.createElement(g,null,this._renderMap(ha,fa)),ia,this._renderAttribution(),this._renderZoomControls()));},_onSizeSettled:function(ba){this.setState({size:ba});if(this.props.onSizeSettled!=null)this.props.onSizeSettled(ba);},_onZoomIn:function(){var ba=this.props.view;if(ba==null||this.props.onViewChange==null)return;if(ba.zoom<p.ZOOM_RANGE.MAX)this.props.onViewChange(ba.setZoom(ba.zoom+1));},_onZoomOut:function(){var ba=this.props.view;if(ba==null||this.props.onViewChange==null)return;if(ba.zoom>p.ZOOM_RANGE.MIN)this.props.onViewChange(ba.setZoom(ba.zoom-1));},_renderAttribution:function(){if(this.state.size!=null&&!n.shouldShowAttribution(this.props.view,{width:this.state.size.x,height:this.state.size.y}))return;return (o.createElement(i,{vertical:"bottom",horizontal:"left"},o.createElement(k,null)));},_renderMap:function(ba,ca){var da=Object.assign({},ca.defaultOptions,{zoomControl:false});return (o.createElement(l,o.__spread({},ca,{className:"_5db7",defaultOptions:da,onSizeSettled:this._onSizeSettled}),o.createElement(m,{options:v,urlTemplate:u}),ba));},_renderZoomControls:function(){if(this.props.view==null||this.props.onViewChange==null||!this.props.showZoomControls)return;var ba=this.props.view.zoom<v.maxZoom?this._onZoomIn:undefined,ca=this.props.view.zoom>v.minZoom?this._onZoomOut:undefined;return (o.createElement(i,{vertical:"top",horizontal:"left"},o.createElement(j,{className:"_3-8j",onZoomIn:ba,onZoomOut:ca})));}});e.exports=aa;},null);
__d("partitionObject",["forEachObject"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(i,j,k){var l={},m={};g(i,function(n,o){if(j.call(k,n,o,i)){l[o]=n;}else m[o]=n;});return [l,m];}e.exports=h;},null);
__d("partitionObjectByKey",["partitionObject"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(i,j){return g(i,function(k,l){return j.has(l);});}e.exports=h;},null);
__d("LeafletPath",["Set","areEqual","partitionObjectByKey"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=(function(){var l=new g(['color','dashArray','fill','fillColor','fillOpacity','lineCap','lineJoin','opacity','stroke','weight']);return function(m){return i(m,l);};})(),k={mutateOptions:function(l,m,n){var o=j(m||{}),p=o[0],q=o[1],r=j(n||{}),s=r[0],t=r[1];if(!h(q,t))return false;if(!h(p,s))l.setStyle(p);return true;}};e.exports=k;},null);
__d("LeafletCircleMarker.react",["GeoCoordinates","leaflet","LeafletPath","LeafletUtils","React"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=k,m=l.PropTypes,n=k.createClass({displayName:"LeafletCircleMarker",propTypes:{options:m.object,center:m.instanceOf(g).isRequired},statics:{mutate:function(o,p,q){var r=p.options||{},s=r.radius,t=(function(x,y){var z={},aa=Object.prototype.hasOwnProperty;if(x==null)throw new TypeError();for(var ba in x)if(aa.call(x,ba)&&!aa.call(y,ba))z[ba]=x[ba];return z;})(r,{radius:1}),u=q.options||{},v=u.prevRadius,w=(function(x,y){var z={},aa=Object.prototype.hasOwnProperty;if(x==null)throw new TypeError();for(var ba in x)if(aa.call(x,ba)&&!aa.call(y,ba))z[ba]=x[ba];return z;})(u,{prevRadius:1});if(!i.mutateOptions(o,t,w))return false;if(p.center!==q.center)o.setLatLng(j.toLatLng(p.center));if(s!==v)o.setRadius(p.radius);return true;},toLayer:function(o){return h.circleMarker(j.toLatLng(o.center),o.options);}},render:function(){return null;}});e.exports=n;},null);
__d("LeafletPolyline.react",["leaflet","LeafletPath","LeafletUtils","immutable","React","nearlyEqualNumbers"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=k,n=m.PropTypes,o=k.createClass({displayName:"LeafletPolyline",propTypes:{options:n.object,coordinates:n.instanceOf(j.List).isRequired},statics:{coordinatesToLatLngs:function(p){return p.toSeq().map(i.toLatLng).toArray();},mutate:function(p,q,r){if(!o.mutateOptions(p,q.options,r.options))return false;if(!j.is(q.coordinates,r.coordinates))p.setLatLngs(o.coordinatesToLatLngs(q.coordinates));return true;},toLayer:function(p){return g.polyline(o.coordinatesToLatLngs(p.coordinates),p.options);},mutateOptions:function(p,q,r){var s=q||{},t=s.smoothFactor,u=s.noClip,v=(function(aa,ba){var ca={},da=Object.prototype.hasOwnProperty;if(aa==null)throw new TypeError();for(var ea in aa)if(da.call(aa,ea)&&!da.call(ba,ea))ca[ea]=aa[ea];return ca;})(s,{smoothFactor:1,noClip:1}),w=r||{},x=w.smoothFactor,y=w.noClip,z=(function(aa,ba){var ca={},da=Object.prototype.hasOwnProperty;if(aa==null)throw new TypeError();for(var ea in aa)if(da.call(aa,ea)&&!da.call(ba,ea))ca[ea]=aa[ea];return ca;})(w,{smoothFactor:1,noClip:1});if(!h.mutateOptions(p,z,v))return false;if(!l(x,t)||y!==u)return false;return true;}},render:function(){return null;}});e.exports=o;},null);
__d("LeafletPopup.react",["GeoCoordinates","leaflet","LeafletUtils","React","areEqual"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=j,m=l.PropTypes,n=j.createClass({displayName:"LeafletPopup",propTypes:{options:m.object,coordinates:m.instanceOf(g)},statics:{mutate:function(o,p,q){if(!k(p.options,q.options))return false;if(p.coordinates!==q.coordinates)o.setLatLng(i.toLatLng(p.coordinates));var r=o.getContent(),s=j.Children.only(p.children);j.render(s,r);return true;},toLayer:function(o){var p=h.popup(o.options);if(o.coordinates)p.setLatLng(i.toLatLng(o.coordinates));var q=j.Children.only(o.children),r=document.createElement('div');p.setContent(r);j.render(q,r,function(){return p.update();});return p;}},render:function(){return null;}});e.exports=n;},null);
__d("LeafletMarker.react",["GeoCoordinates","leaflet","LeafletPopup.react","LeafletUtils","React","areEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=k,n=m.PropTypes,o=k.createClass({displayName:"LeafletMarker",propTypes:{options:n.object,coordinates:n.instanceOf(g).isRequired,popup:n.instanceOf(i)},statics:{mutate:function(p,q,r){var s=r.options||{},t=s.opacity,u=s.zIndex,v=(function(ba,ca){var da={},ea=Object.prototype.hasOwnProperty;if(ba==null)throw new TypeError();for(var fa in ba)if(ea.call(ba,fa)&&!ea.call(ca,fa))da[fa]=ba[fa];return da;})(s,{opacity:1,zIndex:1}),w=q.options||{},x=w.opacity,y=w.zIndex,z=(function(ba,ca){var da={},ea=Object.prototype.hasOwnProperty;if(ba==null)throw new TypeError();for(var fa in ba)if(ea.call(ba,fa)&&!ea.call(ca,fa))da[fa]=ba[fa];return da;})(w,{opacity:1,zIndex:1});if(!l(z,v))return false;if(x!==t)p.setOpacity(x);if(y!==u)p.setZIndex(y);if(q.coordinates!==r.coordinates)p.setLatLng(j.toLatLng(q.coordinates));if(q.popup){var aa=q.popup.type.mutate(p.getPopup(),q.popup.props,r.popup.props);if(!aa){p.unbindPopup();p.bindPopup(q.popup.type.toLayer(q.popup.props));}}else if(!q.popup&&r.popup)p.unbindPopup();return true;},toLayer:function(p){var q=h.marker(j.toLatLng(p.coordinates),p.options);if(p.popup)q.bindPopup(p.popup.type.toLayer(p.popup.props));return q;}},render:function(){return null;}});e.exports=o;},null);
__d("MNCommerceShippingMap.react",["React","cssVar","cx","GeoCoordinates","immutable","leaflet","LeafletUtils","FBTilesMap.react","LeafletCircleMarker.react","LeafletPolyline.react","LeafletMarker.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=g,s=r.PropTypes,t=.02,u={boxZoom:false,doubleClickZoom:false,dragging:false,scrollWheelZoom:false,touchZoom:false,zoomControl:false},v={color:'#70768b',opacity:1,weight:1,fill:true,fillOpacity:1,fillColor:'#ffffff',radius:2.5},w={color:'black',opacity:.2},x={color:"#5890ff",opacity:1},y={iconSize:[30,37],iconAnchor:[15,37]},z=445,aa=242,ba=g.createClass({displayName:"MNCommerceShippingMap",propTypes:{className:s.string,destination:s.instanceOf(j).isRequired,delivered:s.bool,shippingCheckPoints:s.instanceOf(k.List).isRequired,style:s.object},getInitialState:function(){return {size:l.point(z,aa)};},render:function(){return (g.createElement(n,{className:this.props.className,view:this._getView(),style:this.props.style,options:u,onViewChange:this._onViewChange,onSizeSettled:this._onSizeSettled},this._renderShippingCheckPoints(),this._renderDestinationPolyline(),this._renderDestinationWayPoint(),this._renderLocationIdentifiers()));},_onViewChange:function(){},_renderShippingCheckPoints:function(){if(this.props.shippingCheckPoints.size>1)return (g.createElement(p,{coordinates:this.props.shippingCheckPoints,options:x}));},_renderDestinationPolyline:function(){if(!this.props.delivered&&this.props.shippingCheckPoints.size>0){var ca=k.List([this.props.destination,this.props.shippingCheckPoints.first()]);return (g.createElement(p,{coordinates:ca,options:w}));}},_renderDestinationWayPoint:function(){return (g.createElement(q,{coordinates:this.props.destination,options:{icon:l.divIcon(Object.assign({},y,{className:"_18ea"}))}}));},_renderLocationIdentifiers:function(){var ca=[this.props.destination];if(this.props.shippingCheckPoints.size>0)return ca.concat(this.props.shippingCheckPoints.toArray()).map(function(da,ea){return g.createElement(o,{center:da,key:ea,options:v});});},_getLatLngPoints:function(){var ca=[this.props.destination];if(this.props.shippingCheckPoints.size>0)ca=ca.concat(this.props.shippingCheckPoints.toArray());return ca.map(m.toLatLng);},_getView:function(){var ca=this._getLatLngPoints(),da=l.latLngBounds(ca).pad(t);return m.fitBounds(da,{width:this.state.size.x,height:this.state.size.y},{zoomRange:[0,12]});},_onSizeSettled:function(ca){this.setState({size:ca});}});e.exports=ba;},null);
__d("MNCommerceShippingDetailsDialog.react",["ActionList.react","GeoCoordinates","immutable","Link.react","MNCommerceAddress.react","MNCommerceAttachmentConstants","MNCommerceDetailSection.react","MNCommerceItemList.react","MNCommerceLogoHeader.react","MNCommerceShippingMap.react","React","MNCommerceDialog.react","MNCommerceDialogBody.react","MNCommerceDialogTitle.react","XUISpinner.react","cx","fbt","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();'use strict';var y=q,z=y.PropTypes,aa=q.createClass({displayName:"MNCommerceShippingDetailsDialog",propTypes:{shipment:z.shape({address:z.shape({street_1:z.string,street_2:z.string,city:z.string,state:z.string,postal_code:z.string}),carrierInfo:z.string,changeURL:z.string,deliverDate:z.string,name:z.string,shipDate:z.string,delivered:z.bool,destination:z.instanceOf(h),items:z.object,logo:z.shape({height:z.number,width:z.number,src:z.string}),orderDetailsURL:z.string,rawAddress:z.string,progress:z.object,shippingCheckPoints:z.instanceOf(i.List),trackingNumber:z.string}),shown:z.bool.isRequired,error:z.object,loading:z.bool.isRequired,onToggle:z.func},getDefaultProps:function(){return {shown:false};},render:function(){var ba=null;if(this.props.loading){ba=this._renderLoadingDetailsSection();}else if(this.props.error){ba=this._renderErrorDetailsSection();}else ba=this._renderFullDetailsSection();return (q.createElement(r,{className:"_z-y",modal:true,onToggle:this.props.onToggle,shown:this.props.shown},q.createElement(t,null,w._("Shipping Details")),q.createElement(s,{useCustomPadding:true},ba)));},_renderErrorDetailsSection:function(){return (q.createElement("div",{className:"_1bi1"},q.createElement("p",{className:"_1bi3"},"Sorry, Something Went Wrong"),q.createElement("p",{className:"_1bi4"},"Your shipment details couldn't be shown.")));},_renderLoadingDetailsSection:function(){return (q.createElement("div",{className:"_p43"},q.createElement(u,{background:"light",size:"large",paused:false})));},_renderFullDetailsSection:function(){return (q.createElement("div",null,this._renderMap(),q.createElement("div",{className:"_3qia"},q.createElement("div",null,this._renderCallToActionList()),q.createElement("div",null,this._renderDeliverySection(),this._renderAddressSection(),this._renderCarrierSection(),this._renderProgressSection(),this._renderItemsSection()),q.createElement("div",{className:"_3qih"},this._renderLogo()))));},_processItems:function(){var ba=Object.keys(this.props.shipment.items).map(function(ca){var da=this.props.shipment.items[ca],ea=x({},da);ea.id=ca;ea.thumbURL=da.thumb_url;return ea;}.bind(this));return ba;},_getItemsHeader:function(){var ba,ca=this._processItems();if(ca.length===1){ba=(w._("Item"));}else if(ca.length>1){ba=(w._("Items"));}else ba=(w._("No items found"));return ba;},_renderDeliverySection:function(){if(!this.props.shipment.deliverDate)return null;return (q.createElement(m,{className:"_3qic",headerLabel:w._("Delivery on")},this.props.shipment.deliverDate));},_renderAddressSection:function(){if(!this.props.shipment.address&&!this.props.rawAddress)return null;return (q.createElement(m,{className:"_3qic",headerLabel:w._("Ship to")},q.createElement(k,{address:this.props.shipment.address,rawAddress:this.props.shipment.rawAddress,name:this.props.shipment.name})));},_renderCarrierSection:function(){if(!this.props.shipment.carrierInfo)return null;return (q.createElement(m,{className:"_3qic",headerLabel:w._("Carrier")},this.props.shipment.carrierInfo));},_renderProgressSection:function(){var ba=this.props.shipment.progress,ca=Object.keys(ba).reverse(),da=null;if(!ba||!ca.length){da=(w._("Tracking info should be available soon"));}else da=ca.map(function(ea){var fa=ba[ea];return (q.createElement("div",{className:"_3qii",key:ea},q.createElement("p",{className:"_3qij"},fa.description),q.createElement("p",{className:"_3qik"},fa.date)));});return (q.createElement(m,{className:"_3qic",headerLabel:w._("Tracking")},da));},_renderItemsSection:function(){if(!this.props.shipment.items)return null;var ba=l.DIALOG.WIDTH-2*l.DIALOG.PADDING;return (q.createElement(m,{className:"_3qic _39yr",headerLabel:this._getItemsHeader(),margin:6},q.createElement(n,{imageDimension:l.SMALL_IMAGE_DIMENSION,items:this._processItems(),size:"small",width:ba})));},_renderLogo:function(){if(!this.props.shipment.logo)return null;var ba=(w._("Tracking number: {tracking number}",[w.param("tracking number",this.props.shipment.trackingNumber)]));return (q.createElement("div",{className:"_3xyi"},q.createElement(o,{logo:this.props.shipment.logo,label:ba})));},_renderMap:function(){if(!this.props.shipment.destination)return null;return (q.createElement(p,{className:"_387w",delivered:this.props.shipment.delivered,destination:this.props.shipment.destination,shippingCheckPoints:this.props.shipment.shippingCheckPoints}));},_renderCallToActionList:function(){var ba=[];if(this.props.shipment.changeURL)ba.push(q.createElement(j,{className:"_3qil",href:this.props.shipment.changeURL,key:"changeDelivery",target:"_blank"},w._("Change Delivery Options")));if(!ba.length)return null;return (q.createElement(g,{className:"_3qim"},ba));},_onViewChange:function(ba){this.setState({view:ba});}});e.exports=aa;},null);
__d("MNCommerceShipmentActions",["MessengerDispatcher","MNCommerceActionTypes"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={shipmentLoaded:function(j){g.dispatch({type:h.SHIPMENT.LOADED,shipment:j});},shipmentLoadError:function(j){g.dispatch({type:h.SHIPMENT.LOAD_ERROR,shipmentID:j});}};e.exports=i;},null);
__d("XMNCommerceShippingDetailsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/messages\/commerce\/shipping_details\/",{shipment_id:{type:"String",required:true}});},null);
__d("MNCommerceShipmentDataManager",["AsyncRequest","MNCommerceShipmentActions","XMNCommerceShippingDetailsController"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';function j(){}j.prototype.fetchShipment=function(k){var l=i.getURIBuilder().setString('shipment_id',k).getURI();new g().setURI(l).setHandler(this.$MNCommerceShipmentDataManager0).setErrorHandler(this.$MNCommerceShipmentDataManager1).send();};j.prototype.$MNCommerceShipmentDataManager0=function(k){h.shipmentLoaded(k.payload);};j.prototype.$MNCommerceShipmentDataManager1=function(k){var l=k.getRequest().uri.getQueryData(),m=l.shipment_id;h.shipmentLoadError(m);};e.exports=new j();},null);
__d("MNCommerceShipmentStore",["Cache","FluxStore","LoadObject","MessengerDispatcher","MNCommerceActionTypes","MNCommerceCacheTimeoutLimits","MNCommerceShipmentDataManager"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';for(var n in h)if(h.hasOwnProperty(n))p[n]=h[n];var o=h===null?null:h.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=h;function p(){h.call(this,j);this.$MNCommerceShipmentStore0=new g();}p.prototype.__onDispatch=function(q){var r=q.type;switch(r){case k.SHIPMENT.LOADED:var s=q.shipment;this.$MNCommerceShipmentStore0.set(s.shipment_id,i.empty().setValue(s),null,l.SUCCESS_TIMEOUT);this.__emitChange();break;case k.SHIPMENT.LOAD_ERROR:var t=q.shipmentID;this.$MNCommerceShipmentStore0.set(t,i.empty().setError(new Error('Unable to load shipment: '+t)),null,l.ERROR_TIMEOUT);this.__emitChange();break;}};p.prototype.getShipment=function(q){if(q&&!this.$MNCommerceShipmentStore0.has(q)){this.$MNCommerceShipmentStore0.set(q,i.loading().setValue({shipmentID:q}));m.fetchShipment(q);}return this.$MNCommerceShipmentStore0.get(q)||i.empty();};e.exports=new p();},null);
__d("MNCommerceShippingDetailsDialogContainer.react",["BanzaiLogger","GeoCoordinates","immutable","MNCommerceDialogStateActions","MNCommerceDialogStateStore","MNCommerceLoggingConstants","MNCommerceLoggerEvents","MNCommerceShippingDetailsDialog.react","MNCommerceShipmentStore","PureStoreBasedStateMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=q.createClass({displayName:"MNCommerceShippingDetailsDialogContainer",mixins:[p(o)],statics:{calculateState:function(){var s=k.getState(),t=null;if(s)t=s.shipmentID;var u=o.getShipment(t);if(!u.isLoading())g.log('MessengerCommerceLoggerConfig',{event:(u.hasError()?m.DIALOG_LOAD_ERROR:m.DIALOG_LOAD_SUCCESS),debug_data:JSON.stringify({dialog_surface:l.DIALOG_SURFACE.SHIPMENT,shipment_id:t})});return {shown:!!s,loading:u.isLoading(),shipment:u.getValue(),error:u.getError()};}},render:function(){return (q.createElement(n,{loading:this.state.loading,error:this.state.error,onToggle:this._onToggle,shown:this.state.shown,shipment:this._getParsedShipment(this.state.shipment)}));},_getParsedShipment:function(s){if(!s)return {};var t=[],u=s.origin,v=s.events;if(u&&u.latitude&&(!v||Object.keys(v).length===0)){t=[new h(u.latitude,u.longitude)];}else if(v)t=Object.keys(v).map(function(x){var y=v[x];if(y.location&&y.location.latitude)return new h(y.location.latitude,y.location.longitude);});var w=Array.isArray(s.destination)?null:s.destination;return {address:w,carrierInfo:s.carrier,changeURL:s.carrier_tracking_url,delivered:s.delivered,deliverDate:s.estimated_delivery_display_time,shipDate:s.display_ship_date,destination:(s.destination&&s.destination.latitude)?new h(s.destination.latitude,s.destination.longitude):null,items:s.items,logo:s.carrier_logo?{height:s.carrier_logo.height,width:s.carrier_logo.width,src:s.carrier_logo.url}:null,name:s.recipient_name?s.recipient_name:null,orderDetailsURL:s.order_details_url,progress:s.events,shippingCheckPoints:i.List(t),trackingNumber:s.tracking_number};},_onToggle:function(s){if(!s){g.log('MessengerCommerceLoggerConfig',{event:m.DIALOG_CLOSED,debug_data:JSON.stringify({dialog_surface:l.DIALOG_SURFACE.SHIPMENT,shipment_id:this.state.shipment.shipment_id})});j.hideDialog();}}});e.exports=r;},null);
__d("MNCommerceShippingMercuryAttachment.react",["GeoCoordinates","immutable","MNCommerceItemList.react","MNCommerceAttachmentConstants","MNCommerceLogoHeader.react","MNCommerceShipmentTrackingEventTypes","MNCommerceShippingMap.react","MercuryShareAttachmentRenderLocations","React","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();'use strict';var s=o,t=s.PropTypes,u=o.createClass({displayName:"MNCommerceShippingMercuryAttachment",propTypes:{carrierInfo:t.string,carrierTrackingURL:t.string,deliveryDate:t.string,deliveryPeriod:t.string,destination:t.shape,hasUnsupportedCarrier:t.bool,items:t.array.isRequired,logo:t.object,shippingDate:t.string,type:t.number,width:t.number,onAttachmentClick:t.func},render:function(){var v=null;if(!this.props.hasUnsupportedCarrier&&this.props.logo)v=o.createElement("div",{className:"_3lx4"},o.createElement(k,{logo:this.props.logo}));var w=this.props.items.length>1?q._("Items"):q._("Item");return (o.createElement("div",{className:r((("_3lx3")+(this.props.location===n.WEB_INBOX?' '+"_1hf9":'')),this.props.className)},this._renderUnsupportedURL(),o.createElement("div",{className:"_2jdp",onClick:this.props.onAttachmentClick},this._renderShippingMap(),o.createElement("div",{className:"_2jdq"},v,o.createElement("div",{className:"_3lx5"},this._renderShippingMapDescriptionOrFallback(),o.createElement("p",{className:"_5ry9 _3lxb"},w),this._renderItemDescriptions())))));},_shouldRenderShippingMap:function(){return (this.props.destination&&this.props.destination.latitude&&this.props.destination.longitude&&!!this.props.deliveryDate);},_renderUnsupportedURL:function(){if(this.props.hasUnsupportedCarrier&&this.props.carrierTrackingURL)return (o.createElement("a",{href:this.props.carrierTrackingURL,target:"_blank"}));},_renderShippingMap:function(){if(this._shouldRenderShippingMap()){var v=new g(this.props.destination.latitude,this.props.destination.longitude);if(this.props.location===n.CHAT)return (o.createElement(m,{className:"_2jdr",destination:v,shippingCheckPoints:h.List([]),style:{height:j.SINGLE_IMAGE_HEIGHT}}));return (o.createElement("div",{className:"_2jds"},o.createElement("div",{className:"_2jdt"},o.createElement(m,{className:"_2jdr",destination:v,shippingCheckPoints:h.List([])}))));}},_renderShippingMapDescriptionOrFallback:function(){if(this._shouldRenderShippingMap()){var v=this.props.deliveryDate;if(this.props.deliveryPeriod)v+=', '+this.props.deliveryPeriod;return (o.createElement("div",{className:"_3lx6"},this._renderDeliverySection(),o.createElement("p",{className:"_5ry9"},q._("Ship to")),o.createElement("p",{className:"_5rya"},this._renderDestinationAddress())));}return (o.createElement("div",null,this._renderShippingSection(),this._renderDeliveryOrCarrierSection()));},_renderDestinationAddress:function(){if(!this.props.destination)return null;var v=this.props.destination&&this.props.destination.street_1;if(!!this.props.destination.city)v=v+' '+this.props.destination.city+',';if(!!this.props.destination.state)v=v+' '+this.props.destination.state;return v;},_renderDeliveryOrCarrierSection:function(){var v,w;if(this.props.hasUnsupportedCarrier){v=(q._("Carrier"));w=o.createElement("p",{className:"_5rya"},this.props.carrierInfo);}else if(!this.props.deliveryDate){return null;}else return (o.createElement("div",{className:"_3lx6"},this._renderDeliverySection()));},_renderDeliverySection:function(){var v,w;v=this._getDeliveryLabel();var x=this.props.type===l.DELAYED?o.createElement("span",null,o.createElement("span",{className:"_5ryb"},q._("Delayed")),' '," · ",' '):'',y=this.props.deliveryDate;if(this.props.deliveryPeriod)y+=', '+this.props.deliveryPeriod;w=o.createElement("p",{className:"_5rya"},x,y);return (o.createElement("div",null,o.createElement("p",{className:"_5ry9"},v),w));},_getDeliveryLabel:function(){switch(this.props.type){case l.OUT_FOR_DELIVERY:return (q._("Out for delivery on"));case l.DELIVERED:return (q._("Delivered on"));default:return (q._("Delivery on"));}},_renderShippingSection:function(){if(!this.props.type)return (o.createElement("div",{className:"_3lx6"},o.createElement("p",{className:"_5ry9"},q._("Shipped on")),o.createElement("p",{className:"_5rya"},this.props.shippingDate)));return null;},_renderItemDescriptions:function(){if(!this.props.items.length)return null;var v=this.props.width-2*j.BUBBLE_PADDING;return (o.createElement(i,{items:this.props.items,imageDimension:j.SMALL_IMAGE_DIMENSION,size:"small",width:v}));}});e.exports=u;},null);
__d("MNCommerceShippingMercuryShareAttachment.react",["BanzaiLogger","MercuryShareAttachmentReactShape","MNCommerceBubbleType","MNCommerceDialogStateActions","MNCommerceLoggingConstants","MNCommerceLoggerEvents","MNCommerceShippingDetailsDialogContainer.react","MNCommerceShippingMercuryAttachment.react","ReactComponentWithPureRenderMixin","React","formatDate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=p,s=r.PropTypes,t=p.createClass({displayName:"MNCommerceShippingMercuryShareAttachment",mixins:[o],propTypes:{attachment:h,maxWidth:s.number},render:function(){var u=this.props.attachment,v=[],w=u.target.items;Object.keys(w).forEach(function(da){var ea=w[da],fa=Object.assign({},ea);fa.id=da;fa.thumbURL=ea.thumb_url;v.push(fa);});var x=u.target,y=x.ship_date?q(x.ship_date,'D M d')+', '+q(x.ship_date,'g:ia'):null,z=x.estimated_delivery_time||x.timestamp,aa=z?q(z,'D M d'):null,ba=x.messenger_commerce_bubble_type===i.FB_RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER,ca={carrierInfo:x.carrier,carrierTrackingURL:x.carrier_tracking_url,deliveryDate:aa,destination:x.destination,logo:u.target.carrier_logo?{height:u.target.carrier_logo.height,width:u.target.carrier_logo.width,src:u.target.carrier_logo.url}:null,items:v,hasUnsupportedCarrier:ba,location:this.props.location,width:this.props.maxWidth,type:x.tracking_event_type,shippingDate:y,onAttachmentClick:ba?null:this._onAttachmentClick};return (p.createElement(n,p.__spread({},ca)));},_onAttachmentClick:function(){g.log('MessengerCommerceLoggerConfig',{event:l.DIALOG_OPENED,debug_data:JSON.stringify({dialog_surface:k.DIALOG_SURFACE.SHIPMENT,shipment_id:this.props.attachment.target.shipment_id})});j.showDialog(m,{shipmentID:this.props.attachment.target.shipment_id});}});e.exports=t;},null);
__d("XMomentsAppInstallLinkDialogController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/moments_app\/install_link\/dialog\/",{share_id:{type:"String",required:true},folder_id:{type:"String",required:true},__asyncDialog:{type:"Int"}});},null);
__d("MessengerMomentsAppShareAttachment.react",["AsyncRequest","Image.react","ImageBlock.react","Link.react","MarauderLogger","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareImage.react","React","ReactComponentWithPureRenderMixin","XUIButton.react","XMomentsAppInstallLinkDialogController","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=o,v=u.PropTypes,w=173,x=82,y=200,z={},aa=o.createClass({displayName:"MessengerMomentsAppShareAttachment",mixins:[p],propTypes:{attachment:l,location:v.string,rootClassName:v.string},render:function(){var ba=this.props.attachment;if(!ba||!ba.media||!ba.media.image||!ba.target)return null;if(!z[ba.share_id]){z[ba.share_id]=true;k.log('moments_invite_impression',undefined,{share_id:ba.share_id,folder_id:ba.target.folder_id});}return (o.createElement(j,{className:t("_-2m",this.props.rootClassName),onClick:function(){return this._onClick();}.bind(this)},this._renderContentBlock(ba)));},_onClick:function(){var ba=this.props.attachment;if(!ba||!ba.target)return;var ca=String(ba.share_id),da=String(ba.target.folder_id),ea=r.getURIBuilder().setString('share_id',ca).setString('folder_id',da).getURI();k.log('moments_invite_install_clicked',undefined,{share_id:ca,folder_id:da});new g(ea).send();},_renderContentBlock:function(ba){var ca=ba.media.image,da=ba.target.call_to_action_text,ea=this.props.location;if(ea===m.CHAT||ea===m.MESSENGER){var fa=null;if(ea===m.CHAT){fa=(o.createElement(n,{source:ca,width:w,height:x}));}else fa=(o.createElement("div",{className:"_54hl",style:{backgroundImage:'url('+ca+')'}}));return (o.createElement("div",{className:"_54hm"},fa,o.createElement("div",{className:"_1ath"},this._renderTextBlock(ba,"_1ati"),o.createElement("div",{className:"_-2n"}),o.createElement("div",{className:"_1atj"},da))));}else return (o.createElement(i,null,o.createElement(h,{src:ca,width:y}),o.createElement("div",{className:"_2pi8"},this._renderTextBlock(ba),o.createElement(q,{className:"_3-8n",label:da}))));},_renderTextBlock:function(ba,ca){return (o.createElement("div",{className:t("_54hq",ca)},o.createElement("div",{className:"_-2p"},ba.title),o.createElement("div",{className:"_-2q"},ba.description)));}});e.exports=aa;},null);
__d("MessengerMomentsAppSnippet.react",["Image.react","MercuryShareAttachmentReactShape","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"MessengerMomentsAppSnippet",propTypes:{attachment:h,isSenderViewer:n.bool,senderName:n.string},render:function(){var p=this.props.attachment;if(!p||!p.target)return null;var q,r=p.target.photo_count;if(this.props.isViewerSender){if(r==1){q=(k._("You synced 1 photo."));}else q=(k._("You synced {photo_count} photos.",[k.param("photo_count",r)]));}else if(r==1){q=(k._("{sender name} synced 1 photo.",[k.param("sender name",this.props.senderName)]));}else q=(k._("{sender name} synced {photo_count} photos.",[k.param("sender name",this.props.senderName),k.param("photo_count",r)]));return (i.createElement("span",{className:"uiIconText _3l6h"},i.createElement(g,{src:l('/images/messaging/docs/generic.png')}),q));}});e.exports=o;},null);
__d("MercuryAudioPlayer",["Event","Arbiter","DOM","Flash","UserAgent_DEPRECATED","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=200;function n(){if(k.webkit()&&!k.chrome())return false;var w=i.create('audio'),x=false;try{if(!!w.canPlayType)if(w.canPlayType('video/mp4;').replace(/^no$/,''))x=true;}finally{return x;}}function o(){return j.isAvailable();}var p=function(){this.interval=null;this.arbiterInstance=null;this.audio=i.create('audio');g.listen(this.audio,'playing',function(){this.informAttachment('playing',this.audio.currentTime);this.interval=setInterval(function(){this.informAttachment('playing',this.audio.currentTime);}.bind(this),m);}.bind(this));g.listen(this.audio,'ended',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};l(p.prototype,{setAudio:function(w,x){this.audio.setAttribute('src',w);this.arbiterInstance=x;},informAttachment:function(w,x){if(this.arbiterInstance)this.arbiterInstance.inform(w,x);},play:function(){this.audio.play();this.informAttachment('played');},resume:function(){this.audio.play();this.informAttachment('played');},pause:function(){this.audio.pause();clearInterval(this.interval);this.informAttachment('paused');},getType:function(){return 'html5';}});var q=function(){this.src=null;this.arbiterInstance=null;var w=i.create('div');document.body.appendChild(w);this.swf=j.embed('/swf/SoundStreamPlayer.swf',w,null,{});this.interval=null;h.subscribe('soundstream/finished',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};l(q.prototype,{setAudio:function(w,x){this.src=w;this.arbiterInstance=x;},informAttachment:function(w,x){if(this.arbiterInstance)this.arbiterInstance.inform(w,x);},play:function(){this.swf.playSound(this.src);this.interval=setInterval(function(){var w=this.swf.getCurrentTime();this.informAttachment('playing',w);}.bind(this),m);this.informAttachment('played');},resume:function(){this.swf.resume();this.informAttachment('played');},pause:function(){clearInterval(this.interval);this.swf.pause();this.informAttachment('paused');},getType:function(){return 'flash';}});function r(){if(n()){return new p();}else if(o())return new q();return false;}var s=null,t=null,u=0;function v(w,x){this.src=w;this.arbiterInstance=x;this.audio_id=++u;s!==null||(s=r());if(!s)return false;}l(v.prototype,{getType:function(){if(!s){return false;}else return s.getType();},play:function(w){if(w&&t==this.audio_id){s.resume();}else{this.pause();t=this.audio_id;s.setAudio(this.src,this.arbiterInstance);s.play();}},pause:function(){s.pause();}});e.exports=v;},null);
__d("MercuryAttachmentAudioClip.react",["Arbiter","ArbiterMixin","MercuryAudioPlayer","CurrentUser","JSLogger","LeftRight.react","MercuryShareAttachmentRenderLocations","React","SubscriptionsHandler","cx","fbt","joinClasses","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=n,u=t.PropTypes,v='MercuryAttachmentAudioClip/play',w=k.create('mercury_audio_clip'),x=n.createClass({displayName:"AudioClip",mixins:[h],propTypes:{duration:u.number,location:u.oneOf(m.getValues()),rootClassName:u.string,showHelp:u.bool,src:u.string.isRequired,width:u.number},getInitialState:function(){this.logged=false;var y=this.props.downloadOnly?false:new i(this.props.src,this);return {time:0,playing:false,started:false,duration:this.props.duration,audioPlayer:y};},componentDidMount:function(){this._subscriptionsHandler=new o();this._subscriptionsHandler.addSubscriptions(this.subscribe('playing',this.updateTime),this.subscribe('played',s(this.setState,this,{playing:true,started:true})),this.subscribe('paused',s(this.setState,this,{playing:false})),this.subscribe('finished',s(this.setState,this,{playing:false,started:false,time:this.props.duration})),g.subscribe(v,function(y,z){if(this.props.src!=z)this.setState({time:0});}.bind(this)));},componentWillUnmount:function(){this._subscriptionsHandler&&this._subscriptionsHandler.release();},updateTime:function(y,z){this.setState({time:z});},play:function(){if(this.state.playing){this.state.audioPlayer.pause();}else{this.state.audioPlayer.play(this.state.started);g.inform(v,this.props.src);if(!this.logged){this.logged=true;w.log('play',{uid:j.getID(),duration:this.props.duration});}}},_formatSeconds:function(y){if(y){y=Math.ceil(y);var z=y%60;if(z<10)z='0'+z;var aa=Math.floor(y/60);return aa+':'+z;}else return null;},_renderPlayer:function(y,z){return (n.createElement("a",{className:"_1miz _2e-1",href:"#",style:{width:y},onClick:this.play},n.createElement("span",{className:"_1mi- _2e-2"},n.createElement("i",{className:"_1mi_ _2e-3"})),n.createElement("span",{className:"_1mj0 _2e-4"},z),n.createElement("div",{className:"_1mj1 _2e-5"})));},render:function(){var y=this.state.time,z=this.state.playing,aa=this._formatSeconds(this.state.duration),ba=this.props.location===m.MESSENGER,ca=this.props.width||170;if(ba){var da=this.props.duration;if(da>10){ca=240;}else if(da>5){ca=200;}else if(da>2){ca=160;}else ca=120;}var ea=null,fa=Math.ceil((y*(ca+2))/this.state.duration);if(ba)fa=Math.ceil((y*(ca+24))/this.state.duration);if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var ga=this._renderPlayer(ca,aa),ha=this._renderPlayer(ca,aa),ia=(("_1mj2")+(' '+"_2e-6")+(z&&(y!==0)?' '+"_1mj3":'')+(z&&(y===0)?' '+"_4g4x":''));ea=(n.createElement("div",{className:ia},ga,n.createElement("div",{className:"_1mj4 _2e-7",style:{width:fa}},ha)));}else ea=(n.createElement("div",{className:"_1mj2"},n.createElement("div",{className:"_1miz"},n.createElement(l,null,n.createElement("a",{className:"_1mj5",href:this.props.src},n.createElement("span",{className:"_3qi6"},n.createElement("i",{className:"_1mj6"})),n.createElement("span",{className:"_1mj7"},q._("Voice Message")),n.createElement("span",{className:"_1mj8"},aa)),n.createElement("a",{href:this.props.src,className:"_1mj9"},n.createElement("i",{className:"_1mja"}))))));return (n.createElement("div",{className:r((("_1mjb")+(ba?' '+"_454y":'')),this.props.rootClassName)},ea));}});e.exports=x;},null);
__d("ChatAnimatedGifs",["URI"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={shouldHideBody:function(i){if(!i.has_attachment)return false;for(var j=0;j<i.attachments.length;j++){var k=i.attachments[j];if(k.preview_url){var l=h.getRawUrlFromSafeUrl(k.preview_url);if(i.body==l)return true;}}return false;},getRawUrlFromSafeUrl:function(i){return new g(i).getQueryData().url;}};e.exports=h;},null);
__d("SyncRequestTitle.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestTitle",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("Waiting for {receiver} to accept your invite to play {app_name}.",[h.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),h.param("app_name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,h._("{sender} wants to play {app_name} with you, right now.",[h.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),h.param("app_name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestAcceptedMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestAcceptedMessage",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("{receiver} accepted your invite to play {app name}.",[h.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,h._("You accepted an invite from {sender} to play {app name}.",[h.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestRejectedMessage.react",["AsyncRequest","Link.react","React","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=i,n=m.PropTypes,o=i.createClass({displayName:"SyncRequestRejectedMessage",propTypes:{requestId:n.string.isRequired,app:n.object.isRequired,isSender:n.bool.isRequired,receiver:n.object.isRequired,sender:n.object.isRequired},render:function(){if(this.props.isSender){return (i.createElement("div",null,l._("{receiver} declined your invite to play {app_name}.",[l.param("receiver",i.createElement("span",{className:"_dg4"},this.props.receiver.name)),l.param("app_name",i.createElement("span",{className:"_dg5"},this.props.app.name))])));}else return (i.createElement("div",null,l._("You declined an invite from {sender} to play {app_name}.",[l.param("sender",i.createElement("span",{className:"_dg4"},this.props.sender.name)),l.param("app_name",i.createElement("span",{className:"_dg5"},this.props.app.name))]),i.createElement("div",{className:"_13n7"},i.createElement("div",null,i.createElement(h,{onClick:this._submitBlockApp},l._("Block {app}",[l.param("app",this.props.app.name)]))),i.createElement("div",null,i.createElement(h,{onClick:this._submitBlockUser},l._("Block requests from {sender}",[l.param("sender",this.props.sender.name)]))))));},_submitBlockApp:function(){var p=new j('/games/block_app/'),q=new g().setURI(p);q.setData({app_id:this.props.app.id,source:'sync_request'});q.send();},_submitBlockUser:function(){var p=new j('/games/block_user/'),q=new g().setURI(p);q.setData({app_id:this.props.app.id,blockee_uid:this.props.sender.id});q.send();}});e.exports=o;},null);
__d("SyncRequestExpiredMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestExpiredMessage",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("{receiver} missed your invite to play {app name}.",[h.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,h._("You missed an invite from {sender} to play {app name}.",[h.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestCanceledMessage.react",["React","cx","fbt"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestCanceledMessage",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,i._("You canceled an invite to {receiver} to play {app name}.",[i.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),i.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,i._("{sender} canceled an invitation to play {app name}.",[i.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),i.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestTimer.react",["React","fbt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g,j=i.PropTypes;function k(m){if(m){m=Math.ceil(m);var n=m%60;if(n<10)n='0'+n;var o=Math.floor(m/60);return o+':'+n;}else return "0:00";}var l=g.createClass({displayName:"SyncRequestTimer",propTypes:{timeRemaining:j.number.isRequired,isSender:j.bool.isRequired,receiverName:j.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("({time_remaining} remaining)",[h.param("time_remaining",k(this.props.timeRemaining))])));}else return (g.createElement("div",null,h._("You have {time_remaining} to accept.",[h.param("time_remaining",k(this.props.timeRemaining))])));}});e.exports=l;},null);
__d("XSyncRequestSubmitController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/platform\/games\/sync_requests\/submit\/",{request_id:{type:"Int",required:true},sender:{type:"Int",required:true},action:{type:"Int",required:true}});},null);
__d("SyncRequest.react",["Arbiter","AsyncRequest","ChannelConstants","React","SyncRequestStatusEnum","SyncRequestTitle.react","SyncRequestAcceptedMessage.react","SyncRequestRejectedMessage.react","SyncRequestExpiredMessage.react","SyncRequestCanceledMessage.react","SyncRequestTimer.react","XUIButton.react","XSyncRequestSubmitController","cx","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=j,x=w.PropTypes,y=j.createClass({displayName:"SyncRequest",propTypes:{app:x.object.isRequired,creationTime:x.number.isRequired,requestId:x.string.isRequired,receiver:x.object.isRequired,sender:x.object.isRequired,status:x.oneOf(v(k)).isRequired,timeout:x.number.isRequired,timeRemaining:x.number.isRequired,viewerId:x.number.isRequired,onStatusUpdate:x.func},componentWillMount:function(){if(this.props.status===k.PENDING){var z=g.subscribe(i.getArbiterType('sync_request_updated'),function(ca,da){da=da.obj;if(da.id.toString()!==this.props.requestId)return;this.setState({status:da.status});}.bind(this));this.setState({statusEvent:z});}var aa=null;if(this.props.status===k.PENDING){var ba=function(){this.setState({time_remaining:(this.state.time_remaining-1)});if(this.state.time_remaining<=0){clearInterval(this.state.counter);var ca={counter:null,time_remaining:0};if(this.state.status===k.PENDING)ca.status=k.EXPIRED;this.setState(ca);}};aa=setInterval(ba.bind(this),1000);}this.setState({time_remaining:this.props.timeRemaining,counter:aa});},componentWillUnmount:function(){if(this.state.counter)clearInterval(this.state.counter);g.unsubscribe(this.state.statusEvent);},getInitialState:function(){return {buttonsDisabled:false,time:Date.now(),status:this.props.status,viewerIsSender:this.props.viewerId===this.props.sender.id};},componentDidUpdate:function(z,aa){if(this.props.status!=k.PENDING)this.state.status=this.props.status;if(this.props.onStatusUpdate)this.props.onStatusUpdate(this.state.status,aa.status);},render:function(){var z;switch(this.state.status){case k.PENDING:var aa;if(!this.state.viewerIsSender){aa=[j.createElement(r,{use:"confirm",onClick:this._handleAccept,disabled:this.state.buttonsDisabled,label:u._("Accept")}),j.createElement(r,{use:"default",onClick:this._handleReject,disabled:this.state.buttonsDisabled,label:u._("Decline")})];}else aa=j.createElement(r,{use:"default",onClick:this._handleCancel,disabled:this.state.buttonsDisabled,label:u._("Cancel")});z=(j.createElement("div",null,j.createElement("div",{className:"_372m"},j.createElement(l,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name})),j.createElement("div",{className:"_372n"},j.createElement(q,{isSender:this.state.viewerIsSender,timeRemaining:this.state.time_remaining,receiverName:this.props.receiver.name})),j.createElement("div",{className:"_372o"},aa)));break;case k.ACCEPTED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(m,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case k.REJECTED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(n,{requestId:this.props.requestId,app:this.props.app,isSender:this.state.viewerIsSender,receiver:this.props.receiver,sender:this.props.sender}));break;case k.EXPIRED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(o,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case k.CANCELED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(p,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;default:throw new Error('The request status `%s` is unknown.',this.state.status);}return (j.createElement("div",{className:"_372q"},z));},_handleAccept:function(){this._handleStatusUpdate(k.ACCEPTED);var z=window.open(this.props.app.uri);if(z)z.focus();},_handleReject:function(){this._handleStatusUpdate(k.REJECTED);},_handleCancel:function(){this._handleStatusUpdate(k.CANCELED);},_handleStatusUpdate:function(z){this.setState({status:z,buttonsDisabled:true});var aa=s.getURIBuilder().setInt('request_id',this.props.requestId).setInt('sender',this.props.sender.id).setInt('action',z).getURI();new h().setURI(aa).setHandler(function(ba){this.setState({status:z});}.bind(this)).setErrorHandler(function(ba){this.setState({buttonsDisabled:false});}.bind(this)).send();}});e.exports=y;},null);
__d("MercuryViewer",["CurrentUser","MercuryAssert"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i='fbid:'+g.getID(),j={getID:function(){return i;},isViewer:function(k){h.isParticipantID(k);return k===i;}};e.exports=j;},null);
__d("MercuryMessageInfo",["MercuryActionStatus","MercuryViewer"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={isOutbound:function(j){return j.author===h.getID();},isInbound:function(j){return !i.isOutbound(j);},isSending:function(j){return (j.status===g.UNSENT||j.status===g.UNCONFIRMED||j.status===g.UNABLE_TO_CONFIRM||j.status===g.RESENDING);},hasError:function(j){return (j.status===g.FAILED_UNKNOWN_REASON||j.status===g.UNABLE_TO_CONFIRM||j.status===g.ERROR);}};e.exports=i;},null);
__d("MercuryAttachmentPhoto.react",["Bootloader","ChatImageArrowDirection","ChatImageWithArrow.react","MercuryMessageInfo","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=k,n=m.PropTypes,o=k.createClass({displayName:"MercuryAttachmentPhoto",propTypes:{height:n.number,image:n.object.isRequired,message:n.object.isRequired,width:n.number},_handleClickPicture:function(p){var q=this.props.image;g.loadModules(["MessagesViewer"],function(r){r.bootstrapWithConfig({src:q.preview_url,endpoint:q.url,fbid:q.metadata.fbid,dimensions:q.metadata.dimensions,disablePaging:true},null);});},render:function(){var p=j.isInbound(this.props.message);return (k.createElement("div",{className:"_1rqb"},k.createElement(i,{arrowDirection:p?h.LEFT:h.RIGHT,source:this.props.image.preview_url,height:this.props.height,width:this.props.width,onClick:this._handleClickPicture,isLoading:!!this.props.image.preview_uploading})));}});e.exports=o;},null);
__d("ChatGridImage.react",["Link.react","React","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=h,k=j.PropTypes,l=h.createClass({displayName:"ChatGridImage",propTypes:{isLoading:k.bool,onClick:k.func,size:k.number.isRequired,source:k.string},render:function(){if(this.props.isLoading)return (h.createElement("div",{className:"_4ypb",style:{width:this.props.size,height:this.props.size}}));return (h.createElement(g,{onClick:this.props.onClick},h.createElement("div",{className:"_332l",style:{backgroundImage:'url('+this.props.source+')',width:this.props.size,height:this.props.size}})));}});e.exports=l;},null);
__d("MercuryAttachmentPhotoGrid.react",["Bootloader","ChatGridImage.react","ChatImageArrowDirection","ChatImageWithArrow.react","Grid.react","MercuryAttachmentType","MercuryMessageInfo","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=k.GridItem,q=n,r=q.PropTypes,s=n.createClass({displayName:"MercuryAttachmentPhotoGrid",propTypes:{images:r.arrayOf(r.object).isRequired,size:r.number.isRequired,message:r.object.isRequired},_generateClickHandler:function(t){var u=this.props.images.some(function(v){return v.attach_type===l.ANIMATED_IMAGE;});return (function(v){g.loadModules(["MessagesViewer"],function(w){w.bootstrapWithConfig({src:t.preview_url,endpoint:t.url,fbid:t.metadata.fbid,dimensions:t.metadata.dimensions,disablePaging:u},null);});});},render:function(){var t=this.props.images,u=t.length,v=(u==2||u==4)?2:3,w=Math.floor(this.props.size/v),x=m.isInbound(this.props.message),y=x?0:v-1,z=[];for(var aa=0;aa<t.length;aa++)if(aa===y){z.push(n.createElement(p,{key:aa},n.createElement(j,{arrowDirection:x?i.LEFT:i.RIGHT,source:t[aa].preview_url,height:w,width:w,isLoading:!!t[aa].preview_uploading,onClick:this._generateClickHandler(t[aa])})));}else z.push(n.createElement(p,{key:aa},n.createElement(h,{isLoading:!!t[aa].preview_uploading,onClick:this._generateClickHandler(t[aa]),size:w,source:t[aa].preview_url})));return (n.createElement(k,{cols:v,className:"_5b2w",spacing:"_5b2x",alignh:"right"},z));}});e.exports=s;},null);
__d("OrderedFriendsList",["AvailableListConstants","PresenceStatus","SearchableEntry","ShortProfiles","WorkModeConfig","createArrayFromMixed","isValidUniqueID","InitialChatFriendsList"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=[],o=[],p={},q=[],r={},s=[],t={contains:function(u){return u in p;},getList:function(){if(k.is_work_user)return l(n);t.reRank();var u=l(n);u=u.filter(function(v){var w=j.getNowUnsafe(v);return !w||w.type=="friend";});return u;},getSearchableEntries:function(u,v){var w=t.getList();j.getMulti(w.slice(0,u),function(x){var y=[];for(var z in x)y.push(t.normalizeProfileEntry(x[z]));var aa=t.getGroups().map(t.normalizeThreadEntry);v(y.concat(aa).filter(function(ba){return !!ba;}).sort(function(ba,ca){return ba.getOrder()-ca.getOrder();}));});},normalizeProfileEntry:function(u){var v=u.searchTokens||[];return new i({uniqueID:u.id,keywordString:v.join(' '),order:t.getRank(u.id),photo:u.thumbSrc,title:u.name,type:u.type,uri:u.uri,auxiliaryData:{isMessengerUser:u.is_messenger_user}});},normalizeThreadEntry:function(u,v){var w=u.mercury_thread,x=u.participants_to_render,y=u.text,z=null;if(!y)y=w.name;var aa=x.map(function(ca){return ca.name;}).join(', ');if(!y){y=aa;}else z=aa;var ba=u.uid;if(!y||!m(ba))return null;return new i({uniqueID:ba,order:v,photo:w.image_src,title:y,subtitle:z,type:'thread',auxiliaryData:{participantsToRender:x,thread:w}});},getRank:function(u){return u in p?p[u]:n.length;},getActiveList:function(){if(q.length>0)return q;return t.getList();},getActiveRank:function(u){return u in r?r[u]:t.getRank(u);},reRank:function(){n=[];var u=0;s.forEach(function(v){var w=v.slice(0,-2),x=v.slice(-1);if(h.get(w)==x){n[u]=w;p[w]=u++;}});},rankActive:function(){var u=0;s.forEach(function(v){var w=v.slice(0,-2),x=v.slice(-1);if(x==g.ACTIVE){q[u]=w;r[w]=u++;}});},getGroups:function(){return o;}};(function(){var u=b('InitialChatFriendsList');n=u.list.length?u.list:[];o=u.groups||[];if(!k.is_work_user){s=n.slice();t.rankActive();t.reRank();}else n.forEach(function(v,w){p[v]=w;});})();e.exports=a.OrderedFriendsList||t;},null);
__d("ChatSortUsers",["AvailableListConstants","OrderedFriendsList","PresencePrivacy","PresenceStatus","ShortProfiles","TokenizeUtil"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(q,r){var s=i.allows(q),t=i.allows(r);if(s!==t)return s?-1:1;return 0;}var n={};function o(q){if(n[q])return n[q];var r=(k.getNowUnsafe(q)||{}).name;if(r)return n[q]=l.flatten(r);return '~';}var p={sortAlphabetical:function(q,r){var s=o(q),t=o(r);if(s!==t)return s<t?-1:1;return 0;},sortMobile:function(q,r){var s=j.get(q)===g.MOBILE,t=j.get(r)===g.MOBILE;if(s!==t)return t?-1:1;return p.sortAlphabetical(q,r);},sortCoefficient:function(q,r){var s=h.getRank(q),t=h.getRank(r);if(s!==t)return s-t;return p.sortAlphabetical(q,r);},sort:function(q,r){var s=m(q,r);if(s!==0)return s;return p.sortCoefficient(q,r);}};e.exports=p;},null);
__d("ChatMiniSidebarSearchSource",["AbstractSearchSource","AsyncRequest","ChatSortUsers","CurrentUser","MercuryParticipantTypes","OrderedFriendsList","SearchableEntry","SearchSourceCallbackManager","ShortProfiles","TokenizeUtil","copyProperties","emptyFunction","isValidUniqueID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();'use strict';for(var t in g)if(g.hasOwnProperty(t))v[t]=g[t];var u=g===null?null:g.prototype;v.prototype=Object.create(u);v.prototype.constructor=v;v.__superConstructor__=g;function v(w){this.$ChatMiniSidebarSearchSource0=new n({parseFn:p.parse,matchFn:p.isQueryMatch,indexFn:w.indexFn});this.$ChatMiniSidebarSearchSource1=[];this.$ChatMiniSidebarSearchSource2=w.queryRequests||[];this.$ChatMiniSidebarSearchSource3=false;}v.prototype.bootstrapImpl=function(w){o.fetchAll().then(function(){this.$ChatMiniSidebarSearchSource3=true;this.$ChatMiniSidebarSearchSource4();w();}.bind(this));};v.prototype.searchImpl=function(w,x,y){var z=null,aa={},ba=y&&y.onQueryFinished,ca=y&&y.onQueryStarted;ca&&ca(w);var da=this.$ChatMiniSidebarSearchSource0.search(w,function(ga){if(!z){z=ga;z.forEach(function(ha){return aa[ha.getUniqueID()]=true;});}else ga.forEach(function(ha){var ia=ha.getUniqueID();if(!aa[ia]){z.push(ha);aa[ia]=true;}});x(z,w);if(w.length===1&&this.$ChatMiniSidebarSearchSource3)ba&&ba(w);}.bind(this),y);if(!da||!this.$ChatMiniSidebarSearchSource2||!this.$ChatMiniSidebarSearchSource2.length||w.length===0){ba&&ba(w);return;}if(w.length===1){if(this.$ChatMiniSidebarSearchSource3)ba&&ba(w);return;}var ea={value:w,existing_ids:z&&z.map(function(ga){return ga.getUniqueID();}).join(','),needs_friends:!this.$ChatMiniSidebarSearchSource3,limit:y&&y.threadLimit},fa=this.$ChatMiniSidebarSearchSource2.length;this.$ChatMiniSidebarSearchSource2.forEach(function(ga){this.$ChatMiniSidebarSearchSource5(ea,ga,function(ha){this.$ChatMiniSidebarSearchSource6(this.$ChatMiniSidebarSearchSource7(this.$ChatMiniSidebarSearchSource8(ha)),w);fa--;if(fa===0){this.$ChatMiniSidebarSearchSource0.setQueryStringAsExhausted(w);ba&&ba(w);}}.bind(this));}.bind(this),this);};v.prototype.getBootstrappedEntries=function(w){return this.bootstrap(function(){return w(this.$ChatMiniSidebarSearchSource1||[]);}.bind(this));};v.prototype.getAllEntriesMap=function(){return this.$ChatMiniSidebarSearchSource0.getAllEntries();};v.prototype.$ChatMiniSidebarSearchSource4=function(){var w=o.getCachedProfileIDs(),x=w.filter(function(z){var aa=o.getNow(z);return (z==j.getID()||aa.type===k.FRIEND);});x.sort(i.sort);var y=x.map(this.$ChatMiniSidebarSearchSource9);this.$ChatMiniSidebarSearchSource0.addLocalEntries(y);if(y.length)this.$ChatMiniSidebarSearchSource1=this.$ChatMiniSidebarSearchSource1.concat(y);};v.prototype.$ChatMiniSidebarSearchSource7=function(w){return w.map(this.$ChatMiniSidebarSearchSourcea,this);};v.prototype.$ChatMiniSidebarSearchSourcea=function(w,x){if(w.mercury_thread)return l.normalizeThreadEntry(w,x);var y=w.text,z=w.uid;if(!y||!s(z))return null;return new m({uniqueID:z,title:y,order:l.getActiveRank(z),subtitle:w.subtext,type:w.render_type||w.type,photo:w.photo,uri:w.path,auxiliaryData:{isMessengerUser:w.is_messenger_user}});};v.prototype.$ChatMiniSidebarSearchSource8=function(w){var x=w.getPayload();if(Array.isArray(x)){return x;}else if(x&&x.entries){return x.entries;}else return [];};v.prototype.$ChatMiniSidebarSearchSource9=function(w,x){var y=o.getNow(w),z=w==j.getID()?k.FRIEND:y.type,aa=[y.additionalName,y.alternateName].concat(y.searchTokens||[]).join(' ');return new m({uniqueID:w,title:y.name,order:x,subtitle:y.additionalName,keywordString:aa,type:z,photo:y.thumbSrc,uri:y.uri,auxiliaryData:{isMessengerUser:y.is_messenger_user}});};v.prototype.$ChatMiniSidebarSearchSource5=function(w,x,y,z){new h(x.uri).setData(q({},w,x.data)).setMethod('GET').setReadOnly(true).setHandler(y).setErrorHandler(z||r).setAllowCrossPageTransition(true).send();};v.prototype.$ChatMiniSidebarSearchSource6=function(w,x){if(w.length)this.$ChatMiniSidebarSearchSource0.addQueryEntries(w,x);};v.prototype.addLocalEntries=function(w){this.$ChatMiniSidebarSearchSource0.addLocalEntries(w);};v.prototype.refreshData=function(){o.fetchAll();d(['AvailableList'],function(w){return w.update();});};e.exports=v;},null);
__d("ChatTypeaheadConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={USER_TYPE:'user',THREAD_TYPE:'thread',FRIEND_TYPE:'friend',NON_FRIEND_TYPE:'non_friend',FB4C_TYPE:'fb4c',PAGE_TYPE:'page',HEADER_TYPE:'header'};e.exports=g;},null);
__d("SplitImage.react",["React","Image.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g.createClass({displayName:"SplitImage",render:function(){var l=this.props.size;return (g.createElement("div",g.__spread({},this.props,{className:j(this.props.className,"_55lt"),style:Object.assign({},(this.props.style||{}),{width:l,height:l})}),this.renderImages()));},renderImages:function(){if(!this.props.srcs)return null;var l=this.props.srcs,m=Array.isArray(l);if(!m||l.length==1)return this.renderOne(m?l[0]:l);return l.length==2?this.renderTwo(l):this.renderThree(l);},renderOne:function(l){return (g.createElement(h,{src:l,width:this.props.size,height:this.props.size,alt:""}));},renderTwo:function(l){var m=this.props.size,n=Math.floor(m/2),o=-Math.floor(n/2),p=(("_55lu")+(this.props.border?' '+"_57xo":''));return (g.createElement("div",null,g.createElement("div",{className:"_55lu",style:{width:n}},g.createElement(h,{src:l[0],width:m,height:m,style:{marginLeft:o}})),g.createElement("div",{className:p,style:{width:n}},g.createElement(h,{src:l[1],width:m,height:m,style:{marginLeft:o}}))));},renderThree:function(l){var m=this.props.size,n=Math.floor(m/3*2),o=-Math.floor((m-n)/2),p=Math.floor(m/2),q=m-n,r=-Math.floor((p-q)/2),s=(("_55lu")+(this.props.border?' '+"_57pl":'')),t=(("_55lu")+(this.props.border?' '+"_57pm":''));return (g.createElement("div",null,g.createElement("div",{className:s,style:{width:n}},g.createElement(h,{src:l[0],width:m,height:m,style:{marginLeft:o}})),g.createElement("div",{className:t,style:{width:q,height:p}},g.createElement(h,{src:l[1],width:p,height:p,style:{marginLeft:r}})),g.createElement("div",{className:"_55lu",style:{width:q,height:p}},g.createElement(h,{src:l[2],width:p,height:p,style:{marginLeft:r}}))));}});e.exports=k;},null);
__d("MercuryErrorInfo",["MercuryErrorType","MercuryMessageInfo","fbt"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={getMessage:function(k){var l='';if(j.isConnectionError(k)){l=i._("This message didn't send.");if(j.isTransient(k))l=i._("{message} Check your internet connection and click to try again.",[i.param("message",l)]);}else{if(k&&k.description){l=k.description;}else l=i._("This message failed to send.");if(j.isTransient(k))l=i._("{message} Click to send again.",[i.param("message",l)]);}return l;},isConnectionError:function(k){if(k&&k.type==g.TRANSPORT)return k.code===1001||k.code===1004||k.code===1006;return false;},isTransient:function(k){return k&&k.is_transient;},isPermanent:function(k){return k?!this.isTransient(k):false;},hasErrorStatus:function(k){return h.hasError(k);}};e.exports=j;},null);
__d("MercuryThreadMetadataRawRenderer",["Event","CSS","DOM","MercuryActionStatus","MercuryErrorInfo","MercuryStatusTemplates","Tooltip","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p={renderParticipantListWithNoThreadName:function(q,r,s,t,u,v){var w={callback:true,check_length:true,show_unread_count:true};v=v||{};var x={};for(var y in v)if(w[y]){x[y]=v[y];delete v[y];}var z=s.map(function(ea){return t[ea];}),aa=this.renderRawParticipantList(q,z,s.length,v);aa=this.renderRawTitleWithUnreadCount(aa,x.show_unread_count?r.unread_count:0);var ba=v.abbr_mode,ca={};for(var da in v)ca[da]=v[da];ca.abbr_mode=true;u.forEach(function(ea){var fa=u.length>1?this._cloneIfDOMElement(aa):aa;i.setContent(ea,fa);if(x.check_length&&!ba&&ea.scrollWidth>ea.clientWidth){var ga=this.renderRawParticipantList(q,z,s.length,ca),ha=this.renderRawTitleWithUnreadCount(ga,x.show_unread_count?r.unread_count:0);i.setContent(ea,ha);}}.bind(this));x.callback&&x.callback(aa);},renderRawParticipantList:function(q,r,s,t){var u={abbr_mode:true,last_separator_uses_and:true,names_renderer:true};t=t||{};var v=null;if(t.names_renderer){v=t.names_renderer(r);}else v=r.map(function(x){return x.name;});var w=null;if(v.length===0){if(!q){w=o._("New Message");}else w=o._("No Participants");}else if(v.length==1){w=v[0];}else if(v.length==2){if(t.last_separator_uses_and){w=o._("{participant1} and {participant2}",[o.param("participant1",v[0]),o.param("participant2",v[1])]);}else w=o._("{participant1}, {participant2}",[o.param("participant1",v[0]),o.param("participant2",v[1])]);}else if(t.last_separator_uses_and){if(t.abbr_mode){w=o._("{participant1} and {others_link}",[o.param("participant1",v[0]),o.param("others_link",this.renderRawParticipantCount({render_subset:true,count:s-1}))]);}else if(v.length==3){w=o._("{participant1}, {participant2} and {participant3}",[o.param("participant1",v[0]),o.param("participant2",v[1]),o.param("participant3",v[2])]);}else w=o._("{participant1}, {participant2} and {others_link}",[o.param("participant1",v[0]),o.param("participant2",v[1]),o.param("others_link",this.renderRawParticipantCount({render_subset:true,count:s-2}))]);}else if(v.length==3){w=o._("{participant1}, {participant2}, {participant3}",[o.param("participant1",v[0]),o.param("participant2",v[1]),o.param("participant3",v[2])]);}else w=o._("{participant1}, {participant2}, {participant3}, {others_link}",[o.param("participant1",v[0]),o.param("participant2",v[1]),o.param("participant3",v[2]),o.param("others_link",this.renderRawParticipantCount({render_subset:true,count:s-3}))]);if(Array.isArray(w))w=i.create('span',{},w);return w;},renderRawTitleWithUnreadCount:function(q,r){var s=q;if(r&&r>1)s=i.create('span',{},o._("{conversation_title} ({unread_count})",[o.param("conversation_title",q),o.param("unread_count",r)]));return s;},renderRawParticipantCount:function(q){var r=q.render_subset,s;if(!r){s=q.count>1?o._({"*":"{num} people"},[o.param("num",q.count,[0])]):o._("1 person");}else s=q.count>1?o._({"*":"{others_count} others"},[o.param("others_count",q.count,[0])]):o._("1 other");return s;},renderShortNames:function(q){if(q.length==1)return [q[0].name];return q.map(function(r){return r.short_name;});},renderStatusIndicator:function(q,r,s){var t;if(q==j.RESENDING){t=this.renderResendIndicator();}else if(q!==(void 0)&&q!=j.UNSENT&&q!=j.UNCONFIRMED&&q!=j.SUCCESS)t=this.renderErrorIndicator(r,s);return t;},renderResendIndicator:function(){return l[':fb:mercury:resend-indicator'].render();},renderErrorIndicator:function(q,r){if(!q)return null;var s=l[':fb:mercury:error-indicator'].render(),t=q.is_transient,u=k.getMessage(q);if(t)if(k.isConnectionError(q)){u=o._("{message} Check your internet connection and click to try again.",[o.param("message",u)]);}else u=o._("{message} Click to send again.",[o.param("message",u)]);m.set(s,u,'above','center');if(r&&t){g.listen(s,'click',r);s.setAttribute('tabindex','0');h.addClass(s,"_55q-");}return s;},_cloneIfDOMElement:function(q){if(q&&q.cloneNode){return q.cloneNode();}else return q;}};e.exports=p;},null);
__d("MessagingRecipientTypeaheadItem.react",["BackgroundImage.react","ChatTypeaheadConstants","ImageBlock.react","LeftRight.react","React","SplitImage.react","MercuryThreadMetadataRawRenderer","TypeaheadViewItem","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=k,r=q.PropTypes,s=k.createClass({displayName:"MessagingRecipientTypeaheadItem",propTypes:Object.assign({},n.propTypes,{imageSize:r.number.isRequired}),mixins:[n.Mixin],isThreadRecipient:function(){return this.props.entry.getType()===h.THREAD_TYPE;},_getImage:function(){var t=this.props.entry;if(t.getType()===h.THREAD_TYPE&&!t.getPhoto()){var u=t.getAuxiliaryData();return (k.createElement(l,{size:this.props.imageSize,srcs:u.participantsToRender.map(function(v){return v.image_src;})}));}if(t.getPhoto())return (k.createElement(g,{width:this.props.imageSize,height:this.props.imageSize,backgroundSize:"cover",src:t.getPhoto()}));return k.createElement("span",null);},_getThreadParticipantList:function(){if(!this.isThreadRecipient())return null;var t=this.props.entry;return m.renderRawParticipantList(t.getUniqueID(),t.getAuxiliaryData().participantsToRender,t.getAuxiliaryData().thread.participants.length-1,{names_renderer:m.renderShortNames});},_getTitle:function(){var t=this.props.entry;if(this.isThreadRecipient()&&!t.getTitle())return this._getThreadParticipantList();return t.getTitle();},_getSubtitle:function(){var t=this.props.entry;if(this.isThreadRecipient()&&!t.getTitle())return this._getThreadParticipantList();return t.getSubtitle()?t.getSubtitle().split(' \u00b7 ')[0]:null;},render:function(){var t=this._getSubtitle(),u=p((("_599m")+(' '+"_55xn")+(!t?' '+"_5mne":'')+(this.props.highlighted?' '+"_599n":'')),this.props.className);return (k.createElement("li",{"aria-selected":this.props.selected,className:u,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight,role:this.props.role},k.createElement(i,{spacing:"medium"},this._getImage(),k.createElement(j,null,k.createElement("div",null,k.createElement("div",{className:"_55xt _599p"},this._getTitle()),k.createElement("div",{className:"_55z3 _599q"},t)),this.props.children))));}});e.exports=s;},null);
__d("MessagingRecipientSelectedList.react",["Image.react","LeftRight.react","Map","MessagingRecipientTypeaheadItem.react","React","cx","fbt","xuiglyph"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=k,p=o.PropTypes,q=k.createClass({displayName:"MessagingRecipientSelectedList",propTypes:{entries:p.instanceOf(i),onSelect:p.func.isRequired},_renderSelectedEntry:function(r){var s=n({name:'cross',shade:'dark',size:'small'});return (k.createElement(j,{key:r.getUniqueID(),entry:r,imageSize:24,onSelect:this.props.onSelect},k.createElement(g,{className:"_1jm4",src:s})));},render:function(){var r=(m._("Send to:")),s=[];this.props.entries.forEach(function(t){return s.push(this._renderSelectedEntry(t));}.bind(this));return (k.createElement("div",{className:"_1jm5"},k.createElement(h,{className:"_1jm6 _2ph-"},k.createElement("span",null,r),k.createElement("span",null,this.props.entries.size)),k.createElement("ul",null,s)));}});e.exports=q;},null);
__d("MessagingRecipientTypeaheadView.react",["CenteredContainer.react","Link.react","Map","MessagingRecipientTypeaheadItem.react","React","TypeaheadViewPropTypes","XUISpinner.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=k,q=p.PropTypes,r=32,s=k.createClass({displayName:"MessagingRecipientTypeaheadView",propTypes:Object.assign({},l,{selectedEntries:q.instanceOf(i),loading:q.bool}),getDefaultProps:function(){return {role:'listbox'};},_renderItem:function(t){var u=t===this.props.highlightedEntry,v=this.props.selectedEntries.has(t.getUniqueID());return (k.createElement(j,{key:t.getUniqueID(),entry:t,highlighted:u,imageSize:r,selected:v,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight},k.createElement(h,{"aria-checked":v,className:(("_2i83")+(v?' '+"_2i85":'')+(!v?' '+"_2i86":'')),href:"#",role:"checkbox",tabIndex:"0"})));},render:function(){if(this.props.entries.length===0&&!this.props.loading)return (k.createElement(g,{className:"_2pi1"},o._("No results")));return (k.createElement("ul",{id:this.props.ariaOwneeID,className:"_51do",role:this.props.role},this.props.entries.map(this._renderItem),k.createElement("div",{className:"_51dq"},this.props.loading?k.createElement(m,null):null)));}});e.exports=s;},null);
__d("XMessagingForwardAttachmentController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/mercury\/attachments\/forward\/",{});},null);
__d("MessagingForwardAttachmentDialog.react",["AsyncRequest","ChatMiniSidebarSearchSource","Image.react","LayerFadeOnHide","Layout.react","Map","MessagingRecipientSelectedList.react","MessagingRecipientTypeaheadView.react","OrderedFriendsList","React","SearchableTextInput.react","ScrollableArea.react","XMessagingForwardAttachmentController","XUIDialog.react","XUIDialogBody.react","XUIDialogButton.react","XUIDialogCancelButton.react","XUIDialogFooter.react","XUIDialogTitle.react","XUISpinner.react","cx","fbt","xuiglyph"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();var da=k.Column,ea=k.FillColumn,fa=p,ga=fa.PropTypes,ha=p.createClass({displayName:"MessagingForwardAttachmentDialog",propTypes:{attachmentID:ga.string.isRequired,onClose:ga.func,shown:ga.bool.isRequired,title:ga.string.isRequired},getInitialState:function(){return {bootstrappedEntries:[],entries:[],loading:true,selectedEntries:new l(),sendError:null,sending:false,startingThreadingID:Date.now(),query:''};},componentDidMount:function(){this._dataSource=new h({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});o.getSearchableEntries(20,function(ia){this.setState({bootstrappedEntries:ia,loading:false});}.bind(this));},_onSelectEntry:function(ia){var ja=ia.getUniqueID(),ka=new l(this.state.selectedEntries);if(ka.has(ja)){ka["delete"](ja);}else ka.set(ja,ia);this.setState({selectedEntries:ka});},_onSearchChange:function(ia){var ja=ia.target.value;this.setState({loading:true,query:ja});},_onSearchEntriesFound:function(ia){this.setState({entries:ia});},_onSearchFinished:function(ia){ia===this.state.query&&this.setState({loading:false});},_onSubmit:function(){var ia={},ja=this.state.startingThreadingID;this.state.selectedEntries.forEach(function(la){ia[ja++]=la.getUniqueID();});var ka=s.getURIBuilder().getURI();new g(ka).setMethod('POST').setHandler(this._onSubmitResponse).setData({attachment_id:this.props.attachmentID,recipient_map:ia}).send();this.setState({sending:true,sendError:null});},_onSubmitResponse:function(ia){if(ia.payload.success){this.props.onClose&&this.props.onClose();this.setState({bootstrappedEntries:[],selectedEntries:new l(),sending:false,startingThreadID:Date.now(),query:''});return;}this.setState({sending:false,sendError:ia.payload.error});},_onToggle:function(ia){if(!ia)this.props.onClose();},render:function(){var ia=(ba._("Send")),ja=null;if(this.state.sending){ja=(p.createElement("div",null,p.createElement(z,null),p.createElement("span",{className:"_5s0d _3-99"},ba._("Sending"))));}else if(this.state.sendError){var ka=ca({name:'error-solid',shade:'dark',size:'medium'});ja=(p.createElement("div",{className:"_5s0d"},p.createElement(i,{src:ka}),p.createElement("span",{className:"_3-99"},this.state.sendError)));}var la=(ba._("Search for people and groups"));return (p.createElement(t,{shown:this.props.shown,behaviors:{LayerFadeOnHide:j},onToggle:this._onToggle,width:560},p.createElement(y,null,this.props.title),p.createElement(u,{useCustomPadding:true},p.createElement(k,null,p.createElement(da,{className:"_5s0e"},p.createElement("div",{className:"_2ph_"},p.createElement(q,{className:"_5s0f autofocus",onChange:this._onSearchChange,onEntriesFound:this._onSearchEntriesFound,placeholder:la,queryString:this.state.query,searchSource:this._dataSource,searchSourceOptions:{onQueryFinished:this._onSearchFinished}})),p.createElement(r,{className:"_5s0g",height:400,width:360},p.createElement(n,{entries:this.state.query?this.state.entries:this.state.bootstrappedEntries,loading:this.state.loading,selectedEntries:this.state.selectedEntries,onSelect:this._onSelectEntry}))),p.createElement(ea,{className:"_5s0h"},p.createElement(r,{height:457,shadow:false},p.createElement(m,{entries:this.state.selectedEntries,onSelect:this._onSelectEntry}))))),p.createElement(x,{leftContent:ja},p.createElement(w,{onClick:this.props.onClose}),p.createElement(v,{use:"confirm",disabled:!this.state.selectedEntries.size||this.state.sending,label:ia,onClick:this._onSubmit}))));}});e.exports=ha;},null);
__d("Spotlight.react",["LayerHideOnBlur","LayerHideOnEscape","ReactLayer","Spotlight"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=i.createClass({getDefaultEnabledBehaviors:function(){return {hideOnBlur:g,hideOnEscape:h};},createLayer:function(l){var m=this.enumerateBehaviors(this.props.behaviors),n={addedBehaviors:m,rootClassName:this.props.rootClassName},o=new j(n,l);o.conditionShow(this.props.shown);if(this.props.onBeforeHide)o.subscribe('beforehide',this.props.onBeforeHide);if(this.props.onHide)o.subscribe('hide',this.props.onHide);return o;},receiveProps:function(l){this.layer.conditionShow(l.shown);}});e.exports=k;},null);
__d("SpotlightViewer",["React","ReactLayeredComponentMixin","Spotlight.react","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g.createClass({displayName:"SpotlightViewer",mixins:[h],renderLayers:function(){if(!this.props.open)return null;var l="_n3";if(this.props.className)l+=' '+this.props.className;return {photoLayer:g.createElement(i,{onBeforeHide:this.props.onBeforeHide,onHide:this.props.onHide,rootClassName:this.props.rootClassName,shown:this.props.open},g.createElement("div",{className:l,onClick:this.props.onClick},this.props.children))};},render:function(){return (g.createElement("div",null));}});e.exports=k;},null);
__d("SpotlightViewerAutoResize",["Event","SubscriptionsHandler","invariant"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this.$SpotlightViewerAutoResize0=k;i(typeof this.$SpotlightViewerAutoResize0.onResize==='function');}j.prototype.enable=function(){"use strict";this.$SpotlightViewerAutoResize1=new h();this.$SpotlightViewerAutoResize1.addSubscriptions(g.listen(window,'resize',this.$SpotlightViewerAutoResize0.onResize));};j.prototype.disable=function(){"use strict";this.$SpotlightViewerAutoResize1.release();delete this.$SpotlightViewerAutoResize1;};e.exports=j;},null);
__d("SpotlightViewerBehaviorsMixin",["BehaviorsMixin","copyProperties"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={componentWillMount:function(){this.behaviors&&this.enableBehaviors(this.behaviors);},componentWillUnmount:function(){this.destroyBehaviors();}};h(i,g);e.exports=i;},null);
__d("SpotlightViewerBottomBar",["LeftRight.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=h.createClass({displayName:"SpotlightViewerBottomBar",render:function(){var l=Array.isArray(this.props.children)?this.props.children:[this.props.children],m="_4_8n _51an";if(this.props.className)m=j(m,this.props.className);if(l.length===1)return (h.createElement("div",{className:m},l[0]));m=j(m,"_50-m");return (h.createElement(g,{className:m},l[0],l[1]));}});e.exports=k;},null);
__d("SpotlightViewerBottomBarGroup",["React","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g.createClass({displayName:"SpotlightViewerBottomBarGroup",render:function(){var j=this.props.itemmargin||'right',k=((j=='left'?"marginLeft":'')+(j=='right'?' '+"marginRight":'')+(' '+"_4_8i"));return (g.createElement("div",{className:k},this.props.children));}});e.exports=i;},null);
__d("SpotlightViewerBottomBarLink",["Link.react","React","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=h.createClass({displayName:"SpotlightViewerBottomBarLink",render:function(){return (h.createElement(g,h.__spread({},this.props,{className:"_4_8j _4_8k"}),this.props.children));}});e.exports=j;},null);
__d("SpotlightViewerPagers",["LeftRight.react","Link.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=i.createClass({displayName:"SpotlightViewerPagers",render:function(){return (i.createElement(g,null,i.createElement(h,{className:"_4-oa _4-ob _50-m"}),i.createElement(h,{className:"_4-oa _4-oc _50-m"})));}});e.exports=k;},null);
__d("SpotlightViewerPageWithKeys",["KeyEventController","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this.$SpotlightViewerPageWithKeys0=j;}i.prototype.enable=function(){"use strict";this.$SpotlightViewerPageWithKeys1=new h();this.$SpotlightViewerPageWithKeys1.addSubscriptions(g.registerKey('LEFT',function(){this.$SpotlightViewerPageWithKeys0.viewState.backward();return false;}.bind(this)),g.registerKey('RIGHT',function(){this.$SpotlightViewerPageWithKeys0.viewState.forward();return false;}.bind(this)));};i.prototype.disable=function(){"use strict";this.$SpotlightViewerPageWithKeys1.release();delete this.$SpotlightViewerPageWithKeys1;};e.exports=i;},null);
__d("SpotlightViewerThumbnailMixin",["PhotoStore","Vector"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={_getInitialPhotoData:function(){var j=g.getIndexForID(this.props.setid,this.props.photoid),k=g.getByIndexImmediate(this.props.setid,j);return k?k:this._getThumbnailPhotoData();},_getThumbnailPhotoData:function(){if(!this.props.dimensions||!this.props.thumbsrc)return null;var j={id:this.props.photoid};for(var k=0;k<this.props.dimensions.length;++k){var l=h.deserialize(this.props.dimensions[k]);j['image'+k]={width:l.x,height:l.y,uri:this.props.thumbsrc};}return j;}};e.exports=i;},null);
__d("XMessagingPhotoDownloadController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/mercury\/attachments\/photo\/",{photo_id:{type:"String",required:true}});},null);
__d("SpotlightMessagesViewer",["ArbiterMixin","MercuryConfig","MessagingForwardAttachmentDialog.react","PageTransitions","React","ReactLayeredComponentMixin","SpotlightViewer","SpotlightViewerAutoResize","SpotlightViewerBehaviorsMixin","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerClose","SpotlightViewerCoreMixin","SpotlightViewerDimensionMixin","SpotlightViewerPagers","SpotlightViewerPageWithKeys","SpotlightViewerThumbnailMixin","SpotlightViewport","SubscriptionsHandler","XMessagingPhotoDownloadController","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();var ca=k.createClass({displayName:"SpotlightMessagesViewer",mixins:[g,l,o,t,x,u],behaviors:[w,n],componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=null;},getViewerID:function(){return this.props.setid;},getInitialState:function(){this._subscriptions=new z();return {photoData:this._getInitialPhotoData(),open:true,showForward:false};},_enableSubscriptions:function(){this.props.useloadingindicator&&this._subscriptions.addSubscriptions(this.viewState.subscribe('photo_fetch',function(){return this.setState({photoData:null});}.bind(this)));},_showForwardDialog:function(){this.setState({showForward:true});},_hideForwardDialog:function(){this.setState({showForward:false});},renderLayers:function(){if(this.props.disableForward)return {};var da=(ba._("Forward in separate messages"));return {forwardDialog:(k.createElement(i,{attachmentID:String(this.state.photoData.id),onClose:this._hideForwardDialog,shown:this.state.showForward,title:da}))};},render:function(){var da=this.getMedia(),ea=this.props.snapToPhoto?this.getImageDimensions():this.getStageDimensions(),fa=this.props.useloadingindicator&&!this.state.photoData;j.registerCompletionCallback(function(){if(this.state.open)this.close();return true;}.bind(this));return (k.createElement(m,{rootClassName:this.props.rootClassName,open:this.state.open,onHide:this.close},k.createElement(y,{onClick:this._onClickViewport,stageDimensions:ea,media:da,showLoadingIndicator:fa},k.createElement(s,{onClick:this.close}),this.props.disablepaging?null:k.createElement(v,null),this._renderBottomBar())));},_renderBottomBar:function(){var da;if(h.ForwardingEnabled&&!this.props.disableForward)da=(k.createElement(r,{onClick:this._showForwardDialog},ba._("Forward")));var ea=aa.getURIBuilder().setString('photo_id',String(this.state.photoData.id)).getURI();return (k.createElement(p,null,k.createElement(q,null),k.createElement(q,null,da,k.createElement(r,{rel:"async",ajaxify:ea},ba._("Download")))));}});e.exports=ca;},null);
__d("MessagesViewer",["AsyncRequest","DOM","MessagesViewerSetID","PhotoStore","React","SpotlightMessagesViewer","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n={bootstrapWithElem:function(o){n.bootstrapWithConfig({fbid:o.getAttribute('data-fbid'),dimensions:o.getAttribute('data-dimensions'),src:o.getAttribute('href'),endpoint:o.getAttribute('data-endpoint'),disablePaging:o.getAttribute('data-disablepaging')},o);},bootstrapWithConfig:function(o,p){var q=o.setID;if(!q)q=i.MESSAGES;var r=k.createElement(l,{dimensions:[o.dimensions],disablepaging:o.disablePaging,disableForward:o.disableForward,open:true,photoid:o.fbid,reverse:false,rootClassName:o.rootClassName,setid:q,snapToPhoto:o.snapToPhoto,thumbsrc:o.src});n.render(r);if(!j.hasBeenCreated(q)&&o.endpoint){var s=new g(o.endpoint);if(p)s.setRelativeTo(p);s.send();}},render:function(o){var p=m('messages_viewer');if(!p){p=h.create('div',{id:'messages_viewer'});document.body.appendChild(p);}o=k.render(o,p);o.subscribeOnce('close',function(){k.unmountComponentAtNode(p);});}};e.exports=n;},null);
__d("XMessagingVideoAttachmentController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/mercury\/attachments\/video\/",{video_id:{type:"String",required:true},video_container_id:{type:"String",required:true},width:{type:"Int",required:true},height:{type:"Int",required:true}});},null);
__d("MessagingVideoViewer.react",["ActorURI","ArbiterMixin","AsyncRequest","MercuryConfig","MessagingForwardAttachmentDialog.react","React","ReactLayeredComponentMixin","SpotlightViewer","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerClose","SpotlightViewport","PageTransitions","PhotoViewerDimensions","XMessagingVideoAttachmentController","Vector","cx","fbt","guid"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();var aa=l,ba=aa.PropTypes,ca=200,da=l.createClass({displayName:"MessagingVideoViewer",propTypes:{disableForward:ba.bool,pageID:ba.number,rootClassName:ba.string,videoSize:ba.instanceOf(w).isRequired,videoID:ba.string.isRequired,videoURI:ba.string.isRequired},mixins:[h,m],getInitialState:function(){var ea=new u({verticalPadding:ca});return {dimensions:ea.getStageDimensions(this.props.videoSize),loading:true,open:true,showForward:false};},componentWillMount:function(){this._domID=z();},componentDidMount:function(){this._loadVideoPlayer();t.registerCompletionCallback(function(){this.close();return true;}.bind(this));},_loadVideoPlayer:function(){var ea=v.getURIBuilder().setString('video_id',this.props.videoID).setString('video_container_id',this._domID).setInt('width',this.state.dimensions.x).setInt('height',this.state.dimensions.y).getURI();if(this.props.pageID)ea=g.create(ea,this.props.pageID);this.request=new i().setMethod('GET').setURI(ea).setReadOnly(true).setHandler(function(fa){return this.setState({loading:false});}.bind(this)).send();},close:function(){if(!this.state.open)return;this.setState({open:false},function(){this.inform('close');});},_showForwardDialog:function(){this.setState({showForward:true});},_hideForwardDialog:function(){this.setState({showForward:false});},renderLayers:function(){var ea=(y._("Forward in separate messages"));return {forwardDialog:(l.createElement(k,{attachmentID:this.props.videoID,onClose:this._hideForwardDialog,shown:this.state.showForward,title:ea}))};},render:function(){var ea=l.createElement("div",{className:"rfloat",id:this._domID}),fa=j.ForwardingEnabled&&!this.props.disableForward?l.createElement(q,{onClick:this._showForwardDialog},y._("Forward")):null;return (l.createElement(n,{onHide:this.close,open:this.state.open,rootClassName:this.props.rootClassName},l.createElement(s,{className:"_39hc",media:ea,showLoadingIndicator:this.state.loading,stageDimensions:this.state.dimensions},l.createElement(r,{onClick:this.close}),l.createElement(o,{className:"stat_elem"},l.createElement(p,null),l.createElement(p,null,fa,l.createElement(q,{href:this.props.videoURI},y._("Download")))))));}});e.exports=da;},null);
__d("MercuryAttachmentVideo.react",["ChatImageArrowDirection","ChatImageWithArrow.react","CenteredContainer.react","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","Image.react","MercuryConfig","MessagesViewer","MessagingVideoViewer.react","React","Vector","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=q,v=u.PropTypes,w=q.createClass({displayName:"MercuryAttachmentVideo",propTypes:{duration:v.number.isRequired,isChat:v.bool,isInbound:v.bool,name:v.string.isRequired,pageID:v.number,thumbSize:v.shape({height:v.number,width:v.number}).isRequired,thumbnail:v.string.isRequired,videoSize:v.shape({height:v.number,width:v.number}).isRequired,videoID:v.string.isRequired,videoURI:v.string.isRequired},_formatDuration:function(){var x=this.props.duration,y=Math.floor(x/60),z=x%60;if(z<10)return y+':0'+z;return y+':'+z;},openViewer:function(){var x=new r(this.props.videoSize.width,this.props.videoSize.height);o.render(q.createElement(p,{pageID:this.props.pageID,videoID:this.props.videoID,videoSize:x,videoURI:this.props.videoURI}));},_renderImage:function(){if(this.useImageBubbles){return (q.createElement(h,{arrowDirection:this.props.isInbound?g.LEFT:g.RIGHT,height:this.props.thumbSize.height,source:this.props.thumbnail,width:this.props.thumbSize.width}));}else return (q.createElement(m,{height:this.props.thumbSize.height,width:this.props.thumbSize.width,src:this.props.thumbnail}));},_getStyle:function(){if(this.useImageBubbles)return {};return this.props.thumbSize;},render:function(){this.useImageBubbles=n.MercuryImageBubblesGK&&this.props.isChat;var x=(("_zow")+(' '+"_59go")+(this.useImageBubbles?' '+"_3ds5":''));return (q.createElement(k,{className:x,onClick:this.openViewer,style:this._getStyle()},q.createElement(j,null,this._renderImage()),q.createElement(l,null,q.createElement("div",{className:((!this.useImageBubbles?"_zox":''))},q.createElement("span",{className:"_zoz"},this._formatDuration()))),q.createElement(l,null,q.createElement(i,{vertical:true},q.createElement(m,{src:t('/images/chat/chat_play_icon.png')})))));}});e.exports=w;},null);
__d("MercuryMessageClientState",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={DO_NOT_SEND_TO_SERVER:'do_not_send_to_server',SEND_TO_SERVER:'send_to_server'};e.exports=g;},null);
__d("MercuryLocalIDs",["PresenceUtil","randomInt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={generateMessageID:function(j){var k=j||Date.now(),l=h(0,4294967295),m=g.getSessionID();return ("<"+k+":"+l+"-"+m+"@mail.projektitan.com>");},generateThreadID:function(j){return 'root:'+i.generateMessageID(j);}};e.exports=i;},null);
__d("MercuryMessageObject",["MercuryActionStatus","MercuryActionType","MercuryIDs","MercuryLocalIDs","MercuryMessageClientState","MercuryMessageSourceTags","MercurySingletonMixin","MercurySourceType","MercuryTimePassed","MercurySendMessageFields","fbt","formatDate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(v){"use strict";this.$MercuryMessageObject0=v;}s.prototype.constructUserGeneratedMessageObject=function(v,w,x,y,z){"use strict";var aa=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);if(typeof v=='string')v=v.replace(/^\s+/,'').replace(/\s+$/,'');aa.body=v;aa.has_attachment=false;aa.html_body=false;aa.attachments=[];aa.specific_to_list=y||[];aa.creator_info=z;return aa;};s.prototype.constructStickerMessageObject=function(v,w,x){"use strict";var y=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);y.has_attachment=true;y.html_body=false;y.attachments=[];y.sticker_id=v;y.specific_to_list=[];return y;};s.prototype.constructAttachmentMessageObject=function(v,w){"use strict";var x=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,v,w);x.attachments=[];x.specific_to_list=[];return x;};s.prototype.constructLogMessageObject=function(v,w,x,y){"use strict";var z=t(this.$MercuryMessageObject0,h.LOG_MESSAGE,v,w);z.log_message_type=x;z.log_message_data=y;return z;};s.prototype.normalizeNewMessage=function(v){"use strict";if(v.status===undefined)v.status=g.UNSENT;v.timestamp_absolute=q._("Today");v.message_id=v.message_id||j.generateMessageID(v.timestamp);var w=i.getParticipantIDFromUserID(this.$MercuryMessageObject0);v.specific_to_list=v.specific_to_list||[];if(v.specific_to_list.length&&v.specific_to_list.indexOf(w)===-1)v.specific_to_list.push(w);if(!v.thread_id){if(v.specific_to_list.length==1){v.thread_id='user:'+this.$MercuryMessageObject0;}else if(v.specific_to_list.length==2){var x=v.specific_to_list[0]==w?v.specific_to_list[1]:v.specific_to_list[0];v.thread_id=i.getThreadIDFromParticipantID(x);}v.thread_id=v.thread_id||'root:'+v.message_id;}if(!v.specific_to_list.length){var y=i.tokenize(v.thread_id),z=y.type,aa=y.value;if(z=='user')v.specific_to_list=['fbid:'+aa,w];}if(!v[p.MANUAL_RETRY_CNT])v[p.MANUAL_RETRY_CNT]=0;};s.prototype.normalizeResendMessage=function(v){"use strict";v.status=g.RESENDING;v.timestamp=Date.now();v[p.MANUAL_RETRY_CNT]+=1;};s.prototype.normalizeAddAttachmentPlaceholder=function(v,w,x){"use strict";if(x.preview_attachments.length>0){v.has_attachment=true;v.preview_attachments=x.preview_attachments;}v.client_state=k.DO_NOT_SEND_TO_SERVER;v.status=g.RESENDING;v.upload_id=w;};function t(v,w,x,y){var z=u(x)?[l.CHAT]:[],aa=Date.now(),ba=r(new Date(aa),'g:ia'),ca={action_type:w,thread_id:y,author:i.getParticipantIDFromUserID(v),author_email:null,coordinates:null,timestamp:aa,timestamp_absolute:(new Date(aa)).toLocaleDateString(),timestamp_relative:ba,timestamp_time_passed:o.TODAY,is_unread:false,is_forward:false,is_filtered_content:false,is_spoof_warning:false,source:x,source_tags:z};return ca;}function u(v){switch(v){case n.CHAT_WEB:case n.CHAT_JABBER:case n.CHAT_IPHONE:case n.CHAT_MEEBO:case n.CHAT_ORCA:case n.CHAT_TEST:case n.CHAT:case n.DESKTOP:return true;default:return false;}}Object.assign(s,m);e.exports=s;},null);
__d("FBID",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={isUser:function(h){return h<2.2e+09||(h>=1e+14&&h<=100099999989999)||(h>=8.9e+13&&h<=89999999999999)||(h>=6.000001e+13&&h<=60000019999999);}};e.exports=g;},null);
__d("MercurySendErrorLogger",["Banzai","BanzaiLogger"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=h.create({retry:true}),j=g.isEnabled('mercury_send_error_logging'),k={log:function(l){if(!j)return;var m={message_id:l.message_id,timestamp_client:Date.now(),error_type:l.error_data.type,error_code:l.error_data.code,error_description:l.error_data.description,is_transient:l.error_data.is_transient};i.log('MercurySendErrorLoggerConfig',m);}};e.exports=k;},null);
__d("MercuryServerSendMessageQueueSimulatedError",["AsyncRequest","AsyncResponse","copyProperties"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=9999,k={create:function(l){var m=new g(this.endpoint_uri).setData({message_batch:[l],client:this.client}),n=new h(m,{});i(n,{error:j,silentError:false,transientError:true,request:m});return n;}};e.exports=k;},null);
__d("MercuryServerSendMessageQueue",["BanzaiODS","LogHistory","MercuryLoggingHelper","MercuryServerRequestsConfig","MercuryServerDispatcher","MercuryServerSendMessageQueueSimulatedError"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m='/ajax/mercury/send_messages.php',n=h.getInstance('mercury_server_send_message_queue');function o(p,q,r,s){"use strict";this.sender_id=p;this.queue_id=q;this.$MercuryServerSendMessageQueue0=r.success_handler;this.$MercuryServerSendMessageQueue1=r.error_handler;this.$MercuryServerSendMessageQueue2=r.transport_error_handler;this.$MercuryServerSendMessageQueue3=r.timeout_handler;this.client=s;var t=null;if(j.msgrRegion)t={name:'X-MSGR-Region',value:j.msgrRegion};var u={};u[m]={request_user_id:this.sender_id,endpoint_id:this.queue_id,mode:k.IMMEDIATE,customHeader:t,handler:this.handleSuccess.bind(this),error_handler:this.handleError.bind(this),transport_error_handler:this.handleTransportError.bind(this),timeout:r.timeout,timeout_handler:this.handleTimeout.bind(this),connection_retries:r.connection_retries};k.registerEndpoints(u);this.pending_message=null;this.queue=[];}o.prototype.enqueue=function(p){"use strict";this.queue.push(p);this.$MercuryServerSendMessageQueue5();};o.prototype.$MercuryServerSendMessageQueue5=function(){"use strict";if(this.pending_message||!this.queue.length){if(this.pending_message)this.$MercuryServerSendMessageQueue6();return;}this.pending_message=this.queue.shift();k.trySend(m,{message_batch:[this.pending_message],client:this.client},null,this.sender_id,this.queue_id);};o.prototype.$MercuryServerSendMessageQueue7=function(){"use strict";while(this.queue.length)this.$MercuryServerSendMessageQueue8(this.queue.shift());};o.prototype.$MercuryServerSendMessageQueue8=function(p){"use strict";this.$MercuryServerSendMessageQueue1(l.create(p));n.error('mark_as_failed',{fbid:this.sender_id,queue_id:this.queue_id,message:i.obfuscateMessage(p)});};o.prototype.handleSuccess=function(p,q){"use strict";this.$MercuryServerSendMessageQueue0(p,q);this.pending_message=null;this.$MercuryServerSendMessageQueue5();};o.prototype.handleError=function(p){"use strict";this.$MercuryServerSendMessageQueue1(p);this.$MercuryServerSendMessageQueue7();this.pending_message=null;};o.prototype.handleTransportError=function(p){"use strict";this.$MercuryServerSendMessageQueue2(p);this.$MercuryServerSendMessageQueue7();this.pending_message=null;};o.prototype.handleTimeout=function(p){"use strict";this.$MercuryServerSendMessageQueue3(p);this.$MercuryServerSendMessageQueue7();this.pending_message=null;};o.prototype.$MercuryServerSendMessageQueue6=function(){"use strict";n.debug('maybe_send_next_pending_message',{fbid:this.sender_id,queue_id:this.queue_id,pending_message:i.obfuscateMessage(this.pending_message),queue:this.queue.map(function(q){return i.obfuscateMessage(q);})});var p='send_queue.delayed.queue_length.'+this.queue.length.toString();g.bumpEntityKey('chat.web',p);};e.exports=o;},null);
__d("MercuryServerSendMessageQueueRouter",["BanzaiODS","LogHistory","Map","MercuryServerSendMessageQueue","MercurySingletonMixin"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h.getInstance('mercury_server_send_message_queue_router'),m='chat.web.send_queue_router';g.setEntitySample(m,.1);function n(o){"use strict";this.fbid=o;this.queues=new i();}n.prototype.enqueue=function(o,p,q,r){"use strict";if(!this.queues.has(o)){this.queues.set(o,new j(this.fbid,o,p,q));l.debug('added queue',{fbid:this.fbid,queue_id:o});g.bumpEntityKey(m,'new_queue');}this.queues.get(o).enqueue(r);};Object.assign(n,k);e.exports=n;},null);
__d("PagesMessengerThreadUtils",["PageMessageEnumTag"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={isFlagThread:function(i){if(!i)return false;return i.page_thread_info?i.page_thread_info.flagged:false;},isPageSpecficFilter:function(i){if(i===g.FLAG)return true;return false;}};e.exports=h;},null);
__d("MercuryPageServerRequests",["MercuryAPIArgsSource","MercuryAssert","MercuryServerRequests","PageMessageEnumTag","PagesMessengerThreadUtils","MercuryServerDispatcher"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=g.MERCURY;for(var n in i)if(i.hasOwnProperty(n))p[n]=i[n];var o=i===null?null:i.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=i;function p(q){"use strict";i.call(this,q);var r={'/pages/messaging/thread_tag/add/':{request_user_id:q,mode:l.BATCH_SUCCESSIVE,batch_function:this.$MercuryPageServerRequests0,handler:function(s,t){return this.__handleUpdate(s,t);}.bind(this)},'/pages/messaging/thread_tag/remove/':{request_user_id:q,mode:l.BATCH_SUCCESSIVE,batch_function:this.$MercuryPageServerRequests0,handler:function(s,t){return this.__handleUpdate(s,t);}.bind(this)},'/pages/messaging/thread_tag/list/':{request_user_id:q,mode:l.IMMEDIATE,handler:function(s,t){return this.__handleUpdate(s,t);}.bind(this)}};l.registerEndpoints(r);}p.prototype.$MercuryPageServerRequests0=function(q,r){"use strict";var s=q?q.tag_name:r.tag_name,t=q?q.thread_ids:[],u=r?r.thread_ids:[],v=t.concat(u),w={tag_name:s,thread_ids:v};return w;};p.prototype.addThreadFlag=function(q,r){"use strict";h.isThreadID(q);this.getServerThreadID(q,function(s){var t={thread_ids:[s],tag_name:j.FLAG};this.__sendRequest('/pages/messaging/thread_tag/add/',t);}.bind(this));};p.prototype.fetchThreadlistInfo=function(q,r,s,t,u){"use strict";if(k.isPageSpecficFilter(t)){u=u||m;var v={folder:s,tag_name:t,offset:q,limit:r};this.__sendRequest('/pages/messaging/thread_tag/list/',v);return;}o.fetchThreadlistInfo.call(this,q,r,s,t,u);};p.prototype.removeThreadFlag=function(q,r){"use strict";h.isThreadID(q);this.getServerThreadID(q,function(s){var t={thread_ids:[s],tag_name:j.FLAG};this.__sendRequest('/pages/messaging/thread_tag/remove/',t);}.bind(this));};p.prototype.toString=function(){"use strict";return 'MercuryPageServerRequests';};e.exports=p;},null);
__d("MercuryServerRequestSingletonMixin",["CurrentUser","FBID"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={_getInstances:function(){if(!this._instances)this._instances={};return this._instances;},get:function(){return this.getForFBID(g.getID());},getForFBID:function(j){var k=this._getInstances();if(!k[j])if(h.isUser(j)){k[j]=new this(j);}else{var l;d(['MercuryPageServerRequests'],function(m){l=new m(j);});k[j]=l;}return k[j];}};e.exports=i;},null);
__d("MercuryMessageIDs",["KeyedCallbackManager"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=new g(),i={getServerIDs:function(j,k){var l=j.filter(function(n){return n.indexOf('mail.projektitan.com')!==-1;}),m=function(n){var o=j.map(function(p){return n[p]?n[p]:p;});k(o);};return h.executeOrEnqueue(l,m);},addServerID:function(j,k){h.setResource(j,k);}};e.exports=i;},null);
__d("MessagingReliabilityLogger",["PresenceUtil","MercuryServerDispatcher","MessagingReliabilityLoggerInitialData","isEmpty","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l='/ajax/mercury/client_reliability.php',m=60000;function n(t,u){var v={app:i.app,categories:JSON.stringify(t)};if(!j(u))v.extra=JSON.stringify(u);return v;}function o(t,u,v,w){if(t[u]===(void 0))t[u]={};if(t[u][v]===(void 0))t[u][v]=0;t[u][v]+=w;}function p(t,u,v,w){if(t[u]===(void 0))t[u]={};if(t[u][v]===(void 0))t[u][v]=[];for(var x=0;x<w.length;++x)t[u][v].push(w[x]);}function q(t,u){if((t&&!t.categories)||(u&&!u.categories))return;var v=t?JSON.parse(t.categories):{},w=t&&t.extra?JSON.parse(t.extra):{},x=JSON.parse(u.categories),y=u.extra?JSON.parse(u.extra):{};for(var z in x){var aa=x[z],ba=y[z];for(var ca in aa){o(v,z,ca,aa[ca]);if(ba!==(void 0)){var da=ba[ca];if(da!==(void 0))p(w,z,ca,da);}}}return n(v,w);}var r={};r[l]={mode:h.BATCH_SUCCESSIVE_PIGGYBACK_ON_ERROR,batch_function:q};h.registerEndpoints(r);var s={addEntry:function(t,u,v){if(!i.enabled)return;var w={};o(w,t,u,1);var x={};if(v!==(void 0))p(x,t,u,[v]);h.trySend(l,n(w,x));}};(function t(){s.addEntry('page_event','active',g.getSessionID());k(t,m);})();e.exports=s;},null);
__d("MercuryServerSendMessageQueueOptions",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h,i,j,k,l,m){"use strict";this.success_handler=h;this.error_handler=i;this.transport_error_handler=j;this.timeout_handler=k;this.timeout=l;this.connection_retries=m;}e.exports=g;},null);
__d("MercuryServerRequests",["Arbiter","ArbiterMixin","AsyncResponse","BanzaiLogger","ChannelConstants","CurrentUser","FBID","KeyedCallbackManager","LogHistory","MercuryActionStatus","MercuryActionType","MercuryAPIArgsSource","MercuryAssert","MercuryErrorType","MercuryGlobalActionType","MercuryIDs","MercuryLoggingHelper","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySendErrorLogger","MercuryServerRequestsConfig","MercuryServerSendMessageQueueRouter","MercuryServerRequestSingletonMixin","MercurySourceType","MercuryThreadlistConstants","MercuryMessageIDs","MessagingConfig","MessagingReliabilityLogger","MessagingTag","MercuryServerDispatcher","MercuryServerSendMessageQueueOptions","MercuryThreadInformer","copyProperties","createObjectFrom","errorCode","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa){b.__markCompiled&&b.__markCompiled();'use strict';var ra=o.getInstance('mercury_server'),sa=r.MERCURY;function ta(ub,vb){if(vb)ub._lastActionTimestamp=Math.max(ub._lastActionTimestamp,vb);}function ua(ub,vb){var wb=vb.thread_fbid;if(vb.canonical_fbid)wb=vb.canonical_fbid;var xb=ub._FBIDToClientIDs.getResource(wb);if(!xb){if(vb.canonical_fbid){xb='user:'+vb.canonical_fbid;}else if(vb.root_message_threading_id)xb='root:'+vb.root_message_threading_id;xb=xb||'thread:'+wb;if(wb)wb=wb.toString();wa(ub,wb,xb);if(vb.thread_id)va(ub,vb.thread_id,xb);}vb.thread_id=xb;}function va(ub,vb,wb){ub._serverToClientIDs.setResource(vb,wb);ub._clientToServerIDs.setResource(wb,vb);ub._newlyAddedClientIDs[vb]=wb;}function wa(ub,vb,wb){ub._clientIDToFBIDs.setResource(wb,vb);ub._FBIDToClientIDs.setResource(vb,wb);ub._newlyAddedClientIDs[vb]=wb;}function xa(ub,vb,wb){var xb=ub._clientIDToFBIDs.executeOrEnqueue(vb,wb),yb=ub._clientIDToFBIDs.getUnavailableResources(xb),zb=v.tokenize(vb);if(yb.length&&zb.type!='root')ub.fetchThreadData(yb);}function ya(ub,vb){return ub._clientIDToFBIDs.getResource(vb);}function za(ub,vb){return !!ub._FBIDToClientIDs.getResource(vb);}function ab(ub,vb){var wb=ub._serverToClientIDs.getResource(vb);if(typeof wb=='undefined')ra.warn('no_client_thread_id',{server_id:vb});return wb;}function bb(ub,vb){var wb=ub._FBIDToClientIDs.getResource(vb);if(typeof wb=='undefined')ra.warn('no_client_thread_id',{thread_fbid:vb});return wb;}function cb(ub,vb,wb){ub._FBIDToClientIDs.executeOrEnqueue(vb,wb);ub.ensureThreadIsFetched(vb);}function db(ub){return ub.thread_fbid||ub.thread_id||ub.client_thread_id;}function eb(ub,vb,wb){if(vb.action_type!=q.SEND_MESSAGE)return;var xb=vb.thread_fbid;if(vb.other_user_fbid)xb=vb.other_user_fbid;var yb=vb.client_thread_id;if(!yb)yb=bb(ub,xb);var zb=null;if(yb)zb=v.tokenize(yb).type;gb(ub,vb,wb==='success');if(vb.status===p.ERROR){aa.log(vb);}else ia.addEntry('send_'+zb,wb,xb+','+vb.message_id);}function fb(ub){return ub.getError()?'_'+ub.getError():'';}function gb(ub,vb,wb){if(Math.floor(Math.random()*20)===0)if(vb.client_message_id in ub._sentMessagesTimestamp){var xb=ub._sentMessagesTimestamp[vb.client_message_id],yb=Date.now()-xb,zb=vb.client_thread_id;if(!zb)zb=bb(ub,vb.thread_fbid);j.log('WebMessagingLatencyLoggerConfig',{has_attachment:vb.attachments&&vb.attachments.length>0,latency:yb,is_canonical:!v.isMultichat(zb),send_successful:wb,source:'client'});}}function hb(ub,vb){var wb=null;switch(vb.status){case p.SUCCESS:wb='success';break;case p.FAILED_UNKNOWN_REASON:wb='confirmed_error';break;case p.UNABLE_TO_CONFIRM:wb='confirm_error';break;default:return;}eb(ub,vb,wb);}function ib(ub,vb){(vb.threads||[]).forEach(function(fc){ua(ub,fc);delete ub._fetchingThreads[fc.thread_id];var gc=ya(ub,fc.thread_id);delete ub._fetchingThreads[gc];ta(ub,fc.timestamp);});(vb.ordered_threadlists||[]).forEach(function(fc){var gc=fc.thread_fbids||[];gc=gc.concat(fc.other_user_fbids||[]);fc.thread_ids=gc.map(bb.bind(null,ub));});if(vb.pinned_threads&&vb.pinned_threads.thread_fbids)vb.pinned_threads.thread_fbids=vb.pinned_threads.thread_fbids.map(bb.bind(null,ub));vb.actions=vb.actions||[];vb.actions.forEach(function(fc){hb(ub,fc);var gc=fc.thread_fbid;if(fc.other_user_fbid)gc=fc.other_user_fbid;if(fc.status&&fc.status!=p.SUCCESS&&!gc){fc.thread_id=fc.client_thread_id;return;}if(fc.action_type==q.SEND_MESSAGE&&fc.client_thread_id&&gc)wa(ub,gc.toString(),fc.client_thread_id);var hc=fc.thread_id;if(gc){fc.thread_id=za(ub,gc)?bb(ub,gc):null;}else if(fc.client_thread_id)fc.thread_id=fc.client_thread_id;if(!fc.thread_id)fc.server_thread_id=hc;if(!vb.payload_source||!vb.payload_source.startsWith('server'))ta(ub,fc.timestamp);});if(vb.end_of_history){var wb=[];for(var xb=0;xb<vb.end_of_history.length;xb++){var yb=vb.end_of_history[xb];if(yb.type=='user'){wb.push('user:'+yb.fbid);}else if(yb.type=='thread'&&za(ub,yb.fbid))wb.push(bb(ub,yb.fbid));}vb.end_of_history=wb;}if(vb.roger){var zb={};for(var ac in vb.roger){var bc=ub._FBIDToClientIDs.getResource(ac);if(bc){var cc=vb.roger[ac];zb[bc]={};for(var dc in cc)if(cc.hasOwnProperty(dc)){var ec=v.getParticipantIDFromUserID(dc);zb[bc][ec]=cc[dc];}}}vb.roger=zb;}}function jb(ub){if(ub._pendingUpdates&&ub._pendingUpdates.length){var vb=ub._pendingUpdates[0];ub._pendingUpdates=ub._pendingUpdates.slice(1);ub.handleUpdate(vb);}}function kb(ub,vb){var wb=na({},ub),xb;if(vb.threads){if(!wb.threads)wb.threads={};for(xb in vb.threads)wb.threads[xb]=Object.keys(oa((wb.threads[xb]||[]).concat(vb.threads[xb])));}if(vb.messages){if(!wb.messages)wb.messages={};for(xb in vb.messages){if(!wb.messages[xb])wb.messages[xb]={};for(var yb in vb.messages[xb])if(wb.messages[xb][yb]){wb.messages[xb][yb]=pb(wb.messages[xb][yb],vb.messages[xb][yb]);}else wb.messages[xb][yb]=vb.messages[xb][yb];}}wb.client=ub.client||vb.client;return wb;}function lb(ub,vb){var wb=na(oa(ub.folders,true),oa(vb.folders,true)),xb=ub.client||vb.client;return {folders:Object.keys(wb),client:xb};}function mb(ub,vb){for(var wb in vb)if(ub[wb]&&typeof ub[wb]==='object'){ub[wb]=pb(ub[wb],vb[wb]);}else if(vb[wb]&&typeof vb[wb]==='object'){var xb={};na(xb,vb[wb]);ub[wb]=xb;}return ub;}function nb(ub,vb){var wb=Object.assign({},ub.ids,vb.ids),xb=ub.client||vb.client;return {ids:wb,client:xb};}function ob(ub,vb){return vb;}function pb(ub,vb){var wb=ub.offset<vb.offset?ub.offset:vb.offset,xb=ub.offset+ub.limit,yb=vb.offset+vb.limit,zb=(xb>yb)?xb:yb,ac=zb-wb;return {offset:wb,limit:ac};}function qb(ub,vb){var wb=ub.client||vb.client,xb={ids:{},client:wb};na(xb.ids,ub.ids);na(xb.ids,vb.ids);return xb;}function rb(ub,vb){var wb={},xb,yb=ub.client||vb.client;delete ub.client;delete vb.client;for(xb in ub)na(wb,oa(ub[xb],xb));for(xb in vb)na(wb,oa(vb[xb],xb));var zb={client:yb};for(var ac in wb){xb=wb[ac];if(!zb[xb])zb[xb]=[];zb[xb].push(ac);}return zb;}function sb(ub,vb){var wb=ub.client||vb.client,xb=oa(ub.ids,true),yb=oa(vb.ids,true),zb=na(xb,yb);return {ids:Object.keys(zb),client:wb};}function tb(ub){this._fbid=ub;this._lastActionTimestamp=0;this._serverToClientIDs=new n();this._clientToServerIDs=new n();this._FBIDToClientIDs=new n();this._clientIDToFBIDs=new n();this._pendingUpdates=[];this._fetchingThreads={};this._newlyAddedClientIDs={};this._sentMessagesTimestamp={};this._sendMessageQueueOptions=new la(function(vb,wb){return this.__handleUpdate(vb,wb);}.bind(this),function(vb){return this._handleSendMessageError(vb);}.bind(this),function(vb){return this._handleSendMessageTransportError(vb);}.bind(this),function(vb){return this._handleSendMessageTimeout(vb);}.bind(this),ba.sendMessageTimeout,ha.SEND_CONNECTION_RETRIES);this._registerEndpoints();}na(tb.prototype,h,{getServerThreadID:function(ub,vb){s.isThreadID(ub);xa(this,ub,vb);},getThreadFBID:function(ub,vb){s.isThreadID(ub);xa(this,ub,vb);},getClientThreadID:function(ub,vb){cb(this,ub,vb);},getClientThreadIDNow:function(ub){return bb(this,ub);},getServerThreadIDNow:function(ub){return ya(this,ub);},getClientThreadIDForPermalinks:function(ub){return ab(this,ub);},convertThreadIDIfAvailable:function(ub){var vb=this._FBIDToClientIDs.getResource(ub);if(vb===(void 0)){return ub;}else return vb;},canLinkExternally:function(ub){s.isThreadID(ub);var vb=v.tokenize(ub);return (vb.type=='user')||!!ya(this,ub);},fetchThreadlistInfo:function(ub,vb,wb,xb,yb){wb=wb||ja.INBOX;yb=yb||sa;var zb=xb?ka.IMMEDIATE:null,ac={client:yb};ac[wb]={offset:ub,limit:vb,filter:xb};this.__sendRequest('/ajax/mercury/threadlist_info.php',ac,zb);},fetchPinnedThreads:function(){this.__sendRequest('/mercury/pinned_threads/',{});},fetchUnseenThreadIDs:function(ub,vb){vb=vb||sa;this.fetchThreadlistInfo(fa.RECENT_THREAD_OFFSET,fa.JEWEL_THREAD_COUNT,ub,null,vb);},fetchUnreadThreadIDs:function(ub,vb){vb=vb||sa;this.__sendRequest('/ajax/mercury/unread_threads.php',{folders:[ub],client:vb});},fetchMissedMessages:function(ub,vb){vb=vb||sa;var wb={last_action_timestamp:this._lastActionTimestamp,folders:ub,client:vb};wb.last_action_timestamp=this._lastActionTimestamp;this.__sendRequest('/ajax/mercury/thread_sync.php',wb);},fetchThreadData:function(ub,vb){vb=vb||sa;s.allThreadID(ub);var wb={threads:{},client:vb},xb=[],yb=[];ub.forEach(function(ac){if(this._fetchingThreads[ac])return;this._fetchingThreads[ac]=true;var bc=ya(this,ac),cc=v.tokenize(ac);if(cc.type=='user'){xb.push(cc.value);wb.threads.user_ids=xb;}else if(cc.type=='thread'){if(bc){yb.push(bc);}else yb.push(cc.value);wb.threads.thread_fbids=yb;}else if(cc.type=='root'){if(bc){yb.push(bc);wb.threads.thread_fbids=yb;}}else if(cc.type!='pending')throw new Error('Unknown thread type',cc);}.bind(this));this.inform("fetch-thread-data",wb);for(var zb in wb.threads){this.__sendRequest('/ajax/mercury/thread_info.php',wb);break;}},ensureThreadIsFetched:function(ub,vb){vb=vb||sa;if(!this._FBIDToClientIDs.getResource(ub)&&!this._fetchingThreads[ub]){this._fetchingThreads[ub]=true;this.__sendRequest('/ajax/mercury/thread_info.php',{threads:{thread_fbids:[ub]},client:vb});}},fetchThreadMessages:function(ub,vb,wb,xb,yb,zb){s.isThreadID(ub);zb=zb||sa;var ac,bc,cc=v.tokenize(ub),dc=ya(this,ub),ec=false;if(dc){ac=dc;bc=(cc.type=='user')?'user_ids':'thread_fbids';}else{ac=cc.value;switch(cc.type){case 'user':bc='user_ids';ec=true;break;case 'thread':bc='thread_fbids';break;}}var fc={messages:{},threads:{},client:zb};if(bc){fc.messages[bc]={};fc.messages[bc][ac]={offset:vb,timestamp:xb,limit:wb};if(ec)fc.threads[bc]=[ac];this.__sendRequest('/ajax/mercury/thread_info.php',fc,yb);}else xa(this,ub,function(gc){fc.messages.thread_fbids={};fc.messages.thread_fbids[gc]={offset:vb,timestamp:xb,limit:wb};this.__sendRequest('/ajax/mercury/thread_info.php',fc,yb);}.bind(this));},handleThreadInfoError:function(ub){var vb=ub.getRequest().getData(),wb=[];if(vb.messages){for(var xb in vb.messages.thread_fbids)wb.push(this._createServerErrorLogMessage(bb(this,xb)));for(var yb in vb.messages.user_ids)wb.push(this._createServerErrorLogMessage('user:'+yb));for(var zb in vb.messages.group_ids)wb.push(this._createServerErrorLogMessage('group:'+zb));}if(wb.length)this.handleUpdate({actions:wb,from_client:true,payload_source:z.CLIENT_CHANNEL_MESSAGE});if(vb.threads&&(vb.threads.user_ids||vb.threads.group_ids||vb.threads.thread_ids)){var ac=5,bc=true;if(!vb.retry_count){vb.retry_count=0;if(vb.messages)delete vb.messages;}else if(vb.retry_count>=ac){bc=false;(vb.threads.thread_ids||[]).forEach(function(dc){if(dc in this._fetchingThreads)delete this._fetchingThreads[dc];}.bind(this));}if(bc){var cc=vb.retry_count*1000;qa(function(){ra.log('retry_thread',vb);this.__sendRequest('/ajax/mercury/thread_info.php',vb);}.bind(this),cc);vb.retry_count++;}}},markFolderAsRead:function(ub){this.__sendRequest('/ajax/mercury/mark_folder_as_read.php',{folder:ub});var vb=[{action_type:u.MARK_ALL_READ,action_id:null,folder:ub}];this.handleUpdate({global_actions:vb,from_client:true,payload_source:z.CLIENT_CHANGE_READ_STATUS});},changeThreadReadStatus:function(ub,vb,wb){s.isThreadID(ub);xa(this,ub,function(xb){var yb={ids:{},source:wb};yb.ids[xb]=vb;this.__sendRequest('/ajax/mercury/change_read_status.php',yb);}.bind(this));},changeThreadArchivedStatus:function(ub,vb,wb){s.isThreadID(ub);xa(this,ub,function(xb){var yb={ids:{},source:wb};yb.ids[xb]=vb;this.__sendRequest('/ajax/mercury/change_archived_status.php',yb);}.bind(this));},changeThreadFolder:function(ub,vb){s.isThreadID(ub);xa(this,ub,function(wb){var xb={};xb[vb]=[wb];this.__sendRequest('/ajax/mercury/move_thread.php',xb);}.bind(this));},changeMutingOnThread:function(ub,vb){s.isThreadID(ub);xa(this,ub,function(wb){this.__sendRequest('/ajax/mercury/change_mute_thread.php',{thread_fbid:wb,mute_settings:vb,payload_source:sa});}.bind(this));},markThreadSpam:function(ub,vb){s.isThreadID(ub);xa(this,ub,function(wb){this.__sendRequest('/ajax/mercury/mark_spam.php',{id:wb,source:vb});}.bind(this));},markMessagesSpam:function(ub,vb){ga.getServerIDs(vb||[],function(wb){this.__sendRequest('/ajax/mercury/mark_spam_messages.php',{message_ids:wb});}.bind(this));},unmarkThreadSpam:function(ub,vb){s.isThreadID(ub);xa(this,ub,function(wb){this.__sendRequest('/ajax/mercury/unmark_spam.php',{id:wb,source:vb});}.bind(this));},deleteThread:function(ub,vb){s.isThreadID(ub);xa(this,ub,function(wb){var xb={ids:[wb],source:vb};this.__sendRequest('/ajax/mercury/delete_thread.php',xb);}.bind(this));},unpinThread:function(ub){s.isThreadID(ub);xa(this,ub,function(vb){this.__sendRequest('/mercury/unpin_thread/',{id:vb});}.bind(this));},deleteMessages:function(ub,vb){ga.getServerIDs(vb||[],function(wb){this.__sendRequest('/ajax/mercury/delete_messages.php',{message_ids:wb});}.bind(this));},sendDeliveryReceipts:function(ub){ga.getServerIDs(ub||[],function(vb){this.__sendRequest('/ajax/mercury/delivery_receipts.php',{message_ids:vb});}.bind(this));},sendNewMessage:function(ub,vb){vb=vb||sa;if(!ub.client_state||ub.client_state==y.SEND_TO_SERVER)ga.getServerIDs(ub.forward_message_ids||[],function(wb){var xb=v.tokenize(ub.thread_id),yb=xb.type,zb=na({},ub);zb.forward_message_ids=wb;if((yb=='root'&&xb.value==zb.message_id)||(yb=='user')){zb.client_thread_id=zb.thread_id;zb.thread_id=null;this._sendNewMessageToServer(zb,vb);}else xa(this,zb.thread_id,function(ac){xb=v.tokenize(zb.thread_id);if(xb.type=='user'){zb.other_user_fbid=xb.values;}else zb.thread_fbid=ac;zb.thread_id=null;this._sendNewMessageToServer(zb);}.bind(this));}.bind(this));},_sendNewMessageToServer:function(ub,vb){g.inform(k.ATTEMPT_RECONNECT);vb=vb||sa;this._sentMessagesTimestamp[ub.message_id]=Date.now();ca.getForFBID(this._fbid).enqueue(db(ub),this._sendMessageQueueOptions,vb,ub);},requestMessageConfirmation:function(ub,vb){vb=vb||sa;var wb={},xb={};for(var yb in ub){var zb=ya(this,yb);if(zb){wb[zb]=ub[yb];}else{var ac=ub[yb];for(var bc=0;bc<ac.length;bc++)xb[ac[bc]]=yb;}}var cc=Object.keys(wb),dc=Object.keys(xb);if(cc.length||dc.length)this.__sendRequest('/ajax/mercury/confirm_messages.php',{thread_message_map:wb,local_messages:xb,client:vb});},handleMessageConfirmError:function(ub){var vb=ub.getRequest().getData().thread_message_map,wb=ub.getRequest().getData().local_messages;if(!vb&&!wb)return;var xb=[];for(var yb in vb){var zb=vb[yb];zb.forEach(function(cc){xb.push({action_type:q.SEND_MESSAGE,client_message_id:cc,message_id:cc,client_thread_id:null,thread_fbid:yb,status:p.UNABLE_TO_CONFIRM});});}for(var ac in wb){var bc=wb[ac];xb.push({action_type:q.SEND_MESSAGE,client_message_id:ac,message_id:ac,client_thread_id:bc,thread_fbid:null,status:p.UNABLE_TO_CONFIRM});}if(xb.length)this.handleUpdate({actions:xb,payload_source:z.CLIENT_HANDLE_ERROR});},markSeen:function(){var ub=this._lastActionTimestamp;this.__sendRequest('/ajax/mercury/mark_seen.php',{seen_timestamp:ub});},handleRoger:function(ub){var vb=ub.thread_fbid?this._FBIDToClientIDs.getResource(ub.thread_fbid):v.getThreadIDFromUserID(ub.reader);if(vb){var wb=v.getParticipantIDFromUserID(ub.reader),xb={};xb[vb]={};xb[vb][wb]=ub.time;this.inform('update-roger',xb);}},handleUpdateWaitForThread:function(ub,vb,wb){wb=wb||sa;var xb=this._FBIDToClientIDs.getResource(vb);if(xb){this.handleUpdate(ub);return;}this._FBIDToClientIDs.executeOrEnqueue(vb,function(){this._pendingUpdates.push(ub);}.bind(this));if(!this._fetchingThreads[vb]){this._fetchingThreads[vb]=true;var yb={threads:{thread_fbids:[vb]},client:wb};if(m.isUser(vb))yb={threads:{user_ids:[vb]},client:wb};this.__sendRequest('/ajax/mercury/thread_info.php',yb);}},handleUpdate:function(ub){var vb=[];if(ub&&ub.threads)for(var wb=0;wb<ub.threads.length;wb++){if(!ub.threads[wb].snippet_attachments)continue;for(var xb=0;xb<ub.threads[wb].snippet_attachments.length;xb++)if(ub.threads[wb].snippet_attachments[xb].share_xhp){vb.push({i:wb,j:xb,xhp:ub.threads[wb].snippet_attachments[xb].share_xhp});ub.threads[wb].snippet_attachments[xb].share_xhp="HTMLDivElement not shown: object contains circular "+"reference, which was breaking JSON.stringify. "+"Look at MercuryServerRequests.handleUpdate";}}var yb={actions:[],threads:[]};if(ub){if(ub.actions)yb.actions=ub.actions.map(function(bc){return w.obfuscateMessage(bc);});if(ub.threads)yb.threads=ub.threads.map(function(bc){return w.obfuscateThread(bc);});}var zb=na({},ub,yb);ra.debug('update:'+ub.payload_source,{payload:zb,from_client:ub.from_client});for(var ac=0;ac<vb.length;ac++)ub.threads[vb[ac].i].snippet_attachments[vb[ac].j].share_xhp=vb[ac].xhp;for(ac in ub){ma.getForFBID(this._fbid).synchronizeInforms(function(){if(!ub.from_client){ib(this,ub);this.inform('payload-preprocessed',ub);}this.inform('update-thread-ids',this._newlyAddedClientIDs);this._newlyAddedClientIDs={};this.inform('update-participants',ub);this.inform('update-threads',ub);this.inform('update-unread',ub);this.inform('update-threadlist',ub);this.inform('update-pinned-threads',ub);this.inform('update-messages',ub);this.inform('update-unseen',ub);this.inform('update-typing-state',ub);this.inform('update-roger',ub.roger);this.inform('model-update-completed',null);jb(this);}.bind(this));break;}},_handleSendMessageErrorCommon:function(ub,vb,wb,xb){ra.debug('handle_send_message_error_common',{reliability_error_status:wb,request_error_status:vb});var yb=ub.getData(),zb=yb.message_batch,ac=zb.map(function(cc){var dc={action_type:q.SEND_MESSAGE,thread_fbid:cc.thread_fbid,client_message_id:cc.message_id,message_id:cc.message_id,client_thread_id:cc.client_thread_id,status:vb,error_data:xb};return dc;});ac.forEach(function(cc){eb(this,cc,wb);},this);var bc={actions:ac,payload_source:z.CLIENT_HANDLE_ERROR};this.handleUpdate(bc);},handleSendMessageError:function(ub){var vb=ub.getPayload(),wb=null,xb=null;if(vb&&vb.error_payload){wb=p.UNCONFIRMED;xb='send_error';}else{wb=p.ERROR;xb='request_error'+fb(ub);}var yb=ub.error;if(yb===1404102)i.verboseErrorHandler(ub);var zb=/<.*>/.test(ub.getErrorDescription())?ub.getErrorSummary():ub.getErrorDescription();this._handleSendMessageErrorCommon(ub.getRequest(),wb,xb,{type:t.SERVER,code:ub.getError(),description:zb,is_transient:ub.isTransient()});},handleSendMessageTransportError:function(ub){this._handleSendMessageErrorCommon(ub.getRequest(),p.ERROR,'transport_error'+fb(ub),{type:t.TRANSPORT,code:ub.getError(),is_transient:true});},handleSendMessageTimeout:function(ub){this._handleSendMessageErrorCommon(ub,p.ERROR,'transport_timeout',{type:t.TIMEOUT,is_transient:true});},getLastActionTimestamp:function(){return this._lastActionTimestamp;},_createServerErrorLogMessage:function(ub){return {action_type:q.LOG_MESSAGE,thread_id:ub,message_id:ub,timestamp:Date.now(),timestamp_absolute:'',timestamp_relative:'',is_unread:false,source:ea.UNKNOWN,log_message_type:x.SERVER_ERROR,log_message_data:{}};},_getForAsyncRequest:function(ub){var vb=ub.getData(),wb=vb.request_user_id?vb.request_user_id:l.getID();return tb.getForFBID(wb);},__handleUpdate:function(ub,vb){this._getForAsyncRequest(vb).handleUpdate(ub);},_handleThreadInfoError:function(ub){var vb=this._getForAsyncRequest(ub.getRequest());vb.handleThreadInfoError(ub);},_handleSendMessageError:function(ub){var vb=this._getForAsyncRequest(ub.getRequest());vb.handleSendMessageError(ub);},_handleSendMessageTransportError:function(ub){var vb=this._getForAsyncRequest(ub.getRequest());vb.handleSendMessageTransportError(ub);},_handleSendMessageTimeout:function(ub){var vb=this._getForAsyncRequest(ub);vb.handleSendMessageTimeout(ub);},_handleMessageConfirmError:function(ub){var vb=this._getForAsyncRequest(ub.getRequest());vb.handleMessageConfirmError(ub);},_registerEndpoints:function(){var ub=null;if(ba.msgrRegion)ub={name:'X-MSGR-Region',value:ba.msgrRegion};var vb={'/ajax/mercury/thread_sync.php':{request_user_id:this._fbid,mode:ka.IDEMPOTENT,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/thread_info.php':{request_user_id:this._fbid,mode:ka.BATCH_DEFERRED_MULTI,customHeader:ub,batch_function:kb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this),error_handler:function(wb){return this._handleThreadInfoError(wb);}.bind(this)},'/ajax/mercury/mark_folder_as_read.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/change_read_status.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE,customHeader:ub,batch_function:nb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/mark_seen.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE,customHeader:ub,batch_function:ob,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/confirm_messages.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this),error_handler:function(wb){return this._handleMessageConfirmError(wb);}.bind(this)},'/ajax/mercury/threadlist_info.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE_UNIQUE,customHeader:ub,batch_function:mb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/mark_spam.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/mark_spam_messages.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/unmark_spam.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/unread_threads.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE_UNIQUE,customHeader:ub,batch_function:lb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/chat/settings.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub},'/ajax/mercury/change_archived_status.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE,customHeader:ub,batch_function:qb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/delete_thread.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE,customHeader:ub,batch_function:sb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/delete_messages.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/delivery_receipts.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/move_thread.php':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE,customHeader:ub,batch_function:rb,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/ajax/mercury/change_mute_thread.php':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/mercury/pinned_threads/':{request_user_id:this._fbid,mode:ka.BATCH_SUCCESSIVE_UNIQUE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)},'/mercury/unpin_thread/':{request_user_id:this._fbid,mode:ka.IMMEDIATE,customHeader:ub,handler:function(wb,xb){return this.__handleUpdate(wb,xb);}.bind(this)}};ka.registerEndpoints(vb);},__sendRequest:function(ub,vb,wb){ka.trySend(ub,vb,wb,this._fbid);}});Object.assign(tb,da);e.exports=tb;},null);
__d("MercuryMessageActions",["MercuryActionType","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';function l(m){this.$MercuryMessageActions0=m;this.$MercuryMessageActions1=h.getForFBID(this.$MercuryMessageActions0);this.$MercuryMessageActions2=j.getForFBID(this.$MercuryMessageActions0);}l.prototype.send=function(m,n,o){n=n||Function.prototype;this.$MercuryMessageActions1.normalizeNewMessage(m);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},m),i.CLIENT_SEND_MESSAGE));this.$MercuryMessageActions2.sendNewMessage(m,o);n(m.thread_id);};l.prototype.resend=function(m,n){var o=Object.assign({},m);this.$MercuryMessageActions1.normalizeResendMessage(o);this.send(o,(void 0),n);};l.prototype.addAttachmentPlaceholder=function(m,n,o){this.$MercuryMessageActions1.normalizeAddAttachmentPlaceholder(m,n,o);this.$MercuryMessageActions1.normalizeNewMessage(m);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},m),i.CLIENT_SEND_MESSAGE));};l.prototype.cancelAttachmentPlaceholder=function(m,n){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:m,upload_data:n,action_type:g.CANCEL_ATTACHMENT_PLACEHOLDER},i.CLIENT_SEND_MESSAGE));};l.prototype.confirmAttachmentPlaceholder=function(m,n){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:m,upload_data:n,action_type:g.CONFIRM_ATTACHMENT_PLACEHOLDER},i.CLIENT_SEND_MESSAGE));};l.prototype.markSpam=function(m,n){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions4(m,n,g.MARK_MESSAGES_SPAM,i.CLIENT_MARK_MESSAGES_SPAM));};l.prototype["delete"]=function(m,n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions4(m,n,g.DELETE_MESSAGES,o||i.CLIENT_DELETE_MESSAGES));};l.prototype.$MercuryMessageActions3=function(m,n){return {actions:[m],from_client:true,payload_source:n};};l.prototype.$MercuryMessageActions5=function(m,n){return {actions:[m],from_client:false,payload_source:n};};l.prototype.$MercuryMessageActions4=function(m,n,o,p){return {actions:[{action_type:o,action_id:null,thread_id:m,message_ids:n}],from_client:true,payload_source:p};};Object.assign(l,k);e.exports=l;},null);
__d("arrayStableSort",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h,i){return h.map(function(j,k){return {data:j,index:k};}).sort(function(j,k){return i(j.data,k.data)||(j.index-k.index);}).map(function(j){return j.data;});}e.exports=g;},null);
__d("RangedCallbackManager",["CallbackManagerController","arrayStableSort","createObjectFrom"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k,l,m){"use strict";this.$RangedCallbackManager0=[];this.$RangedCallbackManager1=false;this.$RangedCallbackManager2=false;this.$RangedCallbackManager3={};this.$RangedCallbackManager4=new g(this.$RangedCallbackManager5.bind(this));this.$RangedCallbackManager6=k;this.$RangedCallbackManager7=l;this.$RangedCallbackManager8=m;}j.prototype.executeOrEnqueue=function(k,l,m,n,o){"use strict";return this.$RangedCallbackManager4.executeOrEnqueue({start:k,limit:l},m,{strict:!!n,skipOnStrictHandler:o});};j.prototype.unsubscribe=function(k){"use strict";this.$RangedCallbackManager4.unsubscribe(k);};j.prototype.getUnavailableResources=function(k){"use strict";var l=this.$RangedCallbackManager4.getRequest(k),m=[];if(l&&!this.$RangedCallbackManager1){var n=l.request,o=this.$RangedCallbackManager9(l.options),p=n.start+n.limit;for(var q=o.length;q<p;q++)m.push(q);}return m;};j.prototype.addResources=function(k){"use strict";k.forEach(function(l){if(!this.$RangedCallbackManager3[l]){this.$RangedCallbackManager3[l]=true;this.$RangedCallbackManager0.push(l);this.$RangedCallbackManager2=null;}}.bind(this));this.resortResources();this.$RangedCallbackManager4.runPossibleCallbacks();};j.prototype.addResourcesWithoutSorting=function(k,l){"use strict";var m=this.$RangedCallbackManager0.slice(0,l);m=m.concat(k);m=m.concat(this.$RangedCallbackManager0.slice(l));this.$RangedCallbackManager0=m;Object.assign(this.$RangedCallbackManager3,i(k,true));this.$RangedCallbackManager2=null;this.$RangedCallbackManager4.runPossibleCallbacks();};j.prototype.removeResources=function(k){"use strict";k.forEach(function(l){if(this.$RangedCallbackManager3[l]){this.$RangedCallbackManager3[l]=false;var m=this.$RangedCallbackManager0.indexOf(l);if(m!=-1)this.$RangedCallbackManager0.splice(m,1);}}.bind(this));};j.prototype.removeAllResources=function(){"use strict";this.$RangedCallbackManager0=[];this.$RangedCallbackManager3={};};j.prototype.resortResources=function(){"use strict";this.$RangedCallbackManager0=h(this.$RangedCallbackManager0,function(k,l){return this.$RangedCallbackManager7(this.$RangedCallbackManager6(k),this.$RangedCallbackManager6(l));}.bind(this));};j.prototype.setReachedEndOfArray=function(){"use strict";if(!this.$RangedCallbackManager1){this.$RangedCallbackManager1=true;this.$RangedCallbackManager2=null;this.$RangedCallbackManager4.runPossibleCallbacks();}};j.prototype.hasReachedEndOfArray=function(){"use strict";return this.$RangedCallbackManager1;};j.prototype.setError=function(k){"use strict";if(this.$RangedCallbackManager2!==k){this.$RangedCallbackManager2=k;this.$RangedCallbackManager4.runPossibleCallbacks();}};j.prototype.getError=function(k,l,m){"use strict";var n=this.$RangedCallbackManager9({strict:m});return k+l>n.length?this.$RangedCallbackManager2:null;};j.prototype.hasResource=function(k){"use strict";return this.$RangedCallbackManager3[k];};j.prototype.getResourceAtIndex=function(k){"use strict";return this.$RangedCallbackManager0[k];};j.prototype.getAllResources=function(){"use strict";return this.$RangedCallbackManager0.concat();};j.prototype.getCurrentArraySize=function(k){"use strict";return this.$RangedCallbackManager9(k).length;};j.prototype.$RangedCallbackManager9=function(k){"use strict";var l=this.$RangedCallbackManager0;if(k&&k.strict){var m=k.skipOnStrictHandler||this.$RangedCallbackManager8;if(m)l=l.filter(m);}return l;};j.prototype.$RangedCallbackManager5=function(k,l){"use strict";var m=this.$RangedCallbackManager9(l);if(!this.$RangedCallbackManager1&&!this.$RangedCallbackManager2&&k.start+k.limit>m.length){return false;}else{var n=m.slice(k.start,k.start+k.limit),o=k.start+k.limit>m.length?this.$RangedCallbackManager2:null;return [n,o];}};j.prototype.getElementsUntil=function(k){"use strict";var l=[];for(var m=0;m<this.$RangedCallbackManager0.length;m++){var n=this.$RangedCallbackManager6(this.$RangedCallbackManager0[m]);if(this.$RangedCallbackManager7(n,k)>0)break;l.push(this.$RangedCallbackManager0[m]);}return l;};e.exports=j;},null);
__d("MercuryThreadActions",["MercuryActionType","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MessagingTag","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n){this.$MercuryThreadActions0=n;this.__serverRequests=i.getForFBID(this.$MercuryThreadActions0);}m.prototype.markRead=function(n,o){this.batchMarkRead([n],o);};m.prototype.batchMarkRead=function(n,o){this.__serverRequests.handleUpdate(this.$MercuryThreadActions1(n,true,o));};m.prototype.markUnread=function(n,o){this.batchMarkUnread([n],o);};m.prototype.batchMarkUnread=function(n,o){this.__serverRequests.handleUpdate(this.$MercuryThreadActions1(n,false,o));};m.prototype.markSeen=function(n,o){this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.MARK_THREAD_SEEN,h.CLIENT_MARK_THREAD_SEEN,{persistent:o}));};m.prototype.archive=function(n,o){this.batchArchive([n],o);};m.prototype.batchArchive=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadArchivedStatus(p,true,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions2(n,true));};m.prototype.unarchive=function(n,o){this.batchUnarchive([n],o);};m.prototype.batchUnarchive=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadArchivedStatus(p,false,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions2(n,false));};m.prototype.markSpam=function(n,o){this.batchMarkSpam([n],o);};m.prototype.batchMarkSpam=function(n,o){n.forEach(function(p){this.__serverRequests.markThreadSpam(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions3(n,k.SPAM));};m.prototype.unmarkSpam=function(n,o){this.batchUnmarkSpam([n],o);};m.prototype.batchUnmarkSpam=function(n,o){n.forEach(function(p){this.__serverRequests.unmarkThreadSpam(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions3(n,k.INBOX));};m.prototype.changeFolder=function(n,o){this.batchChangeFolder([n],o);};m.prototype.batchChangeFolder=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadFolder(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions3(n,o));};m.prototype["delete"]=function(n,o){this.batchDelete([n],o);};m.prototype.batchDelete=function(n,o){n.forEach(function(p){this.__serverRequests.deleteThread(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.__constructClientPayload(n,g.DELETE_THREAD,h.CLIENT_DELETE_THREAD));};m.prototype.unmute=function(n){this.updateMuteSetting(n,0);};m.prototype.updateMuteSetting=function(n,o){this.__serverRequests.changeMutingOnThread(n,o);this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.CHANGE_MUTE_SETTINGS,h.CLIENT_CHANGE_MUTE_SETTINGS,{mute_settings:o}));};m.prototype.addParticipants=function(n,o){this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.ADD_PARTICIPANTS,h.CLIENT_ADD_PARTICIPANTS,{participants:o}));};m.prototype.unpinThread=function(n){this.__serverRequests.unpinThread(n);this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.UNPIN_THREAD,h.CLIENT_UNPIN_THREAD));};m.prototype.$MercuryThreadActions1=function(n,o,p){return this.__constructClientPayload(n,g.CHANGE_READ_STATUS,h.CLIENT_CHANGE_READ_STATUS,{mark_as_read:o,source:p});};m.prototype.$MercuryThreadActions2=function(n,o){return this.__constructClientPayload(n,g.CHANGE_ARCHIVED_STATUS,h.CLIENT_CHANGE_ARCHIVED_STATUS,{archived:o});};m.prototype.$MercuryThreadActions3=function(n,o){return this.__constructClientPayload(n,g.CHANGE_FOLDER,h.CLIENT_CHANGE_FOLDER,{new_folder:o});};m.prototype.__constructClientPayload=function(n,o,p,q){return {actions:n.map(function(r){return l({action_type:o,action_id:null,thread_id:r},q);}),from_client:true,payload_source:p};};Object.assign(m,j);e.exports=m;},null);
__d("MercuryMessages",["BanzaiODS","EventEmitter","ImmutableObject","LogHistory","Map","MercuryActionStatus","MercuryActionType","MercuryAssert","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySingletonMixin","MercuryMessageActions","MercuryMessageIDs","RangedCallbackManager","MercurySendMessageFields","MercuryServerRequests","MercuryThreadActions","MercuryThreadInformer","MercuryThreads","URI","copyProperties","invariant","isMessengerDotComURI","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){b.__markCompiled&&b.__markCompiled();'use strict';var fa=new h(),ga=j.getInstance('mercury_messages');function ha(qa,ra){var sa=ra;if(qa._localIdsMap[ra])sa=qa._localIdsMap[ra];return qa._messages.get(sa);}function ia(qa){switch(qa){case q.UNKNOWN:case q.SERVER_INITIAL_DATA:case q.SERVER_FETCH_THREAD_INFO:case q.SERVER_THREAD_SYNC:return true;}return false;}function ja(qa,ra){if(!qa._threadsToMessages[ra])qa._threadsToMessages[ra]=new u(function(sa){return ha(qa,sa).timestamp;},function(sa,ta){return ta-sa;});return qa._threadsToMessages[ra];}function ka(qa,ra,sa){ra.forEach(function(ta){var ua=ja(qa,ta);ua.setReachedEndOfArray();qa._emitReorderedChange(ta,sa);});}function la(qa){this._fbid=qa;this._messageActions=s.getForFBID(this._fbid);this._serverRequests=w.getForFBID(this._fbid);this._threadInformer=y.getForFBID(this._fbid);this._threads=z.getForFBID(this._fbid);this._threadActions=x.getForFBID(this._fbid);this._didChange=false;this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new k();this._localIdsMap={};this._serverRequests.subscribe('update-messages',function(ra,sa){var ta=(sa.actions||[]).filter(function(va){var wa=va.action_type,xa=((va.is_forward||va.thread_id)&&(wa==m.LOG_MESSAGE||wa==m.USER_GENERATED_MESSAGE||wa==m.SEND_MESSAGE||wa==m.DELETE_THREAD||wa==m.DELETE_MESSAGES||wa==m.MARK_MESSAGES_SPAM)),ya=((va.upload_id&&va.upload_data)&&(wa==m.CANCEL_ATTACHMENT_PLACEHOLDER||wa==m.CONFIRM_ATTACHMENT_PLACEHOLDER));return xa||ya;}),ua=ia(sa.payload_source);this.handleUpdates(ta,ua,sa.payload_source,sa.from_client);if(sa.end_of_history)ka(this,sa.end_of_history,sa.payload_source);if(this._didChange){this._didChange=false;fa.emit('change');}}.bind(this));ga.debug('constructed',{fbid:this._fbid});}ba(la.prototype,{getMessagesFromIDs:function(qa){return (qa||[]).map(ha.bind(null,this)).filter(function(ra){return ra;});},hasLoadedNMessages:function(qa,ra){var sa=ja(this,qa);return sa.hasReachedEndOfArray()||sa.getCurrentArraySize()>=ra;},hasLoadedExactlyNMessages:function(qa,ra){var sa=ja(this,qa);return sa.getCurrentArraySize()==ra;},clearMercuryInternalState_DO_NOT_USE:function(){this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new k();this._localIdsMap={};},getThreadMessagesRange:function(qa,ra,sa,ta,ua,va){var wa=ja(this,qa),xa=function(hb){ta(ma(this,hb));}.bind(this),ya=wa.executeOrEnqueue(ra,sa,xa),za=wa.getUnavailableResources(ya),ab=this._failedHistoryFetchThreads[qa];if(za.length&&!ab){var bb=wa.getCurrentArraySize(),cb=this._localTitanMessagesCount[qa]||0,db=bb-cb,eb=za.length+cb,fb=this.getCurrentlyLoadedMessages(qa),gb=fb.length?fb[0].timestamp:0;ga.debug('fetch_missing_messages',{threadID:qa,offset:ra,limit:sa,timestamp:gb,missingIndices:za,messageCount:bb,localMessageCount:cb});this._serverRequests.fetchThreadMessages(qa,db,eb,gb,ua,va);}else this._failedHistoryFetchThreads[qa]=false;return ya;},getThreadMessagesRangeNow:function(qa,ra,sa){var ta=ja(this,qa),ua=[];for(var va=ra;va<ra+sa;va++){var wa=ta.getResourceAtIndex(va),xa=ha(this,wa);xa&&ua.push(xa);}return ua;},getThreadMessagesSinceTimestamp:function(qa,ra){var sa=ja(this,qa),ta=sa.getElementsUntil(ra);return ma(this,ta);},hasLoadedAllMessages:function(qa){return ja(this,qa).hasReachedEndOfArray();},getCurrentlyLoadedMessages:function(qa){var ra=ja(this,qa).getAllResources();return ma(this,ra);},unsubscribe:function(qa,ra){n.isThreadID(ra);var sa=ja(this,ra);sa.unsubscribe(qa);},_addNewMessage:function(qa,ra){pa(ra);this._messages.set(qa,new i(ra));},_updateMessage:function(qa,ra,sa){var ta=i.set(ra,sa);this._messages.set(qa,ta);return ta;},_shouldSortOutOfOrderMessages:function(qa,ra,sa){if(qa==q.CLIENT_CHANNEL_MESSAGE){var ta=this.getThreadMessagesSinceTimestamp(ra,sa);if(ta.length>0){g.bumpEntityKey('chat.web','channel.messages_reordered');return true;}}return false;},_preprocessIncomingAction:function(qa,ra){var sa=qa.action_type;if(ra==q.CLIENT_CHANNEL_MESSAGE&&sa==m.USER_GENERATED_MESSAGE&&qa.threading_id&&this._localIdsMap[qa.threading_id]===qa.threading_id){qa.client_message_id=qa.threading_id;qa.status=l.SUCCESS;qa.action_type=m.SEND_MESSAGE;sa=qa.action_type;}if(ra===q.CLIENT_CHANNEL_MESSAGE&&sa==m.USER_GENERATED_MESSAGE){var ta=this._threads.getThreadMetaNow(qa.thread_id);if(ta&&ta.folder)qa.folder=ta.folder;}return qa;},handleUpdates:function(qa,ra,sa,ta){var ua,va={},wa={};for(var xa=0;xa<qa.length;xa++){var ya=this._preprocessIncomingAction(qa[xa],sa),za=ya.action_type,ab=ha(this,ya.message_id);if(ya.is_forward||sa==q.SERVER_SEARCH){if(!this._messages.has(ya.message_id))this._addNewMessage(ya.message_id,ya);continue;}else if(ya.client_state===p.SEND_TO_SERVER){this._addNewMessage(ya.message_id,ya);continue;}else if(za==m.SEND_MESSAGE){var bb=ya.client_message_id;if(bb&&this._localIdsMap[bb]&&ya.status){var cb=ha(this,bb),db=cb.status;if(cb.status==l.SUCCESS)continue;if(ya.status==l.UNCONFIRMED){if(!wa[ya.thread_id])wa[ya.thread_id]=[];wa[ya.thread_id].push(bb);}else if(!va[ya.thread_id])va[ya.thread_id]=[];this._updateLocalMessage(ya);if(typeof db!==(void 0)||ya.status==l.FAILED_UNKNOWN_REASON||ya.status==l.UNABLE_TO_CONFIRM||ya.status==l.SUCCESS||ya.status==l.ERROR)this._emitUpdatedChange(ya.thread_id,ha(this,bb).message_id,sa);}continue;}else if(za==m.DELETE_THREAD){ja(this,ya.thread_id).removeAllResources();continue;}else if(za==m.DELETE_MESSAGES){this._deleteMessages(ya.thread_id,ya.message_ids,sa);continue;}else if(za===m.MARK_MESSAGES_SPAM){this._markMessagesSpam(ya,sa);continue;}else if((ya.threading_id&&this._localIdsMap[ya.threading_id])||(ab&&!ab.is_forward)){if(ab&&ya.ranges&&ya.ranges.length>0){var eb=ab.message_id;this._updateMessage(this._localIdsMap[eb]||eb,ab,{ranges:qa.ranges});this._emitUpdatedChange(ab.thread_id,ab.message_id,'link_shim');}continue;}else if(za===m.CONFIRM_ATTACHMENT_PLACEHOLDER){this._confirmAttachmentPlaceholder(ya.upload_id,ya.upload_data);continue;}else if(za===m.CANCEL_ATTACHMENT_PLACEHOLDER){this._cancelAttachmentPlaceholder(ya.upload_id,ya.upload_data);continue;}else{if(sa===q.CLIENT_SEND_MESSAGE){this._localIdsMap[ya.message_id]=ya.message_id;if(ya.thread_id=='root:'+ya.message_id)ja(this,ya.thread_id).setReachedEndOfArray();}if(za==m.LOG_MESSAGE&&ya.log_message_type==o.SERVER_ERROR)this._failedHistoryFetchThreads[ya.thread_id]=true;if(ya.client_state===p.DO_NOT_SEND_TO_SERVER&&ya.upload_id)this._uploadMessages[ya.upload_id]=ya;if(!va[ya.thread_id])va[ya.thread_id]=[];va[ya.thread_id].push(ya.message_id);this._addNewMessage(ya.message_id,ya);if(ya.threading_id&&ya.threading_id!=ya.message_id)t.addServerID(ya.threading_id,ya.message_id);if(ya[v.MANUAL_RETRY_CNT]>0){ua=ja(this,ya.thread_id);ua.resortResources([ya.message_id]);this._emitReorderedChange(ya.thread_id,q.CLIENT_SEND_MESSAGE);}ra=ra||this._shouldSortOutOfOrderMessages(sa,ya.thread_id,ya.timestamp);if(!ra)this._emitReceivedChange(ha(this,ya.message_id));continue;}}for(var fb in va){ua=ja(this,fb);var gb=ua.getAllResources(),hb=gb.filter(function(jb){var kb=this._messages.get(jb);return kb.action_type==m.LOG_MESSAGE&&kb.log_message_type==o.SERVER_ERROR;}.bind(this));ua.removeResources(hb);if(ta)na(this,fb,va[fb]);if(ra){ua.addResources(va[fb]);this._emitReorderedChange(fb,sa);}else ua.addResourcesWithoutSorting(va[fb].reverse(),0);this._threadInformer.updatedThread(fb);}var ib=Object.keys(wa);if(ib.length)this._serverRequests.requestMessageConfirmation(wa);ga.debug('handle_updates',{localMessageCounts:ea(this._localTitanMessagesCount)});},isFirstMessage:function(qa){var ra=ja(this,qa.thread_id);if(ra.getCurrentArraySize()===0)return false;var sa=ra.getResourceAtIndex(ra.getCurrentArraySize()-1),ta=ha(this,sa).message_id,ua=ha(this,qa.message_id).message_id;return ra.hasReachedEndOfArray()&&ta==ua;},_markMessagesSpam:function(qa,ra){var sa=qa,ta=sa.thread_id,ua=sa.message_ids;if(!ua.length)return;this._deleteIndividualMessages(ta,ua,ra);this._serverRequests.markMessagesSpam(ta,ua);},_deleteMessages:function(qa,ra,sa){if(!ra.length)return;this._deleteIndividualMessages(qa,ra,sa);if(sa!==q.CLIENT_CHANNEL_MESSAGE)this._serverRequests.deleteMessages(qa,ra);},_deleteIndividualMessages:function(qa,ra,sa){var ta=ra.map(function(va){return ha(this,va).message_id;},this),ua=ja(this,qa);ua.removeResources(ta);this._emitReorderedChange(qa,sa);},_updateLocalMessage:function(qa){var ra=ha(this,qa.client_message_id),sa={};sa.status=qa.status;if(qa.status===l.SUCCESS||qa.error_data)sa.error_data=qa.error_data;var ta=qa.message_id,ua=qa.client_message_id;if(this._messages.has(ta)){this._updateMessage(ta,ra,sa);return false;}if(qa.timestamp)sa.timestamp=qa.timestamp;if(qa.log_message_data)sa.log_message_data=qa.log_message_data;if(qa.ranges&&qa.ranges.length){pa(qa);sa.ranges=qa.ranges;}if(qa.attachments&&qa.attachments.length){sa.raw_attachments=null;sa.attachments=qa.attachments;}this._localIdsMap[ua]=ta;t.addServerID(ua,ta);var va=this._updateMessage(ta,ra,sa);this._messages.set(ua,new i());if(oa(va))this._localTitanMessagesCount[va.thread_id]--;return true;},getNumberLocalMessages:function(qa){return this._localTitanMessagesCount[qa]||0;},_uploadMessages:{},_confirmAttachmentPlaceholder:function(qa,ra){var sa=this._popPendingAttachmentMessage(qa,ra);this._serverRequests.sendNewMessage(sa);},_cancelAttachmentPlaceholder:function(qa,ra){var sa=this._popPendingAttachmentMessage(qa,ra);this._deleteIndividualMessages(sa.thread_id,[sa.message_id]);if(this._localTitanMessagesCount[sa.thread_id])this._localTitanMessagesCount[sa.thread_id]--;},_popPendingAttachmentMessage:function(qa,ra){var sa=this._uploadMessages[qa];ca(sa);sa.image_ids=ra.image_ids;sa.file_ids=ra.file_ids;sa.audio_ids=ra.audio_ids;sa.gif_ids=ra.gif_ids;sa.client_state=p.SEND_TO_SERVER;delete this._uploadMessages[qa];return sa;},_emitUpdatedChange:function(qa,ra,sa){this._didChange=true;this._threadInformer.updatedMessage(qa,ra,sa);},_emitReceivedChange:function(qa){this._didChange=true;this._threadInformer.receivedMessage(qa);},_emitReorderedChange:function(qa,ra){this._didChange=true;this._threadInformer.reorderedMessages(qa,ra);}});Object.assign(la,r,{addListener:function(qa,ra){return fa.addListener(qa,ra);}});function ma(qa,ra){var sa=ra.map(ha.bind(null,qa));return sa.reverse();}function na(qa,ra,sa){var ta=sa.filter(function(ua){return oa(ha(qa,ua));});if(!qa._localTitanMessagesCount[ra])qa._localTitanMessagesCount[ra]=0;qa._localTitanMessagesCount[ra]+=ta.length;}function oa(qa){var ra=qa.action_type;if(ra==m.USER_GENERATED_MESSAGE)return true;switch(qa.log_message_type){case o.SUBSCRIBE:case o.UNSUBSCRIBE:case o.SERVER_ERROR:case o.LIVE_LISTEN:return false;default:return true;}}function pa(qa){if(!qa.ranges)return;qa.ranges.forEach(function(ra){if(!ra.entity||ra.entity.external||!ra.entity.url)return;var sa=new aa(ra.entity.url);if(da(aa.getRequestURI())&&!sa.getDomain()){sa.setProtocol('https').setDomain('www.facebook.com');ra.entity.url=sa.toString();}});}e.exports=la;},null);
__d("ImageSourceType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={PROFILE_PICTURE:'profile_picture',IMAGE:'image'};e.exports=g;},null);
__d("ImageSourceRequest",["CurrentUser","ImageSourceType","KeyedCallbackManager","PhotoResizeModeConst","MercuryServerDispatcher","arrayContains","extendArray"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();function n(){"use strict";this._request={fbid:null,type:null,width:null,height:null,resize_mode:null};this._callback=null;}n.prototype.setFBID=function(r){"use strict";this._request.fbid=r;return this;};n.prototype.setType=function(r){"use strict";if(!l([h.PROFILE_PICTURE,h.IMAGE],r))throw new TypeError('ImageSourceRequest.setType: invalid type '+r);this._request.type=r;return this;};n.prototype.setDimensions=function(r,s){"use strict";this._request.width=r;this._request.height=s;return this;};n.prototype.setResizeMode=function(r){"use strict";if(!l([j.COVER,j.CONTAIN],r))throw new TypeError('ImageSourceRequest.setResizeMode: invalid resize mode '+r);this._request.resize_mode=r;return this;};n.prototype.setCallback=function(r){"use strict";this._callback=r;return this;};n.prototype.send=function(){"use strict";if(!this._request.fbid||!this._request.width||!this._request.height||!this._request.type||!this._request.resize_mode||!this._callback)throw new Error('ImageSourceRequest: You must set all the fields');var r=p(),s=q(this._request);r.executeOrEnqueue(s,this._callback);if(r.getUnavailableResourcesFromRequest(s).length===1){k.trySend('/ajax/image_source.php',{requests:[this._request]});return true;}return false;};var o=null;function p(){if(o)return o;var r=new i();o=r;k.registerEndpoints({'/ajax/image_source.php':{request_user_id:g.getID(),mode:k.BATCH_DEFERRED_MULTI,batch_function:function(s,t){m(s.requests,t.requests);return s;},handler:function(s,t){var u=t.getData().requests;for(var v=0;v<u.length;++v)r.setResource(q(u[v]),s[v]);}}});return r;}function q(r){return [r.fbid,r.type,r.width,r.height,r.resize_mode].join('|');}e.exports=n;},null);
__d("MercuryParticipantFetcher",["LogHistory","MercuryIDs","MercuryPayloadSource","MercuryServerRequests","Set","ShortProfiles","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g.getInstance('short_profiles');function o(q){this.$MercuryParticipantFetcher0=j.getForFBID(q);this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2=new k();this.$MercuryParticipantFetcher3=new k();}o.prototype.fetch=function(q){this.$MercuryParticipantFetcher4(q);this.$MercuryParticipantFetcher5();};o.prototype.fetchMulti=function(q){q.forEach(function(r){return this.$MercuryParticipantFetcher4(r);}.bind(this));this.$MercuryParticipantFetcher5();};o.prototype.$MercuryParticipantFetcher4=function(q){if(!this.$MercuryParticipantFetcher3.has(q))this.$MercuryParticipantFetcher2.add(q);};o.prototype.$MercuryParticipantFetcher5=function(){if(this.$MercuryParticipantFetcher1||this.$MercuryParticipantFetcher2.size===0)return;this.$MercuryParticipantFetcher1=true;m(function(){this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2.forEach(function(q){return this.$MercuryParticipantFetcher3.add(q);}.bind(this));this.$MercuryParticipantFetcher6(this.$MercuryParticipantFetcher2,function(q){q.forEach(function(r){return this.$MercuryParticipantFetcher3["delete"](r.id);}.bind(this));this.$MercuryParticipantFetcher7(q);}.bind(this));this.$MercuryParticipantFetcher2.clear();}.bind(this));};o.prototype.$MercuryParticipantFetcher6=function(q,r){var s=[];q.forEach(function(t){var u=h.tokenize(t),v=u.type,w=u.value;v==='fbid'&&s.push(w);});if(s.length>0){l.getMulti(s,function(t){var u=[];for(var v in t)u.push(p(t[v],v));r(u);if(u.length!==s.length)n.error('server_fetch_participant_count_error',{expectedIDs:s,receivedIDs:Object.keys(t)});});n.debug('client_fetch_participants',{userIDs:s});}};o.prototype.$MercuryParticipantFetcher7=function(q){this.$MercuryParticipantFetcher0.handleUpdate({participants:q,from_client:false,payload_source:i.SERVER_FETCH_PARTICIPANTS});};function p(q,r){var s=Object.assign({gender:q.gender,href:q.uri,id:h.getParticipantIDFromUserID(q.id||r),image_src:q.thumbSrc,name:q.name,short_name:q.firstName,employee:q.employee,is_employee_away:q.is_employee_away,type:q.type,vanity:q.vanity,is_friend:q.is_friend,is_messenger_user:q.is_messenger_user,orion_eligible:q.orionEligible,social_snippets:q.social_snippets},{});if(q.officeStatus){s.officeStatus=q.officeStatus;s.officeStatusStartDate=q.officeStatusStartDate;s.officeStatusEndDate=q.officeStatusEndDate;s.officeStatusComment=q.officeStatusComment;s.officeStatusLocation=q.officeStatusLocation;}return s;}e.exports=o;},null);
__d("MercuryParticipants",["CurrentUser","EventEmitter","ImageSourceRequest","ImageSourceType","ImmutableObject","KeyedCallbackManager","Map","MercuryAssert","MercuryIDs","MercuryParticipantFetcher","MercuryParticipantTypes","MercuryParticipantsConstants","MercuryServerRequests","PhotoResizeModeConst","Set","fbt","mapObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();'use strict';var x='change';function y(aa){this.$MercuryParticipants0=aa;this.$MercuryParticipants1=new h();this.$MercuryParticipants2=new l();this.$MercuryParticipants3=new p(this.$MercuryParticipants0);this.$MercuryParticipants4=new m();this.$MercuryParticipants5=s.getForFBID(this.$MercuryParticipants0);this.$MercuryParticipants5.subscribe('update-participants',function(ba,ca){if(ca.participants&&ca.participants.length>0){var da={};ca.participants.forEach(function(ea){da[ea.id]=ea;});this.$MercuryParticipants6(da);}}.bind(this));}y.prototype.addListener=function(aa,ba){return this.$MercuryParticipants1.addListener(aa,ba);};y.prototype.getIDFromVanityOrFBID=function(aa){if(!aa)return;if(this.$MercuryParticipants4.has(aa))return this.$MercuryParticipants4.get(aa);if(/^\d+$/.test(aa))return o.getParticipantIDFromUserID(aa);};y.prototype.getNow=function(aa){return this.$MercuryParticipants7(aa);};y.prototype.getOrFetch=function(aa){var ba=this.$MercuryParticipants7(aa);if(!ba)this.$MercuryParticipants3.fetch(aa);return ba;};y.prototype.get=function(aa,ba){n.isParticipantID(aa);return this.$MercuryParticipants8([aa],function(ca){ba(ca[aa]);});};y.prototype.getMulti=function(aa,ba){return this.$MercuryParticipants8(aa,ba);};y.prototype.getBigImageMulti=function(aa,ba){n.allParticipantIDs(aa);var ca=r.BIG_IMAGE_SIZE;return this.$MercuryParticipants8(aa,function(da){var ea={},fa=0,ga=new u(),ha=function(la,ma){fa++;ea[la]=ma;if(fa===aa.length){ba(ea);if(ga.size>0)this.$MercuryParticipants9(ga);}}.bind(this),ia=function(la,ma){this.$MercuryParticipants2.setResource(la,k.set(this.$MercuryParticipants2.getResource(la),{big_image_src:ma.uri}));ga.add(la);ha(la,ma.uri);}.bind(this);for(var ja in da){var ka=da[ja];if(!ka.big_image_src){new i().setFBID(o.getUserIDFromParticipantID(ja)).setType(j.PROFILE_PICTURE).setDimensions(ca,ca).setResizeMode(t.COVER).setCallback(ia.bind(null,ja)).send();}else ha(ka.id,ka.big_image_src);}}.bind(this));};y.prototype.getOrderedBigImageMulti=function(aa,ba){return this.getBigImageMulti(aa,function(ca){ba(aa.map(function(da){return ca[da];}));});};y.prototype.$MercuryParticipants8=function(aa,ba){n.allParticipantIDs(aa);var ca=this.$MercuryParticipants2.executeOrEnqueue(aa,ba),da=this.$MercuryParticipants2.getUnavailableResources(ca).filter(function(ea){var fa=o.tokenize(ea),ga=fa.type,ha=fa.value;if(ga==='email'){this.$MercuryParticipantsa(ea,ha);return false;}return true;}.bind(this));this.$MercuryParticipants3.fetchMulti(da);return this.$MercuryParticipantsb(ca);};y.prototype.$MercuryParticipants7=function(aa){var ba=this.$MercuryParticipants2.getResource(aa);if(!ba){var ca=o.tokenize(aa),da=ca.type,ea=ca.value;if(da==='email')ba=this.$MercuryParticipantsa(aa,ea);}return ba;};y.prototype.$MercuryParticipantsa=function(aa,ba){var ca=new k(z(aa,ba));this.$MercuryParticipants2.setResource(aa,ca);return ca;};y.prototype.$MercuryParticipants9=function(aa){this.$MercuryParticipants1.emit(x,aa);};y.prototype.$MercuryParticipants6=function(aa){aa=w(aa,function(ba,ca){if(ba.vanity)this.$MercuryParticipants4.set(ba.vanity,ca);return new k(this.$MercuryParticipantsc(ba));}.bind(this));this.$MercuryParticipants2.addResourcesAndExecute(aa);this.$MercuryParticipants9(new u(Object.keys(aa)));};y.prototype.$MercuryParticipantsc=function(aa){var ba=aa.type===q.USER||aa.type===q.FRIEND;if(!ba)return aa;if(!aa.name&&!aa.href&&!aa.vanity){var ca=v._("Facebook User");aa.name=ca;aa.short_name=ca;}return aa;};y.prototype.$MercuryParticipantsb=function(aa){return {remove:function(){this.$MercuryParticipants2.unsubscribe(aa);}.bind(this)};};function z(aa,ba){return {gender:r.UNKNOWN_GENDER,href:null,id:aa,image_src:r.EMAIL_IMAGE,big_image_src:r.EMAIL_IMAGE,name:ba,short_name:ba,employee:false};}e.exports=new y(g.getID());},null);
__d("MercuryShareAttachment.react",["MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareStyleMap","React","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=j,o=n.PropTypes,p=j.createClass({displayName:"MercuryShareAttachment",propTypes:{attachment:g,location:o.oneOf(h.getValues()),onComponentLoaded:o.func.isRequired},getDefaultProps:function(){return {onComponentLoaded:l};},componentDidMount:function(){this.props.onComponentLoaded(j.findDOMNode(this));},_renderComponent:function(q,r){if(this.props.location===h.MESSENGER){return (j.createElement("div",{className:m("_haj _5i_d _2poz _52mr _ui9",r)},q));}else return !!r?j.createElement("div",{className:r},q):q;},render:function(){var q=i.getStyleFactory(this.props.attachment);if(q){var r=q.factory.getComponent();return (this._renderComponent(j.createElement(r,j.__spread({},this.props,{attachment:q.attachment})),!!q.factory.cx?q.factory.cx.get(this.props.location):null));}return null;}});e.exports=p;},null);
__d("XStickerAssetController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/asset\/",{sticker_id:{type:"Int",required:true},image_type:{type:"Enum",defaultValue:"BestEffortImage",enumType:1}});},null);
__d("MessengerHotLikeUtils",["StickerAssetType","StickerConstants","XStickerAssetController"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j={SizeTimes:{small:500,medium:1200,large:3000},getStickerIDForTime:function(k){var l=null;switch(true){case k<this.SizeTimes.small:l=h.HOT_LIKE_SMALL_STICKER_ID;break;case k<this.SizeTimes.medium:l=h.HOT_LIKE_MEDIUM_STICKER_ID;break;case k<this.SizeTimes.large:l=h.HOT_LIKE_LARGE_STICKER_ID;break;}return l;},getGrowCoefficientForSince:function(k){return Math.min(1,(Date.now()-k)/this.SizeTimes.large);},getMetadataForHotLike:function(k){var l;switch(k){case h.HOT_LIKE_LARGE_STICKER_ID:l=120;break;case h.HOT_LIKE_MEDIUM_STICKER_ID:l=84;break;case h.HOT_LIKE_SMALL_STICKER_ID:l=35;break;}return l?{height:l,width:l}:(void 0);},getPreviewURI:function(){return i.getURIBuilder().setInt('sticker_id',h.HOT_LIKE_LARGE_STICKER_ID).setEnum('image_type',g.IMAGE).getURI().toString();},getURIWithID:function(k){return i.getURIBuilder().setInt('sticker_id',k).setEnum('image_type',g.IMAGE).getURI().toString();}};e.exports=j;},null);
__d("XStickerPackImagesController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int",defaultValue:50}});},null);
__d("XStickersAddPackController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/addpack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},is_promoted:{type:"Bool",defaultValue:false}});},null);
__d("XStickersRemovePackController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/removepack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"}});},null);
__d("XStickerStateInitialDataController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/state\/",{});},null);
__d("XStickerStatePackDataController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});},null);
__d("XStickerStateStoreDataController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/state\/store\/",{});},null);
__d("XStickerSearchPromotePackController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/search\/promotePack\/",{sticker_id:{type:"Int",required:true}});},null);
__d("XStickerSearchNUXSeenController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/searchNUX\/seen\/",{});},null);
__d("XStickerTagDataController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/tag\/data\/",{});},null);
__d("XStickerQueryImagesController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/query\/images\/",{query:{type:"String",required:true}});},null);
__d("StickerServerRequests",["AsyncRequest","Promise","XStickerPackImagesController","XStickersAddPackController","XStickersRemovePackController","XStickerStateInitialDataController","XStickerStatePackDataController","XStickerStateStoreDataController","XStickerSearchPromotePackController","XStickerSearchNUXSeenController","XStickerTagDataController","XStickerQueryImagesController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();'use strict';var s={addPack:function(u,v,w){var x=j.getURIBuilder().setInt('pack_id',u).setBool('is_promoted',v).getURI();new g(x).setHandler(function(y){return w(y.payload);}).send();},removePack:function(u,v){var w=k.getURIBuilder().setInt('pack_id',u).getURI();new g(w).setHandler(function(x){return v(x.payload);}).send();},getStickersForPack:function(u,v){var w=i.getURIBuilder().setInt('pack_id',u).setInt('sticker_size',v).getURI();return new h(function(x,y){return new g().setURI(w).setMethod("POST").setHandler(function(z){return x(z.payload);}).send();});},getStickersForQuery:function(u,v){new g().setURI(r.getURIBuilder().setString('query',u).getURI()).setMethod("POST").setHandler(function(w){return v(w);}).send();},fetchTrayData:function(u){return t(l.getURIBuilder().getURI(),u,true);},fetchStoreData:function(u){return t(n.getURIBuilder().getURI(),u);},fetchPackData:function(u,v){return t(m.getURIBuilder().setInt('pack_id',u).getURI(),v);},fetchTagData:function(u){return t(q.getURIBuilder().getURI(),u,true);},markSeenSearchNUX:function(){new g(p.getURIBuilder().getURI().toString()).send();},promotePackSentFromSearch:function(u,v){var w=o.getURIBuilder().setInt('sticker_id',u).getURI();t(w,v,true);}};function t(u,v,w){return new h(function(x,y){return new g(u).setHandler(function(z){return x(z.getPayload());}).setAllowCrossPageTransition(w).send();}).then(v);}e.exports=s;},null);
__d("StickerImages",["StickerServerRequests"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h={},i={},j={},k={getStickerTagsData:function(){return j;},requestStickersForPack:function(l,m,n){if(!l)return;if(!i[l]){i[l]=g.getStickersForPack(l,m);i[l].then(function(o){o.forEach(function(p){return this.cacheSticker(p);}.bind(this));}.bind(this));}i[l].then(function(o){return n(o);});},cacheSticker:function(l){h[l.id]=l;},getSticker:function(l){return h[l];}};e.exports=k;},null);
__d("StickerUtils",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={getScaledDimensions:function(h,i,j){var k,l,m;if(i>h){m=j/i;k=h*m;l=i*m;}else{m=j/h;k=h*m;l=i*m;}return {height:Math.round(k),width:Math.round(l)};},capitalizeWords:function(h){var i=h.split(" ");for(var j=0;j<i.length;j++){var k=i[j].charAt(0).toUpperCase();i[j]=k+i[j].substr(1);}return i.join(" ");}};e.exports=g;},null);
__d("updatePhotoProgressBar",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';function g(h,event){if(event.loaded!=event.total){h.setPosition(50*event.loaded/event.total);}else{h.setPosition(50);h.setTarget(100,2000);}}e.exports=g;},null);
__d("XLinkshimLogController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/si\/ajax\/l\/render_linkshim_log\/",{u:{type:"String",required:true},h:{type:"String",required:true},render_verification:{type:"Bool",defaultValue:false},enc:{type:"String"},d:{type:"String"}});},null);
__d("LinkshimHandler",["Event","LinkshimAsyncLink","LinkshimHandlerConfig","URI","XLinkshimLogController","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={setUpLinkshimHandling:function(s){try{var u=new j(s.getAttribute('href')),v=n(u);if(v&&o(u)){g.listen(s,'mouseover',l(h.swap,null,s,v));var w=q(u);g.listen(s,'click',function(){if(i.supports_meta_referrer){h.referrer_log(s,w,p(u).toString());}else h.swap(s,u);});}}catch(t){}}};function n(s){return s.getQueryData().u?new j(s.getQueryData().u):null;}function o(s){return s.getQueryData().hasOwnProperty('s');}function p(s){var t=s.getQueryData().hasOwnProperty('enc')?s.getQueryData().enc:'';return (k.getURIBuilder()).setString('u',s.getQueryData().u).setString('h',s.getQueryData().h).setBool('render_verification',s.getQueryData().hasOwnProperty('render_verification')).setString('enc',t).getURI();}function q(s){var t;if(r()){t=new j(s).addQueryData({render_verification:true});}else t=n(s);return t;}function r(){var s=i.render_verification_rate||0;return Math.floor(Math.random()*s+1)===s;}e.exports=m;},null);
__d("MercuryAttachmentRenderer",["MercuryAttachmentTemplates","MercuryAttachmentAudioClip.react","Bootloader","ChatAnimatedGifs","SyncRequest.react","P2PMercuryAttachment.react","CSS","MercuryConstants","DOM","Event","MercuryAttachment","MercuryAttachmentPhoto.react","MercuryAttachmentPhotoGrid.react","MercuryAttachmentType","MercuryAttachmentVideo.react","MercuryConfig","MercuryIDs","MercuryMessageInfo","MercuryParticipants","MercuryShareAttachment.react","MercuryShareAttachmentRenderLocations","MercuryViewer","MessengerHotLikeUtils","ProgressBar","React","Sticker.react","StickerAssetType","StickerConstants","StickerImages","StickerUtils","Style","URI","UserAgent_DEPRECATED","cx","fbt","invariant","updatePhotoProgressBar","XStickerAssetController","MercuryMessages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra){b.__markCompiled&&b.__markCompiled();'use strict';var sa=b('MercuryMessages').get(),ta=ma.ie()<=8;function ua(xa,ya){var za=g[ya].build().setNodeContent('filename',xa.name),ab=za.getNode('link');ab.setAttribute('href',xa.url);xa.rel&&ab.setAttribute('rel',xa.rel);m.addClass(za.getRoot(),q.getAttachIconClass(xa.icon_type));return za;}function va(xa,ya){var za=g[ya].build().setNodeContent('filename',xa.name);m.addClass(za.getRoot(),q.getAttachIconClass(xa.icon_type));return za;}var wa={renderAttachment:function(xa,ya,za,ab,bb,cb){var db=100,eb=xa?160:400,fb=null,gb=null,hb=n.MercurySupportedShareType;if(this.isErrorAttachment(ya))fb=wa.renderError(ya);if(this.isStoryBasedShare(ya)){gb=o.create('div',{className:((za.body&&xa?"_r38":''))});var ib=xa?aa.CHAT:aa.WEB_INBOX;ea.render(ea.createElement(z,{attachment:ya.share,location:ib,maxWidth:ab}),gb);}if(!gb&&this.isShareAttachment(ya)&&ya.share_xhp&&(ya.share_data_type===hb.FB_BROWSE_QUERY||!xa))gb=wa.renderShareXHP(ya,za.id);if(this.isStickerAttachment(ya))gb=wa.renderSticker(ya,za,xa,cb);if(!gb&&this.isShareAttachment(ya)){var jb=ya.share_data_type;switch(jb){case hb.FB_PHOTO:gb=wa.renderPreview(ya,za,ab,bb);break;case hb.FB_VIDEO:gb=wa.renderVideoThumb(ya);break;case hb.FB_MUSIC_ALBUM:case hb.FB_SONG:case hb.FB_PLAYLIST:case hb.FB_MUSICIAN:case hb.FB_RADIO_STATION:gb=wa.renderMusic(ya);break;case hb.EXTERNAL:case hb.FB_TEMPLATE:case hb.FB_SOCIAL_REPORT_PHOTO:gb=wa.renderExternalLink(ya);break;case hb.FB_COUPON:case hb.FB_EVENT:gb=wa.renderChatXHP(ya);break;case hb.FB_SOCIAL_RESOLUTION:case hb.FB_STATUS:gb=wa.renderSocialResolution(ya);break;case hb.FB_SYNC_REQUEST:gb=wa.renderSyncRequest(ya);break;case hb.FB_OPEN_GRAPH:gb=wa.renderOpenGraph(ya);break;case hb.FB_ORION:gb=wa.renderP2PMercuryAttachment(ya,xa);break;case hb.FB_GENERIC_SHAREABLE:gb=wa.renderGenericShareable(ya);break;default:if(ya.name)gb=wa.renderShareLink(ya,za&&za.id,xa);break;}}if(!gb&&ya.preview_loading)gb=wa.renderPreview(ya,za,ab,bb);if(!gb&&this.isVideoAttachment(ya)){gb=o.create('div');ea.render(wa.renderVideo(ya,xa,za),gb);}if(!gb&&ya.preview_url)gb=wa.renderPreview(ya,za,ab,bb);if(!gb&&this.isFileAttachment(ya))if(ya.metadata&&q.isVoiceMessage(ya.metadata.type)){gb=o.create('div');var kb=wa.renderAudioClip(ya,za.message_id,db,eb);ea.render(kb,gb);}else gb=xa?wa.renderFileLink(ya):wa.renderExtendedFileLink(ya);if(v.MercuryStoryAttachmentsGK&&!(this.isShareAttachment(ya)&&ya.share)&&gb)m.addClass(gb,"_1t06");return {error:fb,content:gb,bubblePreferred:this.isBubblePreferred(ya)};},isBubblePreferred:function(xa){return !this.isStickerAttachment(xa)&&!this.isSyncRequestAttachment(xa);},renderError:function(xa){var ya=g[':fb:mercury:attachment:error'].build();o.appendContent(ya.getNode('error'),xa.error_msg);return ya.getRoot();},renderSocialResolution:function(xa){var ya=g[':fb:mercury:attachment:social-resolution'].build();ya.setNodeContent('post',xa.share_xhp);return ya.getRoot();},renderChatXHP:function(xa){var ya=g[':fb:mercury:attachment:social-resolution'].build();ya.setNodeContent('post',xa.chat_xhp);return ya.getRoot();},renderOpenGraph:function(xa){var ya=xa.share_xhp.cloneNode(true);if(ma.firefox())ka.set(ya,'minWidth','180px');return ya;},renderGenericShareable:function(xa){return wa.renderExternalLink(xa);},renderExternalLink:function(xa){var ya=g[':fb:mercury:attachment:external-link'].build().setNodeContent('name',xa.name);xa.base_url&&ya.setNodeContent('shortLink',xa.base_url);var za=ya.getNode('preview'),ab=ya.getNode('image-link');ab.setAttribute('href',xa.url);xa.rel&&ab.setAttribute('rel',xa.rel);if(xa.preview_url){var bb=ya.getNode('preview-image'),cb=xa.preview_url,db=new la(j.getRawUrlFromSafeUrl(cb));if(xa.animated_gif_uri){cb=new la(xa.animated_gif_uri);m.addClass(za,"_dri");if(xa.name&&xa.name.__html==db.toString())ya.setNodeContent('name','');}bb.setAttribute('src',cb);xa.preview_class&&m.addClass(za,xa.preview_class);m.show(bb);}else{m.addClass(ya.getRoot(),'noMedia');m.hide(za);}ya.getNode('name').setAttribute('href',xa.url);d(['LinkshimHandler'],function(eb){eb.setUpLinkshimHandling(ya.getNode('name'));eb.setUpLinkshimHandling(ya.getNode('image-link'));});if(xa.rel)ya.getNode('name').setAttribute('rel',xa.rel);return ya.getRoot();},renderFileLink:function(xa){var ya=null;if(xa.url===''){ya=':fb:mercury:attachment:file-name';return va(xa,ya).getRoot();}else{ya=':fb:mercury:attachment:file-link';return ua(xa,ya).getRoot();}},renderAudioClip:function(xa,ya,za,ab){var bb=xa.metadata.duration/1000,cb=200;if(za&&ab)if(bb<5){cb=za;}else cb=(1-Math.pow(10,(bb-5)/-30))*(ab-za)+za;return (ea.createElement(h,{src:xa.url,duration:xa.metadata.duration/1000,showHelp:false,width:cb}));},renderVideo:function(xa,ya,za){var ab=ya?xa.metadata.chat_size:xa.metadata.inbox_size,bb=ya?xa.metadata.chat_preview:xa.metadata.inbox_preview,cb=xa.metadata.dimensions;if(!ab){bb=xa.thumbnail_url;ab=cb={height:xa.preview_height,width:xa.preview_width};}return (ea.createElement(u,{duration:xa.metadata.duration,isInbound:x.isInbound(za),isChat:ya,name:xa.name,pageID:xa.metadata.pageid,thumbSize:ab,thumbnail:bb,videoSize:cb,videoID:xa.metadata.fbid,videoURI:xa.url}));},renderExtendedFileLink:function(xa){var ya=null;if(xa.url===''){ya=':fb:mercury:attachment:file-name';return va(xa,ya).getRoot();}ya=':fb:mercury:attachment:extended-file-link';var za=ua(xa,ya);if(xa.open_url){var ab=za.getNode('openLinkContainer');m.show(ab);var bb=za.getNode('openFile');bb.setAttribute('href',xa.open_url);}var cb=za.getNode('downloadFile');cb.setAttribute('href',xa.url);xa.rel&&cb.setAttribute('rel',xa.rel);return za.getRoot();},renderMusic:function(xa){var ya=g[':fb:mercury:attachment:music'].build().setNodeContent('filename',xa.name),za=ya.getNode('link');za.setAttribute('href',xa.url);za.setAttribute('target','_blank');xa.rel&&za.setAttribute('rel',xa.rel);var ab=ya.getNode('image-link');ab.setAttribute('href',xa.url);xa.rel&&ab.setAttribute('rel',xa.rel);var bb=ya.getNode('preview-image');bb.setAttribute('src',xa.preview_url);m.show(bb);m.addClass(ya.getNode('icon_link'),'MercuryMusicIcon');return ya.getRoot();},renderSyncRequest:function(xa){var ya=k(xa.metadata),za=o.create('div');ea.render(ya,za);return za;},renderP2PMercuryAttachment:function(xa,ya){var za={metadata:xa.metadata};if(!ya)za.theme='messages';var ab=ea.createElement(l,ea.__spread({},za)),bb=o.create('div');ea.render(ab,bb);return bb;},resizeContain:function(xa,ya){var za=xa.width/xa.height,ab=ya.width/ya.height;if(ab<za){return {width:Math.ceil(Math.min(xa.height*ab,ya.width)),height:Math.ceil(Math.min(xa.height,ya.height))};}else return {width:Math.ceil(Math.min(xa.width,ya.width)),height:Math.ceil(Math.min(xa.width/ab,ya.height))};},renderPreview:function(xa,ya,za,ab){var bb=g[':fb:mercury:attachment:preview'].build(),cb=bb.getNode('image-link');if(xa){xa.url&&cb.setAttribute('href',xa.url);xa.rel&&cb.setAttribute('rel',xa.rel);if(xa.rel==='async'&&xa.hires_url){cb.setAttribute('href',xa.hires_url);cb.setAttribute('ajaxify',xa.url);}var db;if(xa.preview_uploading){var eb=bb.getNode('cancel-button-container');m.show(eb);var fb=bb.getNode('cancel-button'),gb=p.listen(fb,'click',function(){xa.upload_canceled(xa.upload_id);m.hide(bb.getRoot());gb.remove();});xa.on_success(function(event,nb){if(nb.upload_id==xa.upload_id){m.hide(eb);gb.remove();}});var hb=bb.getNode('progress-bar'),ib=new da(hb),jb=bb.getNode('progress-bar-container');pa(xa.upload_id);xa.on_progress(function(event,nb){if(nb.upload_id==xa.upload_id){m.removeClass(jb,"_395w");m.show(jb);qa(ib,nb.event);}});if(xa.on_resizing_progress)xa.on_resizing_progress(function(event,nb){if(nb.upload_id==xa.upload_id){m.addClass(jb,"_395w");m.show(jb);ib.setPosition(100*nb.event.written/nb.event.total);}});m.addClass(cb,"_57jm");if(za>=176){db='/images/photos/dots_large.png';}else if(za>=86){db='/images/photos/dots_medium.png';}else db='/images/photos/dots_small.png';ka.set(cb,'width',za+'px');ka.set(cb,'max-width',za+'px');if(xa.preview_width&&xa.preview_height)ka.set(cb,'padding-bottom',((xa.preview_height/xa.preview_width)*100)+'%');}else if(xa.preview_loading){m.addClass(cb,"_5xdv");if(ab==='contain'&&xa.preview_width&&xa.preview_height){ka.set(cb,'width',xa.preview_width+'px');ka.set(cb,'height',xa.preview_height+'px');}if(ab==='cover'&&!ta)m.addClass(cb,"_55pj");}else if(xa.metadata&&xa.metadata.fbid){db=new la('/ajax/mercury/attachments/photo.php').addQueryData({fbid:xa.metadata.fbid,request_user_id:xa.metadata.pageid,mode:ab,width:za,height:za}).toString();var kb=cb.getAttribute('ajaxify');cb.removeAttribute('ajaxify');cb.removeAttribute('rel');p.listen(cb,'click',function(event){event.prevent();i.loadModules(["MessagesViewer"],function(nb){nb.bootstrapWithConfig({src:db,endpoint:kb,fbid:xa.metadata.fbid,dimensions:xa.metadata.dimensions,disablePaging:ya&&ya.attachments.length==1},cb);});});}else db=new la(xa.preview_url).toString();var lb=bb.getNode('preview-image');if(db){if(ab==='contain'&&xa.preview_width&&xa.preview_height){var mb=wa.resizeContain({width:za,height:za},{width:xa.preview_width,height:xa.preview_height});lb.setAttribute('width',mb.width);lb.setAttribute('height',mb.height);}if(xa.preview_uploading||(ab==='cover'&&!ta)){m.addClass(cb,"_55pj");ka.set(cb,'backgroundImage','url('+db+')');}else{lb.onload=function(){lb.removeAttribute('width');lb.removeAttribute('height');};lb.setAttribute('src',db);}}if(ya)this.renderReportRespondLink(bb.getRoot(),xa,ya.message_id);}return bb.getRoot();},renderShareLink:function(xa,ya,za){var ab=g[':fb:mercury:attachment:share-link'].build().setNodeContent('name',xa.name),bb=ab.getNode('link');bb.setAttribute('href',xa.url);xa.rel&&bb.setAttribute('rel',xa.rel);return ab.getRoot();},renderVideoThumb:function(xa){var ya=g[':fb:mercury:attachment:video-thumb'].build(),za=ya.getNode('thumb');za.setAttribute('href',xa.url);za.setAttribute('rel',xa.rel);var ab=o.find(ya.getRoot(),'img');ab.src=xa.preview_url;return ya.getRoot();},renderShareXHP:function(xa,ya){var za=o.create('div');if(xa&&xa.share_xhp){o.appendContent(za,xa.share_xhp.markup);this.renderReportRespondLink(za,xa,ya);}return za;},constructStickerComponent:function(xa,ya,za,ab){var bb=ab?'chatScrolled/':'messengerScrolled/';bb+=xa.thread_id;if(!ya){ya=ca.getMetadataForHotLike(xa.sticker_id);if(!ya){var cb=ia.getSticker(xa.sticker_id),db=Object.assign({},cb),eb=ja.getScaledDimensions(cb.height,cb.width,ha.THREAD_SIZE),fb=eb.height,gb=eb.width;db.height=fb;db.width=gb;db.stickerID=xa.sticker_id;db.spriteURI='';db.spriteURI2x='';db.paddedSpriteURI='';db.paddedSpriteURI2x='';ya=db;}}var hb=null;if(ya.stickerID){hb=ya.stickerID.toString();}else if(xa.sticker_id)hb=xa.sticker_id.toString();var ib=null;if(ya.packID)ib=ya.packID.toString();var jb=ra.getURIBuilder().setInt('sticker_id',hb),kb=null,lb=null;if(window.devicePixelRatio&&window.devicePixelRatio>1){lb=ya.paddedSpriteURI2x;kb=ya.spriteURI2x;}else{lb=ya.paddedSpriteURI;kb=ya.spriteURI;}return (ea.createElement(fa,{animationTrigger:"hover",className:"mvs",frameCount:ya.frameCount||1,frameRate:ya.frameRate||83,framesPerCol:ya.framesPerCol||1,framesPerRow:ya.framesPerRow||1,onStickerClick:za,packID:ib,paddedSpriteURI:lb,sourceHeight:ya.height,sourceURI:jb.setEnum('image_type',ga.IMAGE).getURI().toString(),sourceWidth:ya.width,spriteURI:kb,stickerID:hb,subscribedThreadID:bb}));},renderSticker:function(xa,ya,za,ab){var bb=o.create('div');m.addClass(bb,'stickerContainer');var cb=this.constructStickerComponent(ya,xa.metadata,ab,za);ea.render(cb,bb);return bb;},renderReportRespondLink:function(xa,ya,za){if(!ya.is_social_report_attachment)return null;switch(ya.share_data_type){case n.MercurySupportedShareType.FB_PHOTO:break;case n.MercurySupportedShareType.FB_SOCIAL_REPORT_PHOTO:return null;default:return null;}var ab=null;if(za)ab=sa.getMessagesFromIDs([za])[0];if(!ab)return null;if(ab.author===ba.getID())return null;var bb=null;y.get(ab.author,function(cb){bb=o.create('a',{rel:'dialog-post',className:"_z6l",id:'respond-link',ajaxify:new la('/ajax/report/social_resolution/post/').setQueryData({attachment_fbid:ya.attach_id,post_fbid:ya.shared_object_id,sender_id:w.getUserIDFromParticipantID(cb.id)}).toString()});o.setContent(bb,oa._("Respond to {name}'s request",[oa.param("name",cb.name)]));o.appendContent(xa,bb);});},renderPhotoAttachments:function(xa,ya,za,ab,bb){var cb=xa.length;if(!cb)return null;var db=o.create('div',{className:(("_55pk")+(v.MercuryImageBubblesGK&&!!ya.body?' '+"_9id":''))});if(cb===1){if(v.MercuryImageBubblesGK&&!ya.body&&bb){var eb=xa[0],fb=wa.resizeContain({width:za,height:za},{width:eb.preview_width,height:eb.preview_height});ea.render(ea.createElement(r,{image:eb,width:fb.width,height:fb.height,message:ya}),db);}else{var gb=wa.renderPreview(xa[0],ya,za,'contain');o.appendContent(db,gb);}return db;}if(v.MercuryImageBubblesGK&&!ya.body&&bb){ea.render(ea.createElement(s,{images:xa,size:za,message:ya}),db);return db;}var hb=(cb==2||cb==4)?2:3,ib=(za-(hb-1)*ab)/hb,jb=Math.ceil(cb/hb),kb=jb*ib+(jb-1)*ab,lb=o.create('div',{className:"_55pm",style:'padding-bottom: '+(kb/za*100)+'%;'});o.appendContent(db,lb);for(var mb=0;mb<cb;++mb){var nb=wa.renderPreview(xa[mb],ya,ib,'cover'),ob=mb%hb,pb=Math.floor(mb/hb);m.addClass(nb,"_55pn");ka.apply(nb,{width:(ib/za*100)+'%',left:((ob*(ib+ab))/za*100)+'%',top:((pb*(ib+ab))/kb*100)+'%'});o.appendContent(lb,nb);}return db;},isPhotoAttachment:function(xa){return xa.attach_type==t.PHOTO||xa.attach_type==t.ANIMATED_IMAGE||(xa.attach_type==t.FILE&&xa.preview_url);},isVideoAttachment:function(xa){return xa.attach_type==t.VIDEO;},isShareAttachment:function(xa){return xa.attach_type==t.SHARE;},isStoryBasedShare:function(xa){return this.isShareAttachment(xa)&&!!xa.share;},isFileAttachment:function(xa){return xa.attach_type==t.FILE;},isErrorAttachment:function(xa){return xa.attach_type==t.ERROR;},isStickerAttachment:function(xa){return xa.attach_type==t.STICKER;},isSyncRequestAttachment:function(xa){var ya=n.MercurySupportedShareType;return this.isShareAttachment(xa)&&xa.share_data_type==ya.FB_SYNC_REQUEST;},sortAttachmentsStablyByType:function(xa){var ya=[wa.isPhotoAttachment,wa.isShareAttachment,wa.isFileAttachment,wa.isErrorAttachment];ya.push(function(ab){return true;});var za=ya.map(function(ab){return [];});xa.forEach(function(ab){for(var bb=0;bb<ya.length;bb++)if(ya[bb](ab)){za[bb].push(ab);break;}});return Array.prototype.concat.apply([],za);},constructStoryBasedShareAttachment:function(xa,ya,za,ab,bb){var cb=za?aa.CHAT:aa.WEB_INBOX;return (ea.createElement("div",{className:((!!xa.body&&za?"_r38":''))},ea.createElement(z,{attachment:ya.share,location:cb,maxWidth:bb,onComponentLoaded:function(db){if(db&&ab)ab(db.firstChild,true);}})));}};e.exports=wa;},null);
__d("MercuryShareSizeImageByWidthMixin",["Image.react","MercuryAttachmentRenderer","MercuryShareAttachmentRenderLocations","MercuryShareImage.react","React"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={_getImageSize:function(m){var n=this.props.attachment&&this.props.attachment.media,o=m?n&&n.animated_image_size:n&&n.image_size;return this.props.maxWidth?h.resizeContain({height:this.props.maxWidth,width:this.props.maxWidth},o):o;},_renderImage:function(m){var n=this.props.attachment&&this.props.attachment.media,o=this._getImageSize(m),p=m?n&&n.animated_image:n&&n.image;if(this.props.location==i.CHAT){return (k.createElement(j,{height:o&&o.height,source:p,width:o&&o.width}));}else return (k.createElement(g,{height:o&&o.height,src:p,width:o&&o.width}));}};e.exports=l;},null);
__d("MercuryPhotoShareAttachment.react",["Link.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareSizeImageByWidthMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=l,n=m.PropTypes,o=l.createClass({displayName:"MercuryPhotoShareAttachment",mixins:[k],propTypes:{attachment:i,location:n.oneOf(j.getValues()),maxWidth:n.number},render:function(){if(this.props.location===j.MESSENGER||this.props.location===j.CHAT_PREVIEW)return l.createElement(h,l.__spread({},this.props));var p=this.props.attachment&&this.props.attachment.uri;return (l.createElement(g,{rel:"theater",href:p},this._renderImage()));}});e.exports=o;},null);
__d("MercuryPhotoShareSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryPhotoShareSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o=this.props.isViewerSender?j._("You sent a photo."):j._("{sender name} sent a photo.",[j.param("sender name",this.props.senderName)]);return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/icons/photo.gif')}),o));}});e.exports=n;},null);
__d("MercuryImageShareAttachment.react",["Link.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareSizeImageByWidthMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=l,n=m.PropTypes,o=l.createClass({displayName:"MercuryImageShareAttachment",mixins:[k],propTypes:{attachment:i,location:n.oneOf(j.getValues()),maxWidth:n.number},render:function(){if(this.props.location===j.MESSENGER||this.props.location===j.CHAT_PREVIEW)return l.createElement(h,l.__spread({},this.props));var p=this.props.attachment&&this.props.attachment.uri;return (l.createElement(g,{href:p,target:"_blank"},this._renderImage()));}});e.exports=o;},null);
__d("MercuryVideoShareAttachment.react",["CenteredContainer.react","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","Image.react","Link.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareSizeImageByWidthMixin","React","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();'use strict';var s=q,t=s.PropTypes,u=q.createClass({displayName:"MercuryVideoShareAttachment",mixins:[p],propTypes:{attachment:n,location:t.oneOf(o.getValues()),maxWidth:t.number},render:function(){if(this.props.location===o.MESSENGER||this.props.location===o.CHAT_PREVIEW)return q.createElement(m,q.__spread({},this.props));var v=this.props.attachment&&this.props.attachment.uri;return (q.createElement(l,{rel:"theater",href:v},q.createElement(i,{style:this._getImageSize()},q.createElement(h,null,this._renderImage()),q.createElement(j,null,q.createElement(g,{vertical:true},q.createElement(k,{src:r('/images/chat/chat_play_icon.png')}))))));}});e.exports=u;},null);
__d("MercuryVideoShareSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryVideoShareSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o=this.props.isViewerSender?j._("You sent a video."):j._("{sender name} sent a video.",[j.param("sender name",this.props.senderName)]);return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/icons/video.gif')}),o));}});e.exports=n;},null);
__d("XPlacesMapController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/places\/map\/",{id:{type:"Int"},latitude:{type:"Float",defaultValue:0},longitude:{type:"Float",defaultValue:0},address:{type:"StringVector",defaultValue:[]},name:{type:"String"},zoom:{type:"Int"},message_location_id:{type:"Int"},__asyncDialog:{type:"Int"}});},null);
__d("MercuryMessageLocationShareAttachment.react",["Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React","URI","XPlacesMapController","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=k,p=o.PropTypes,q=k.createClass({displayName:"MercuryMessageLocationShareAttachment",propTypes:{attachment:j,location:p.oneOf(i.getValues())},renderLink:function(r){var s=this.props.location;if(i.isPreview(s))return r;var t=h.modifyURIUsingLocation(new l(this.props.attachment.uri),s),u=this.props.attachment.deduplication_key,v=m.getURIBuilder().setInt('message_location_id',u).getURI();return (k.createElement(g,{className:"_5rw4",href:t,ajaxify:v,rel:"dialog",target:"_blank"},r));},render:function(){return this.renderLink(k.createElement(h,k.__spread({},this.props)));}});e.exports=q;},null);
__d("MercuryMessageLocationShareAttachmentSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryMessageLocationShareAttachmentSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o;if(this.props.isViewerSender){o=(j._("You sent a location."));}else o=(j._("{sender name} sent a location.",[j.param("sender name",this.props.senderName)]));return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/messaging/location/location.png')}),o));}});e.exports=n;},null);
__d("MercuryAnimatedShareAttachment.react",["Link.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareSizeImageByWidthMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=l,n=m.PropTypes,o=l.createClass({displayName:"MercuryAnimatedShareAttachment",mixins:[k],propTypes:{attachment:i,location:n.oneOf(j.getValues()),maxWidth:n.number},render:function(){if(this.props.location===j.MESSENGER||this.props.location===j.CHAT_PREVIEW)return l.createElement(h,l.__spread({},this.props));var p=this.props.attachment&&this.props.attachment.uri;return (l.createElement(g,{href:p,target:"_blank"},this._renderImage(true)));}});e.exports=o;},null);
__d("MercuryAnimatedShareSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryAnimatedShareSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o=this.props.isViewerSender?j._("You sent a GIF."):j._("{sender name} sent a GIF.",[j.param("sender name",this.props.senderName)]);return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/icons/photo.gif')}),o));}});e.exports=n;},null);
__d("MercuryShareStyleMap",["Map","MercuryConfig","MercuryShareAttachmentRenderLocations","StoryAttachmentStyle","cx","emptyFunction","MercuryFallbackShareAttachment.react","MercuryFallbackShareAttachmentSnippet.react","P2PMercuryShareAttachment.react","P2PMercuryShareAttachmentSnippet.react","MNCommerceReceiptMercuryShareAttachment.react","MNCommerceCancelReturnMercuryShareAttachment.react","MNCommerceShippingMercuryShareAttachment.react","MessengerMomentsAppShareAttachment.react","MessengerMomentsAppSnippet.react","MercuryPhotoShareAttachment.react","MercuryPhotoShareSnippet.react","MercuryImageShareAttachment.react","MercuryVideoShareAttachment.react","MercuryVideoShareSnippet.react","MercuryMessageLocationShareAttachment.react","MercuryMessageLocationShareAttachmentSnippet.react","MercuryAnimatedShareAttachment.react","MercuryAnimatedShareSnippet.react"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=new g();m.set(j.FALLBACK,{getComponent:function(){return b('MercuryFallbackShareAttachment.react');},getSnippetComponent:function(){return b('MercuryFallbackShareAttachmentSnippet.react');},cx:null,requiresNoBubbleTail:function(o,p){return o.share.media.image&&p;}});m.set(j.ORION,{getComponent:function(){return b('P2PMercuryShareAttachment.react');},getSnippetComponent:function(){return b('P2PMercuryShareAttachmentSnippet.react');},cx:new g([[i.MESSENGER,"_3djc"]])});if(h.WWWMessengerCommerceGK){m.set(j.RETAIL_RECEIPT,{getComponent:function(){return b('MNCommerceReceiptMercuryShareAttachment.react');},cx:new g([[i.MESSENGER,"_205d"]]),requiresNoBubbleTail:function(o){return o.share&&o.share.target&&Object.keys(o.share.target.items).length===1;}});m.set(j.RETAIL_CANCELLATION,{getComponent:function(){return b('MNCommerceCancelReturnMercuryShareAttachment.react');},cx:new g([[i.MESSENGER,"_205d"]])});m.set(j.RETAIL_SHIPMENT,{getComponent:function(){return b('MNCommerceShippingMercuryShareAttachment.react');},cx:new g([[i.MESSENGER,"_205d"]])});m.set(j.RETAIL_SHIPMENT_TRACKING_EVENT,{getComponent:function(){return b('MNCommerceShippingMercuryShareAttachment.react');},cx:new g([[i.MESSENGER,"_205d"]])});}if(h.MomentsMessengerWWWGK)m.set(j.MOMENTS_APP_INVITATION,{getComponent:function(){return b('MessengerMomentsAppShareAttachment.react');},getSnippetComponent:function(){return b('MessengerMomentsAppSnippet.react');},cx:null,requiresNoBubbleTail:l.thatReturnsTrue});m.set(j.PHOTO,{getComponent:function(){return b('MercuryPhotoShareAttachment.react');},getSnippetComponent:function(){return b('MercuryPhotoShareSnippet.react');},cx:null,requiresNoBubbleTail:l.thatReturnsTrue,unwrapInStory:l.thatReturnsTrue});m.set(j.IMAGE_SHARE,{getComponent:function(){return b('MercuryImageShareAttachment.react');},getSnippetComponent:function(){return b('MercuryPhotoShareSnippet.react');},cx:null,requiresNoBubbleTail:l.thatReturnsTrue,unwrapInStory:l.thatReturnsTrue});m.set(j.VIDEO,{getComponent:function(){return b('MercuryVideoShareAttachment.react');},getSnippetComponent:function(){return b('MercuryVideoShareSnippet.react');},cx:null,requiresNoBubbleTail:l.thatReturnsTrue,unwrapInStory:l.thatReturnsTrue});m.set(j.MESSAGE_LOCATION,{getComponent:function(){return b('MercuryMessageLocationShareAttachment.react');},getSnippetComponent:function(){return b('MercuryMessageLocationShareAttachmentSnippet.react');},cx:null,requiresNoBubbleTail:function(o,p){return o.share.media.image&&p;}});m.set(j.ANIMATED_IMAGE_SHARE,{getComponent:function(){return b('MercuryAnimatedShareAttachment.react');},getSnippetComponent:function(){return b('MercuryAnimatedShareSnippet.react');},cx:null,requiresNoBubbleTail:l.thatReturnsTrue,unwrapInStory:l.thatReturnsFalse});var n={getStyleFactory:function(o){if(!o||!o.style_list)return null;if(o.style_list[0]===j.ATTACHED_STORY){var p=o.subattachments,q=(p&&p.length)?p[0].style_list:[],r=this._getStyleMapEntry(q);if(r&&r.unwrapInStory&&r.unwrapInStory())return {attachment:p[0],factory:r};}var s=this._getStyleMapEntry(o.style_list);if(!s)return null;return {attachment:o,factory:s};},_getStyleMapEntry:function(o){for(var p=0;p<o.length;p++){var q=m.get(o[p]);if(q)return q;}return null;}};e.exports=n;},null);
__d("MercuryAttachment",["MercuryAttachmentContentType","MercuryAttachmentType","MercuryAudioType","MercuryConfig","MercuryShareStyleMap"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={getAttachIconClass:function(m){switch(m){case g.PHOTO:return 'MercuryPhotoIcon';case g.VIDEO:return 'MercuryVideoIcon';case g.MUSIC:return 'MercuryMusicIcon';case g.VOICE:return 'MercuryVoiceIcon';case g.TEXT:return 'MercuryTextIcon';case g.MSWORD:return 'MercuryMSWordIcon';case g.MSXLS:return 'MercuryMSXLSIcon';case g.MSPPT:return 'MercuryMSPPTIcon';}return 'MercuryDefaultIcon';},getAttachIconClassByMime:function(m){if(m.startsWith('image')){return 'MercuryPhotoIcon';}else if(m.startsWith('video')){return 'MercuryVideoIcon';}else if(m.startsWith('audio')){return 'MercuryMusicIcon';}else if(m.startsWith('text/plain')){return 'MercuryTextIcon';}else return 'MercuryDefaultIcon';},getAttachTypeByMime:function(m){if(m.startsWith('image')){return g.PHOTO;}else if(m.startsWith('video')){return g.VIDEO;}else if(m.startsWith('audio')){return g.MUSIC;}else if(m.startsWith('text/plain')){return g.TEXT;}else return g.UNKNOWN;},convertRaw:function(m){var n=[];for(var o=0;o<m.length;o++){var p=m[o];if(p.attach_type===h.PHOTO){n.push(p);}else if(p.filename){var q=l.getAttachTypeByMime(p.filetype),r={};r.attach_type=h.FILE;r.name=p.filename;r.icon_type=q;r.url='';n.push(r);}}return n;},get:function(m){var n=[];if(m.attachments){n=m.attachments;}else if(m.raw_attachments)n=this.convertRaw(m.raw_attachments);if(!(m.attachments&&m.attachments.length>0)){if(m.sticker_id)return n.concat([{attach_type:h.STICKER}]);if(m.preview_attachments&&m.preview_attachments.length>0)return n.concat(m.preview_attachments);}return n;},hasBubbleTail:function(m,n){var o=this.get(m);if(j.MercuryStoryAttachmentsGK&&!m.body&&!!o)return !o.some(function(p){if(p.attach_type!==h.SHARE||!p.share)return false;var q=k.getStyleFactory(p.share);if(q){var r=q.factory;return (r.requiresNoBubbleTail&&r.requiresNoBubbleTail(p,n));}return false;});return true;},isVoiceMessage:function(m){return (m===i.AudioClip||m===i.VoiceMessageWithTranscript);}};e.exports=l;},null);
__d("MercuryThreads",["EventEmitter","ImmutableObject","KeyedCallbackManager","LogHistory","Map","MercuryActionType","MercuryAssert","MercuryAttachment","MercuryGlobalActionType","MercuryIDs","MercuryLogMessageType","MercuryLoggingHelper","MercuryPayloadSource","MercurySingletonMixin","MercuryThreadMode","MessagingTag","MercuryServerRequests","Set","MercuryThreadInformer","fbt","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=new g(),ca=j.getInstance('mercury_threads');function da(ea){this.$MercuryThreads0=ea;this.$MercuryThreads1=w.getForFBID(this.$MercuryThreads0);this.$MercuryThreads2=y.getForFBID(this.$MercuryThreads0);this.$MercuryThreads3=p.getParticipantIDFromUserID(this.$MercuryThreads0);this.$MercuryThreads4=false;this.$MercuryThreads5=new i();this.$MercuryThreads6=new x();this.$MercuryThreads7=false;this.$MercuryThreads8=new x();this.$MercuryThreads9=new x();this.$MercuryThreadsa();}da.prototype.getThreadMetaNow=function(ea){m.isThreadID(ea);return this.$MercuryThreads5.getResource(ea);};da.prototype.getOrFetch=function(ea){var fa=this.getThreadMetaNow(ea);if(!fa&&!this.$MercuryThreads9.has(ea))this.$MercuryThreads8.add(ea);if(this.$MercuryThreads8.size>0&&!this.$MercuryThreads7)this.$MercuryThreadsb();return fa;};da.prototype.$MercuryThreadsb=function(){if(this.$MercuryThreads7)return;this.$MercuryThreads7=true;aa(function(){this.$MercuryThreads7=false;this.$MercuryThreads8.forEach(function(ea){return this.$MercuryThreads9.add(ea);}.bind(this));this.getMultiThreadMeta(Array.from(this.$MercuryThreads8),function(ea){for(var fa in ea)ea.hasOwnProperty(fa)&&this.$MercuryThreads9["delete"](fa);}.bind(this));this.$MercuryThreads8.clear();}.bind(this));};da.prototype.getThreadMeta=function(ea,fa,ga){return this.getMultiThreadMeta([ea],function(ha){return fa(ha[ea]);},ga);};da.prototype.getMultiThreadMeta=function(ea,fa,ga){m.allThreadID(ea);var ha=this.$MercuryThreads5.executeOrEnqueue(ea,fa),ia=this.$MercuryThreads5.getUnavailableResources(ha);if(ia.length){var ja=[];for(var ka=0;ka<ia.length;ka++){var la=ia[ka],ma=p.tokenize(la),na=ma.type,oa=ma.value;if(na=='user'){var pa=p.getParticipantIDFromUserID(oa);this.createNewLocalThread(la,pa===this.$MercuryThreads3?[this.$MercuryThreads3]:[this.$MercuryThreads3,pa]);}else ja.push(la);}if(ja.length)this.$MercuryThreads1.fetchThreadData(ja,ga);}return ha;};da.addListener=function(ea,fa){return ba.addListener(ea,fa);};da.prototype.unsubscribe=function(ea){this.$MercuryThreads5.unsubscribe(ea);};da.prototype.getCanonicalThreadToParticipant=function(ea,fa,ga,ha){var ia=p.getThreadIDFromParticipantID(ea),ja=this.$MercuryThreads5.getResource(ia);if(typeof ja=='undefined'){ja=this.createNewLocalThread(ia,this.$MercuryThreads3===ea?[this.$MercuryThreads3]:[this.$MercuryThreads3,ea],fa);!ha&&this.$MercuryThreads1.fetchThreadData([ia],ga);}return ja;};da.prototype.createNewLocalThread=function(ea,fa,ga){var ha=this.$MercuryThreads5.getResource(ea);if(!ha){var ia=p.tokenize(ea),ja=ia.type,ka=ia.value;ha=new h({thread_id:ea,last_action_id:null,participants:Array.from(fa),name:null,snippet:'',snippet_has_attachment:false,snippet_sender:null,unread_count:ga?ga:0,message_count:0,image_src:null,timestamp_absolute:null,timestamp_relative:null,timestamp:null,canonical_fbid:ja==='user'?ka:null,is_canonical_user:ja=='user',is_canonical:this.$MercuryThreadsc(fa),is_subscribed:true,root_message_threading_id:null,folder:v.INBOX,is_archived:false,mode:u.TITAN_ORIGINATED});this.$MercuryThreads5.setResource(ea,ha);}return ha;};da.prototype.isEmptyLocalThread=function(ea){var fa=this.$MercuryThreads5.getResource(ea);if(!fa)return false;var ga=p.tokenize(ea),ha=ga.type;return ha=='root'&&!fa.timestamp;};da.prototype.isNewEmptyLocalThread=function(ea){if(!this.isEmptyLocalThread(ea))return false;var fa=this.$MercuryThreads5.getResource(ea);return !!fa.participants&&fa.participants.length===0;};da.prototype.$MercuryThreadsd=function(ea,fa){if(!ea||!ea.length)return;var ga=new k(),ha=new k(),ia=new k(),ja=[];for(var ka=0;ka<ea.length;ka++){var la=ea[ka];if(la.is_forward)continue;var ma=la.action_type;if(ma==l.LOG_MESSAGE&&la.log_message_type==q.SERVER_ERROR)continue;var na=!!(la.sync_id||la.action_id),oa=la.thread_id;m.isThreadID(oa);var pa=this.$MercuryThreads5.getResource(oa);if(!pa&&!na&&ma==l.USER_GENERATED_MESSAGE){pa=this.$MercuryThreadse(la);this.$MercuryThreads5.setResource(oa,pa);}if(!pa)continue;if(ma==l.LOG_MESSAGE||ma==l.USER_GENERATED_MESSAGE)na=!fa;if(pa.server_timestamp&&la.timestamp<=pa.server_timestamp&&na)continue;if(!ia.has(oa))ia.set(oa,Object.assign({},pa));this.$MercuryThreadsf(ia.get(oa),la,fa);if(ma==l.USER_GENERATED_MESSAGE)ga.set(oa,la);if(ma==l.USER_GENERATED_MESSAGE||ma==l.LOG_MESSAGE||ma==l.SEND_MESSAGE)if(la&&la.timestamp&&(!ha.has(oa)||la.timestamp>ha.get(oa).timestamp))ha.set(oa,la);}ia.forEach(function(qa,ra){var sa=ha.get(ra),ta=ga.get(ra);if(ta){this.$MercuryThreadsg(qa,ta);}else if(sa&&(sa.log_message_type==q.PHONE_CALL||sa.log_message_type==q.VIDEO_CALL)){var ua=Object.assign({},sa,{body:sa.log_message_body});this.$MercuryThreadsg(qa,ua);}var va=qa.timestamp;if(sa){if(sa.timestamp>va)Object.assign(qa,{timestamp_absolute:sa.timestamp_absolute,timestamp_relative:sa.timestamp_relative,timestamp:sa.timestamp});var wa=qa.server_timestamp;if(!fa&&sa.timestamp>wa)qa.server_timestamp=sa.timestamp;}var xa=new h(qa);this.$MercuryThreads5.setResource(ra,xa);ja.push(r.obfuscateThread(xa));}.bind(this),this);ja.length&&ca.debug('threads_updated',{threads:ja});};da.prototype.$MercuryThreadsf=function(ea,fa,ga){var ha=fa.action_type;if(ha==l.USER_GENERATED_MESSAGE||ha==l.LOG_MESSAGE){fa.is_unread&&ea.unread_count++;ea.message_count++;ea.is_archived=false;}switch(ha){case l.DELETE_THREAD:ea.message_count=0;this.$MercuryThreadsh(fa.thread_id);break;case l.USER_GENERATED_MESSAGE:if(ea.last_read_timestamp>=fa.timestamp)this.$MercuryThreadsi(ea,fa,true);this.$MercuryThreadsj(ea,fa.author);break;case l.SEND_MESSAGE:var ia=fa.log_message_type;if(ia==q.THREAD_IMAGE){ea.image_src=fa.log_message_data.image?fa.log_message_data.image.preview_url:null;this.$MercuryThreadsk(fa.thread_id);}ea.snippet_attachments=fa.attachments;break;case l.LOG_MESSAGE:var ia=fa.log_message_type;if(ia==q.SUBSCRIBE){this.$MercuryThreadsl(ea,fa.log_message_data.added_participants);this.$MercuryThreadsk(fa.thread_id);}else if(ia==q.UNSUBSCRIBE){this.$MercuryThreadsm(ea,fa.log_message_data.removed_participants);this.$MercuryThreadsk();}else if(ia==q.THREAD_IMAGE){if(!ga)ea.image_src=fa.log_message_data.image?fa.log_message_data.image.preview_url:null;}else if(ia==q.THREAD_NAME){if(ea.name!==fa.log_message_data.name)this.$MercuryThreadsk(fa.thread_id);ea.name=fa.log_message_data.name;}break;case l.CHANGE_READ_STATUS:var ja=this.$MercuryThreadsi(ea,fa,fa.mark_as_read);if(ja&&fa.timestamp)ea.last_read_timestamp=fa.timestamp;if(ja&&ga)this.$MercuryThreads1.changeThreadReadStatus(ea.thread_id,fa.mark_as_read,fa.source);break;case l.CHANGE_ARCHIVED_STATUS:if(ea.is_archived!=fa.archived){ea.is_archived=fa.archived;this.$MercuryThreadsk(fa.thread_id);}break;case l.CHANGE_FOLDER:if(ea.folder!=fa.new_folder){ea.folder=fa.new_folder;this.$MercuryThreadsk(fa.thread_id);}break;case l.DELETE_MESSAGES:if(ga){ea.snippet='...';ea.snippet_has_attachment=false;ea.snippet_attachments=null;ea.snippet_sender=null;ea.is_forwarded_snippet=false;this.$MercuryThreadsk(fa.thread_id);}else if(fa.message_ids)ea.message_count=ea.message_count-fa.message_ids.length;break;case l.CHANGE_MUTE_SETTINGS:if(fa.mute_settings!==(void 0)){var ka=this.$MercuryThreads0+'@facebook.com';if(ea.mute_settings){if(fa.mute_settings){var la={};la[ka]=fa.mute_settings;ea.mute_settings=Object.assign({},ea.mute_settings,la);}else{ea.mute_settings=Object.assign({},ea.mute_settings);delete ea.mute_settings[ka];}this.$MercuryThreadsk(ea.thread_id);}}break;case l.ADD_PARTICIPANTS:this.$MercuryThreadsl(ea,fa.participants);this.$MercuryThreadsk(ea.thread_id);break;case l.CHANGE_FLAG:this.$MercuryThreadsn(ea,fa.mark_as_flag);this.$MercuryThreadsk(ea.thread_id);break;}};da.prototype.$MercuryThreadse=function(ea){var fa=p.tokenize(ea.thread_id),ga=fa.type,ha=fa.value,ia=this.$MercuryThreadsc(ea.specific_to_list);return new h({thread_id:ea.thread_id,last_action_id:null,participants:ea.specific_to_list,name:null,snippet:ea.body,snippet_has_attachment:false,snippet_attachments:[],snippet_sender:ea.author,unread_count:0,message_count:0,image_src:null,timestamp_absolute:ea.timestamp_absolute,timestamp_relative:ea.timestamp_relative,timestamp:ea.timestamp,canonical_fbid:ga==='user'?ha:null,is_canonical_user:ga==='user',is_canonical:ia,is_subscribed:true,root_message_threading_id:ea.message_id,folder:v.INBOX,is_archived:false,mode:u.TITAN_ORIGINATED});};da.prototype.$MercuryThreadsi=function(ea,fa,ga){if(fa.timestamp)this.$MercuryThreadso(ea.thread_id,ga,fa.timestamp);if(!ea||!ea.thread_id)return false;if(!ea.timestamp){this.$MercuryThreads6.add(ea.thread_id);return false;}var ha=!ea.unread_count;if(ga==ha)return false;ea.unread_count=ga?0:1;this.$MercuryThreadsk(ea.thread_id);return true;};da.prototype.$MercuryThreadsp=function(ea){var fa=this.$MercuryThreads5.getAllResources();for(var ga in fa)if(fa.hasOwnProperty(ga)){var ha=fa[ga];if(ha.folder==ea){this.$MercuryThreads5.setResource(ga,h.setProperty(ha,'unread_count',0));this.$MercuryThreadsk(ga);}}};da.prototype.$MercuryThreadsl=function(ea,fa){var ga=new x(ea.participants);ea.participants=Array.from(ea.participants);fa.forEach(function(ha){if(!ga.has(ha)){ea.participants.push(ha);if(ha===this.$MercuryThreads3)ea.is_subscribed=true;}}.bind(this));};da.prototype.$MercuryThreadsm=function(ea,fa){var ga=new x(fa);ea.participants=ea.participants.filter(function(ha){return !ga.has(ha);});if(ga.has(this.$MercuryThreads3))ea.is_subscribed=false;this.$MercuryThreads1.fetchThreadData([ea.thread_id]);};da.prototype.$MercuryThreadsj=function(ea,fa){if(ea.participants[0]!=fa){ea.participants=ea.participants.filter(function(ga){return ga!=fa;});ea.participants.unshift(fa);}};da.prototype.$MercuryThreadsg=function(ea,fa){var ga=fa.body,ha=fa.subject,ia='';if(ha){ha=ha.toLowerCase();if(ga.slice(0,ha.length).toLowerCase()==ha){ia=ga;}else if(ga){ia=ha+' \u00B7 '+ga;}else ia=ha;}else ia=ga;if(fa.is_filtered_content)ia=z._("This message is no longer available because it was identified as abusive or marked as spam.");ea.snippet=ia;ea.snippet_has_attachment=fa.has_attachment;if(fa.raw_attachments&&fa.raw_attachments.length>0){var ja=n.convertRaw(fa.raw_attachments);ea.snippet_attachments=ja;}else ea.snippet_attachments=fa.attachments;ea.is_forwarded_snippet=!!fa.forward_count;ea.snippet_sender=fa.author;};da.prototype.$MercuryThreadsn=function(ea,fa){ea.page_thread_info=Object.assign({},ea.page_thread_info,{flagged:fa});};da.prototype.$MercuryThreadsc=function(ea){return ea.filter(function(fa){return fa!=this.$MercuryThreads3;}.bind(this)).length<=1;};da.prototype.$MercuryThreadsa=function(){this.$MercuryThreads1.subscribe('update-threads',function(ea,fa){var ga=(fa.actions||[]).filter(function(ha){return ha.thread_id;});if(fa.threads&&fa.payload_source==s.SERVER_FETCH_THREAD_INFO)fa.threads.forEach(function(ha){var ia=ha.thread_id;if(this.$MercuryThreads6.has(ia)){this.$MercuryThreads6["delete"](ia);if(ha.unread_count)this.$MercuryThreads1.changeThreadReadStatus(ha.thread_id,true);}}.bind(this));this.$MercuryThreadsq(fa.threads);this.$MercuryThreadsd(ga,fa.from_client);fa.threads&&fa.threads.forEach(function(ha){this.$MercuryThreadsk(ha.thread_id);}.bind(this));if(fa.global_actions)fa.global_actions.forEach(function(ha){if(ha.action_type==o.MARK_ALL_READ)this.$MercuryThreadsp(ha.folder);}.bind(this));if(this.$MercuryThreads4){this.$MercuryThreads4=false;ba.emit('change');}}.bind(this));};da.prototype.$MercuryThreadsq=function(ea){if(!ea||!ea.length)return;var fa={},ga=[];ea.forEach(function(ha){var ia=new h(ha);fa[ha.thread_id]=ia;ga.push(r.obfuscateThread(ia));});ga.length&&ca.debug('threads_added',{threads:ga});this.$MercuryThreads5.addResourcesAndExecute(fa);};da.prototype.$MercuryThreadsk=function(ea){this.$MercuryThreads4=true;this.$MercuryThreads2.updatedThread(ea);};da.prototype.$MercuryThreadsh=function(ea){this.$MercuryThreads4=true;this.$MercuryThreads2.deletedThread(ea);};da.prototype.$MercuryThreadso=function(ea,fa,ga){this.$MercuryThreads4=true;this.$MercuryThreads2.changedThreadReadState(ea,fa,ga);};Object.assign(da,t);e.exports=da;},null);
__d("WebMessengerPermalinkConstants",["URI"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={ARCHIVED_PATH:'/messages/archived',BASE_PATH:'/messages',OTHER_PATH:'/messages/other',SPAM_PATH:'/messages/spam',COMPOSE_POSTFIX_PATH:'/new',SEARCH_POSTFIX_PATH:'/search',TID_POSTFIX_PARTIAL_PATH:'/conversation-',overriddenVanities:'(archived|other|spam|new|search|conversation-.*)',getURIPathForThreadID:function(i,j){return (j||h.BASE_PATH)+h.TID_POSTFIX_PARTIAL_PATH+g.encodeComponent(g.encodeComponent(i));},getThreadIDFromURI:function(i){var j=i.getPath().match(h.BASE_PATH+'(/[^/]*)*'+h.TID_POSTFIX_PARTIAL_PATH+'([^/]+)');if(j){var k=g.decodeComponent(g.decodeComponent(j[2]));return k;}},getURIPathForIDOrVanity:function(i,j){if(i.match('^'+h.overriddenVanities+'$'))i='.'+i;return (j||h.BASE_PATH)+'/'+i;},getUserIDOrVanity:function(i){var j=i.match(h.BASE_PATH+'.*/([^/]+)/?$'),k=j&&j[1],l=h.overriddenVanities;if(!k||k.match('^'+l+'$')){return false;}else if(k.match('^\\.'+l+'$')){return k.substr(1);}else return k;}};e.exports=h;},null);
__d("ChatOpenTab",["AsyncRequest","Event","requireWeak","ChatWelcomeMessage","ContextualThing","DOM","csx","cx","MercuryIDs","Parent","XAdsQEExposureController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r=null;i(['ChatApp'],function(ba){return r=ba;});var s=null;i(['ChatTabModel'],function(ba){return s=ba;});var t=716,u='messaging_tracking';function v(){d(['Toggler'],function(ba){var ca=ba.getInstance(l.scry(document,"div._1z4y")[0]);if(ca&&ca.getActive())ca.hide();});}function w(ba,ca){d(['LogHistory','MercuryThreads','WebMessengerPermalinkConstants','goURI'],function(da,ea,fa,ga){ea.get().getThreadMeta(ba,function(ha){if(r&&r.isInitialized()){r.tabController.openTab(ba,r.tabsViewport,ca);}else ga(fa.getURIPathForThreadID(ba));if(!aa.canOpenTab())da.getInstance('mercury').error('Unable to open chat tab',ha);});});if(document.documentElement.clientHeight<=t)v();}function x(ba,ca,da,ea,fa){h.listen(ba,'click',function(ga){if(aa.canOpenTab()){ea(ca,da);if(fa)return;return ga.kill();}});}function y(ba,ca,da,ea){var fa={referrer:ba||'',message_thread_id:ca,message_view:'chat',timestamp_send:Date.now()};if(da!==(void 0))fa.message_target_ids=[da];d(['ChatImpressionLogger'],function(ga){ga.logImpression(ba,da,ea);});d(['Banzai'],function(ga){ga.post(u,fa,{delay:0,retry:true});});}function z(ba){var ca=k.getContext(ba);return (ca&&p.byClass(ca,"_3qw")!==null);}var aa={canOpenTab:function(){return r&&!r.isHidden();},openEmptyTab:function(ba,ca,da){if(aa.canOpenTab()&&s){var ea=s.getEmptyTab();w(ea);y(ca,ea,null,da);v();return ea;}return null;},listenOpenEmptyTab:function(ba,ca){x(ba,null,ca,aa.openEmptyTab);},openThread:function(ba,ca,da,ea){d(['MercuryServerRequests'],function(fa){if(o.isValid(ba)){w(ba,ea);}else fa.get().getClientThreadID(ba,function(ga){return w(ga,ea);});y(ca,ba,null,da);v();});},listenOpenThread:function(ba,ca,da){x(ba,ca,da,aa.openThread);},openUserTab:function(ba,ca,da){var ea=o.getThreadIDFromUserID(ba);w(ea);y(ca,ea,ba,da);return true;},openPageTab:function(ba,ca,da){d(['MercuryThreads'],function(ea){var fa=o.getThreadIDFromUserID(ca);ea.get().getThreadMeta(fa,function(ga){if(ba&&ba.length>0){var ha=(Date.now()-ga.timestamp)/1000,ia=ha/3600;if(ga.message_count===0||ia>24)j.setWelcomeMessage(fa,o.getParticipantIDFromUserID(ca),ba);}});w(fa);y(da,fa,ca);});return true;},listenOpenUserTab:function(ba,ca,da){if(!z(ba))x(ba,ca,da,aa.openUserTab);},listenOpenPageTab:function(ba,ca,da,ea,fa){if(!z(ba))x(ba,ca,ea,function(ga,ha){if(fa)this.openPageTab(da,ga,ha);var ia=q.getURIBuilder().setString('name','switch_dialog_for_chat').setString('id',ga.toString());new g().setURI(ia.getURI()).setMethod('POST').send();}.bind(this),!fa);},openTabByType:function(ba,ca,da){d(['ChatTypeaheadConstants','MercuryParticipantTypes'],function(ea,fa){if(ca===ea.THREAD_TYPE){if(ba){aa.openThread(ba,da);}else aa.openEmptyTab(null,da);}else if(!ca||ca===fa.FRIEND||ca===ea.FRIEND_TYPE||ca===ea.PAGE_TYPE||ca===ea.USER_TYPE)aa.openUserTab(ba,da);});}};e.exports=aa;},null);
__d("URLMatcher",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g='!"#%&\'()*,-./:;<>?@[\\]^_`{|}',h='\u2000-\u206F\u00ab\u00bb\uff08\uff09',i='(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])',j='(?:(?:ht|f)tps?)://',k='(?:(?:'+i+'[.]){3}'+i+')',l='\\[(?:(?:[A-Fa-f0-9]{1,4}::?){1,7}[A-Fa-f0-9]{1,4})\\]',m='(?:\\b)www\\d{0,3}[.]',n='[^\\s'+g+h+']',o='(?:(?:(?:[.:\\-_%@]|'+n+')*'+n+')|'+l+')',p='(?:[.][a-z]{2,4})',q='(?::\\d+){0,1}',r='(?=[/?#])',s='(?:'+'(?:'+j+o+q+')|'+'(?:'+k+q+')|'+'(?:'+l+q+')|'+'(?:'+m+o+p+q+')|'+'(?:'+o+p+q+r+')'+')',t='[/#?]',u='\\([^\\s()<>]+\\)',v='[^\\s()<>?#]+',w=new RegExp(s,'im'),x='^\\[[0-9]{1,4}:[0-9]{1,4}:[A-Fa-f0-9]{1,4}\\]',y=new RegExp(x,'im'),z='(?:'+'(?:'+t+')'+'(?:'+'(?:'+u+'|'+v+')*'+')*'+')*',aa=new RegExp('('+'(?:'+s+')'+'(?:'+z+')'+')','im'),ba=new RegExp('('+'(?:'+j+o+q+')|'+'(?:'+m+o+p+q+')'+')'),ca=/[\s'";]/,da=new RegExp(t,'im'),ea=new RegExp('[\\s!"#%&\'()*,./:;<>?@[\\]^`{|}\u00ab\u00bb\u2000-\u206F\uff08\uff09]','im'),fa=new RegExp('[\\s()<>?#]','im'),ga=new RegExp('\\s()<>'),ha=function(oa){if(oa&&oa.indexOf('@')!=-1){return (ba.exec(oa))?oa:null;}else return oa;},ia=function(oa){return ja(oa,aa);},ja=function(oa,pa){var qa=(pa.exec(oa)||[])[1]||null;return ha(qa);},ka=function(oa){return w.exec(oa);},la=function(oa){return !ca.test(oa.charAt(oa.length-1));},ma=function(oa){do{var pa=w.exec(oa);if(!pa)return null;var qa=false;if(pa[0][0]==='['&&pa.index>0&&oa[pa.index-1]==='@'){var ra=y.exec(pa[0]);if(ra){qa=true;oa=oa.substr(pa.index+ra[0].length);}}}while(qa);var sa=oa.substr(pa.index+pa[0].length);if(sa.length===0||!(da.test(sa[0])))return ha(pa[0]);var ta=0,ua=0,va=1,wa=0,xa=ua;for(var ya=1;ya<sa.length;ya++){var za=sa[ya];if(xa===ua){if(za==='('){wa=wa+1;xa=va;}else if(da.test(za)||!(ea.test(za))){ta=ya;}else if(fa.test(za))break;}else if(za==='('){wa=wa+1;}else if(za===')'){wa=wa-1;if(wa===0){xa=ua;ta=ya;}}else if(ga.test(za))break;}return ha(pa[0]+sa.substring(0,ta+1));},na={};na.permissiveMatch=ia;na.matchToPattern=ja;na.matchHost=ka;na.trigger=la;na.match=ma;e.exports=na;},null);
__d("mergeObjects",["copyProperties"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(){var i={};for(var j=0;j<arguments.length;j++)g(i,arguments[j]);return i;}e.exports=h;},null);
__d("MercuryShareAttachmentSnippet.react",["MercuryShareAttachmentReactShape","MercuryShareStyleMap","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i,k=j.PropTypes,l=i.createClass({displayName:"MercuryShareAttachmentSnippet",propTypes:{attachment:g,isSenderViewer:k.bool,senderName:k.string},render:function(){var m=h.getStyleFactory(this.props.attachment);if(m.factory&&!!m.factory.getSnippetComponent){var n=m.factory.getSnippetComponent();return (i.createElement(n,i.__spread({},this.props,{attachment:m.attachment})));}return null;}});e.exports=l;},null);
__d("MercuryAttachmentSnippet.react",["EmoticonsList","Image.react","MercuryAttachment","MercuryAttachmentSnippetRenderer","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryIDs","P2PMercuryAttachmentSnippet.react","MercuryShareAttachmentSnippet.react","MercuryParticipants","React","StickerConstants","TextWithEmoticons.react","cx","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=q,x=w.PropTypes,y=q.createClass({displayName:"MercuryAttachmentSnippet",propTypes:{thread:x.object.isRequired,viewer:x.string.isRequired},componentWillMount:function(){this._ensureParticipant(this.props.thread.snippet_sender);this._setVariables(this.props);},componentWillReceiveProps:function(ba){this._ensureParticipant(ba.thread.snippet_sender);this._setVariables(ba);},componentWillUnmount:function(){this._cancelParticipantFetch();},render:function(){var ba=this._getSenderName(),ca=j.getAttachmentSnippetType(this._attachments);switch(ca){case k.PHOTO:return this._renderPhotoSnippet(ba);case k.GIF:return this._renderAnimatedImageSnippet(ba);case k.VIDEO:return this._renderVideoSnippet(ba);case k.AUDIO_CLIP:return this._renderAudioClipSnippet(ba);case k.STICKER:return this._renderStickerSnippet(ba);case k.ORION:return this._renderOrionSnippet(ba);case k.SHARE:return this._renderShareSnippet(ba);case k.ERROR:return this._renderError(ba);default:return this._renderMixedSnippet(ba);}},_renderPhotoSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.PHOTO,this._isViewerSender,ba,this._attachments));},_renderAnimatedImageSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.GIF,this._isViewerSender,ba,this._attachments));},_renderVideoSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.VIDEO,this._isViewerSender,ba));},_renderAudioClipSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.AUDIO_CLIP,this._isViewerSender,ba));},_renderStickerSnippet:function(ba){if(z(this._attachments[0].metadata.stickerID)){return (q.createElement(s,{renderEmoticons:true,text:g.symbols.like}));}else return (q.createElement("span",null,j.renderAttachmentSnippetText(k.STICKER,this._isViewerSender,ba)));},_renderOrionSnippet:function(ba){return (q.createElement("span",null,q.createElement(n,q.__spread({},this._attachments[0].metadata))));},_renderShareSnippet:function(ba){if(!!this._attachments[0].share)return (q.createElement(o,{attachment:this._attachments[0].share,senderName:ba,isViewerSender:this._isViewerSender}));return this._renderSnippet(j.renderAttachmentSnippetText(k.SHARE,this._isViewerSender,ba));},_renderMixedSnippet:function(ba){return (q.createElement("span",null,this._attachments.filter(function(ca){return ca.attach_type===l.FILE||ca.attach_type===l.PHOTO||ca.attach_type===l.VIDEO;}).map(function(ca,da){return this._renderSnippet(ca.name,ca.icon_type,da);}.bind(this))));},_renderSnippet:function(ba,ca,da){var ea=i.getAttachIconClass(ca||this._attachments[0].icon_type),fa=v(ea,"uiIconText _3l6h");return (q.createElement("span",{className:fa,key:da},q.createElement(h,{src:u('/images/messaging/docs/generic.png')}),ba));},_renderError:function(ba){var ca=j.renderAttachmentSnippetText(k.ERROR,this._isViewerSender,ba);return this._renderSnippet(ca);},_setVariables:function(ba){this._viewer=ba.viewer;this._sender=ba.thread.snippet_sender;this._attachments=ba.thread.snippet_attachments;this._isViewerSender=aa(this._sender,this._viewer);},_getSenderName:function(){if(!this._sender||this._isViewerSender)return null;var ba=p.getNow(this._sender);if(!ba)return null;return ba.short_name;},_ensureParticipant:function(ba){if(!ba)return;this._cancelParticipantFetch();if(!p.getNow(ba))this._sub=p.get(ba,function(ca){return this.forceUpdate();}.bind(this));},_cancelParticipantFetch:function(){this._sub&&this._sub.remove();}});function z(ba){return (ba==r.LIKE_STICKER_ID||ba==r.HOT_LIKE_SMALL_STICKER_ID||ba==r.HOT_LIKE_MEDIUM_STICKER_ID||ba==r.HOT_LIKE_LARGE_STICKER_ID);}function aa(ba,ca){return !!(ba&&m.getParticipantIDFromUserID(ca)==ba);}e.exports=y;},null);
__d("MercuryParticipantsImage.react",["MercuryParticipants","React","SplitImage.react","areEqual"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MercuryParticipantsImage",_bigImageToken:(null),propTypes:{participants:l.array.isRequired,size:l.number},getInitialState:function(){return {participantImages:[]};},componentDidMount:function(){this._getParticipantImages(this.props);},componentWillReceiveProps:function(n){this._getParticipantImages(n);},componentWillUnmount:function(){this._bigImageToken&&this._bigImageToken.remove();},shouldComponentUpdate:function(n,o){return (n.size!==this.props.size||!o||!j(o.participantImages,this.state.participantImages));},render:function(){if(this.state.participantImages.length>0)return (h.createElement(i,{border:true,className:this.props.className,srcs:this.state.participantImages,size:this.props.size}));return null;},_getParticipantImages:function(n){this._bigImageToken&&this._bigImageToken.remove();(this)._bigImageToken=g.getOrderedBigImageMulti(n.participants,function(o){this.isMounted()&&this.setState({participantImages:o});}.bind(this));}});e.exports=m;},null);
__d("MercuryThreadImage.react",["ImmutableObject","MercuryIDs","MercuryParticipantsImage.react","MercuryParticipantsConstants","Pixelz.react","React","areEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=l,o=n.PropTypes,p=l.createClass({displayName:"MercuryThreadImage",propTypes:{thread:o.instanceOf(g).isRequired,viewer:o.string.isRequired,size:o.number,useBackground:o.bool},shouldComponentUpdate:function(q,r){return (q.thread.image_src!==this.props.thread.image_src||!m(q.thread.participants,this.props.thread.participants)||q.size!==this.props.size||q.viewer!==this.props.viewer||q.useBackground!==this.props.useBackground);},render:function(){var q=this.props.size||j.BIG_IMAGE_SIZE,r=this.props.thread.image_src;if(r){if(this.props.useBackground)return (l.createElement("div",{style:{height:q,backgroundImage:("url("+r+")"),backgroundPosition:'50% 50%',backgroundRepeat:'no-repeat',backgroundSize:'cover',width:q}}));return (l.createElement(k,{height:q,resizeMode:'cover',src:r,width:q}));}var s=h.getParticipantIDFromUserID(this.props.viewer),t=this.props.thread.participants.filter(function(v){return v!==s;}),u=[];if(!t.length){u=[s];}else if(t.length==1){u=t;}else u=t.slice(0,3);return (l.createElement(i,{participants:u,size:q}));}});e.exports=p;},null);
__d("MercuryParticipantListRenderer",["fbt"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(){this.$MercuryParticipantListRenderer0=false;this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=function(r){return this.$MercuryParticipantListRenderer1?r.short_name:r.name;}.bind(this);}h.prototype.renderParticipantList=function(r){var s=r.map(this.$MercuryParticipantListRenderer3);switch(s.length){case 0:return i(this.$MercuryParticipantListRenderer0);case 1:return j(s);case 2:return this.$MercuryParticipantListRenderer2?l(s):k(s);case 3:return this.$MercuryParticipantListRenderer2?n(s):m(s);default:return this.$MercuryParticipantListRenderer2?p(s):o(s);}};h.prototype.setIsNewThread=function(r){this.$MercuryParticipantListRenderer0=r;return this;};h.prototype.setNameRenderer=function(r){this.$MercuryParticipantListRenderer3=r;return this;};h.prototype.setUseShortName=function(r){this.$MercuryParticipantListRenderer1=r;return this;};h.prototype.setUseAndSeparator=function(r){this.$MercuryParticipantListRenderer2=r;return this;};function i(r){if(r){return (g._("New Message"));}else return (g._("No Participants"));}function j(r){return r[0];}function k(r){return (g._("{participant1}, {participant2}",[g.param("participant1",r[0]),g.param("participant2",r[1])]));}function l(r){return (g._("{participant1} and {participant2}",[g.param("participant1",r[0]),g.param("participant2",r[1])]));}function m(r){return (g._("{participant1}, {participant2}, {participant3}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2])]));}function n(r){return (g._("{participant1}, {participant2} and {participant3}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2])]));}function o(r){return (g._("{participant1}, {participant2}, {participant3}, {others_link}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2]),g.param("others_link",q(r.length-3))]));}function p(r){return (g._("{participant1}, {participant2} and {others_link}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("others_link",q(r.length-2))]));}function q(r){if(r>1){return (g._({"*":"{others_count} others"},[g.param("others_count",r,[0])]));}else return (g._("1 other"));}e.exports=h;},null);
__d("MercuryThreadTitle.react",["MercuryIDs","MercuryParticipantListRenderer","MercuryParticipants","React","TextWithEmoticons.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"MercuryThreadTitle",propTypes:{isNewThread:n.bool,thread:n.object.isRequired,viewer:n.string.isRequired,showUnreadCount:n.bool,useShortName:n.bool,useAndSeparator:n.bool},getDefaultProps:function(){return {isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false};},getInitialState:function(){return {participantNames:''};},componentDidMount:function(){this._renderParticipantsList(this.props);},componentWillReceiveProps:function(p){this._renderParticipantsList(p);},render:function(){return (j.createElement("span",{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames,this.props.children));},getTitle:function(){return this.state.participantNames;},_renderThreadTitle:function(){var p=this.props.thread,q=j.createElement(k,{renderEmoticons:true,renderEmoji:true,text:p.name});if(!p.unread_count||!this.props.showUnreadCount)return q;return this._renderTitleWithUnreadCount(q,p.unread_count);},_renderParticipantsList:function(p){if(p.thread.name)return;var q=g.getParticipantIDFromUserID(p.viewer),r=p.thread.participants;if(r.length>1)r=r.filter(function(s){return s!=q;});i.getMulti(r,function(s){if(!this.isMounted())return;var t=r.map(function(w){return s[w];}),u=new h().setUseShortName(this.props.useShortName).setUseAndSeparator(this.props.useAndSeparator).setIsNewThread(this.props.isNewThread).renderParticipantList(t),v=(p.showUnreadCount&&p.thread.unread_count)?this._renderTitleWithUnreadCount(u,p.thread.unread_count):u;this.setState({participantNames:v});}.bind(this));},_renderTitleWithUnreadCount:function(p,q){return (l._("{conversation-title} ({unread-count})",[l.param("conversation-title",p),l.param("unread-count",q)]));}});e.exports=o;},null);
__d("WebMessengerThreadPermalinks",["MercuryIDs","MessagingTag","URI","WebMessengerPermalinkConstants","WWWBase","requireWeak"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m={getThreadURI:function(q,r,s){if(g.isCanonical(q)){n(q,r,s);}else o(q,r,s);}};function n(q,r,s){var t=new i(k.uri),u=g.tokenize(q).value;t.setPath(p(s)+'/'+u);r&&r(t.toString());}function o(q,r,s){l(['MercuryServerRequests'],function(t){var u=t.get();u.getServerThreadID(q,function(v){var w=new i(k.uri);w.setPath(j.getURIPathForThreadID(v,p(s)));r&&r(w.toString());});});}function p(q){var r=j.BASE_PATH;if(q&&q!=h.INBOX)r+='/'+q;return r;}e.exports=m;},null);
__d("MercuryThreadInfo",["CurrentUser","MercuryThreadMode"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={canReply:function(k){return !!(k.is_subscribed&&k.mode!=h.OBJECT_ORIGINATED&&!k.has_email_participant&&!k.read_only&&(k.recipients_loadable||k.recipients_loadable===(void 0)));},getMuteSetting:function(k){return (k.mute_settings&&k.mute_settings[j(g.getID())]);},isMuted:function(k){return i.getMuteSetting(k)!==(void 0);}};function j(k){return k+'@facebook.com';}e.exports=i;},null);
__d("MercuryChannelHandler",["Arbiter","ChannelConstants","MercuryActionType","MercuryGlobalActionType","MercuryMessages","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MercuryThreadInformer","MercuryViewer","MessagingEvent","MessagingReliabilityLogger","MessagingTag","PresenceUtil","copyProperties","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=v(n);for(var x in w)if(w.hasOwnProperty(x))z[x]=w[x];var y=w===null?null:w.prototype;z.prototype=Object.create(y);z.prototype.constructor=z;z.__superConstructor__=w;function z(aa){"use strict";this.$MercuryChannelHandler0=aa;this.__serverRequests=m.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler1=o.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler2=k.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler3=[];}z.prototype.getInstanceFBID=function(){"use strict";return this.$MercuryChannelHandler0;};z.prototype.$MercuryChannelHandler4=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!ba.obj.message){r.addEntry('channel_receive','invalid_data');return;}var ca=ba.obj.message,da=ca.other_user_fbid?ca.other_user_fbid:ca.thread_fbid,ea={author:ca.mercury_author_id,author_email:ca.mercury_author_email,body:ca.body,subject:ca.subject,has_attachment:ca.has_attachment,attachments:ca.attachments,html_body:ca.html_body,thread_id:ca.tid,thread_fbid:ca.thread_fbid,other_user_fbid:ca.other_user_fbid,message_id:ca.mid,coordinates:ca.mercury_coordinates,is_spoof_warning:ca.is_spoof_warning,ranges:ca.ranges,source:ca.mercury_source,source_tags:ca.mercury_source_tags,threading_id:ca.threading_id,timestamp:ca.timestamp,timestamp_absolute:ca.timestamp_absolute,timestamp_relative:ca.timestamp_relative,timestamp_time_passed:ca.timestamp_time_passed,action_type:i.USER_GENERATED_MESSAGE,is_unread:ca.is_unread,is_forward:false,forward_count:ca.forward_count||ca.forward,forward_message_ids:ca.forward_msg_ids,location_text:ca.location_text,folder:ba.obj.folder};if("sync_id" in ca){ea.sync_id=ca.sync_id;}else ea.action_id=ca.action_id;var fa=[u({},ea)];fa=fa.concat(ca.forward_actions||[]);var ga=l.CLIENT_CHANNEL_MESSAGE;this.__serverRequests.handleUpdateWaitForThread({actions:fa,payload_source:ga},da);if(!ca.is_unread&&p.isViewer(ca.mercury_author_id)){var ha={};ha[da]=ba.obj.folder;this.$MercuryChannelHandler6(this.__getMessagingPayloadType(),{obj:{event:q.READ,thread_fbids:ca.thread_fbid?[ca.thread_fbid]:[],other_user_fbids:ca.other_user_fbid?[ca.other_user_fbid]:[],folder_info:ha,timestamp:ca.timestamp}});}r.addEntry('channel_receive','success',[da,ea.message_id,t.getSessionID()]);};z.prototype.$MercuryChannelHandler6=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=[],da=ba.obj.event==q.READ;(ba.obj.thread_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,thread_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});(ba.obj.other_user_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,other_user_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});this.__serverRequests.handleUpdate({actions:ca,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler7=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!(ba.obj.thread_fbids||ba.obj.other_user_fbids))return;var ca=[];(ba.obj.thread_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,thread_fbid:da});});(ba.obj.other_user_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,other_user_fbid:da});});this.__serverRequests.handleUpdate({actions:ca,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler8=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids)||!ba.obj.mids)return;var ca=ba.obj.thread_fbids.length?ba.obj.thread_fbids[0]:null,da=ba.obj.other_user_fbids.length?ba.obj.other_user_fbids[0]:null,ea={action_type:i.DELETE_MESSAGES,action_id:null,thread_fbid:ca,other_user_fbid:da,message_ids:ba.obj.mids};this.__serverRequests.handleUpdate({actions:[ea],threads:[ba.obj.updated_thread],payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler9=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!ba.obj.folder)return;var ca={action_type:j.MARK_ALL_READ,action_id:ba.obj.action_id,folder:ba.obj.folder};this.__serverRequests.handleUpdate({global_actions:[ca]});};z.prototype.$MercuryChannelHandlera=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=l.CLIENT_CHANNEL_MESSAGE;(ba.obj.thread_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:da,other_user_fbid:null,archived:ba.obj.state};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ca},da);},this);(ba.obj.other_user_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:null,other_user_fbid:da,archived:ba.obj.state};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ca},da);},this);};z.prototype.$MercuryChannelHandlerb=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=l.CLIENT_CHANNEL_MESSAGE,da;(ba.obj.thread_fbids||[]).forEach(function(ea){if(ba.obj.event==q.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?s.SPAM:s.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,thread_fbid:ea,other_user_fbid:null,new_folder:da};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},fa)],payload_source:ca},ea);},this);(ba.obj.other_user_fbids||[]).forEach(function(ea){if(ba.obj.event==q.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?s.SPAM:s.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,other_user_fbid:ea,thread_fbid:null,new_folder:da};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},fa)],payload_source:ca},ea);},this);};z.prototype.$MercuryChannelHandlerc=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj.tag)return;switch(ba.obj.tag){case s.ACTION_ARCHIVED:this.$MercuryChannelHandlera(aa,ba);break;case s.INBOX:case s.OTHER:this.$MercuryChannelHandlerb(aa,ba);break;}};z.prototype.__markAsSeen=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlerd(aa)||!ba.obj||!ba.obj.seen_timestamp)return;this.__serverRequests.handleUpdate({message_counts:[{seen_timestamp:ba.obj.seen_timestamp,folder:s.INBOX}],unseen_thread_fbids:[{thread_fbids:[],other_user_fbids:[],folder:s.INBOX}],payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.__updateModelsFromMercuryPayload=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlere(aa)||!ba.obj)return;this.$MercuryChannelHandler1.synchronizeInforms(function(){var ca=ba.obj,da=[];(ca.actions||[]).forEach(function(ea){var fa=i.USER_GENERATED_MESSAGE;if(ea.action_type==i.LOG_MESSAGE){var ga=l.CLIENT_CHANNEL_MESSAGE,ha;ha=ea.other_user_fbid||ea.thread_fbid;this.__serverRequests.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ga},ha);}else if(ea.action_type!=fa)da.push(ea);},this);ca.actions=da;ca.payload_source=l.CLIENT_CHANNEL_MESSAGE;this.__serverRequests.handleUpdate(ca);}.bind(this));};z.prototype.$MercuryChannelHandlerf=function(aa,ba){"use strict";this.__serverRequests.handleRoger(ba.obj);};z.prototype.$MercuryChannelHandlerg=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||ba.obj.mute_settings===(void 0)||(!ba.obj.thread_fbid&&!ba.obj.other_user_fbid))return;var ca=i.CHANGE_MUTE_SETTINGS,da=[{action_type:ca,action_id:null,thread_fbid:ba.obj.thread_fbid,other_user_fbid:ba.obj.other_user_fbid,mute_settings:ba.obj.mute_settings}];this.__serverRequests.handleUpdate({actions:da,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.__handleMessagingPayload=function(aa,ba){"use strict";switch(ba.obj.event){case q.DELIVER:this.$MercuryChannelHandler4(aa,ba);break;case q.READ:case q.UNREAD:this.$MercuryChannelHandler6(aa,ba);break;case q.READ_ALL:this.$MercuryChannelHandler9(aa,ba);break;case q.DELETE:this.$MercuryChannelHandler7(aa,ba);break;case q.DELETE_MESSAGES:this.$MercuryChannelHandler8(aa,ba);break;case q.TAG:this.$MercuryChannelHandlerc(aa,ba);break;case q.REPORT_SPAM:this.$MercuryChannelHandlerb(aa,ba);break;case q.READ_RECEIPT:this.$MercuryChannelHandlerf(aa,ba);break;case q.CHANGE_MUTE_SETTINGS:this.$MercuryChannelHandlerg(aa,ba);break;}};z.prototype.getRouting=function(){"use strict";return {mercury:this.__updateModelsFromMercuryPayload,messaging:this.__handleMessagingPayload,inbox:this.__markAsSeen};};z.prototype.__getMessagingPayloadType=function(){"use strict";return h.getArbiterType('messaging');};z.prototype.__getMercuryPayloadType=function(){"use strict";return h.getArbiterType('mercury');};z.prototype.__getInboxPayloadType=function(){"use strict";return h.getArbiterType('inbox');};z.prototype.$MercuryChannelHandler5=function(aa){"use strict";return (aa==this.__getMessagingPayloadType());};z.prototype.$MercuryChannelHandlere=function(aa){"use strict";return (aa==this.__getMercuryPayloadType());};z.prototype.$MercuryChannelHandlerd=function(aa){"use strict";return (aa==this.__getInboxPayloadType());};z.prototype.turnOn=function(){"use strict";if(!this.$MercuryChannelHandler3.length){var aa=this.getRouting();for(var ba in aa)this.$MercuryChannelHandler3.push(g.subscribe(h.getArbiterType(ba),aa[ba].bind(this)));}return this;};z.prototype.turnOff=function(){"use strict";if(this.$MercuryChannelHandler3.length){this.$MercuryChannelHandler3.forEach(g.unsubscribe);this.$MercuryChannelHandler3=[];}return this;};u(z,n);e.exports=z;},null);
__d("MercuryRoger",["Arbiter","ArbiterMixin","immutable","JSLogger","MercuryActionStatus","MercuryServerRequests","MercurySingletonMixin","MercuryThreads","mixin","mapObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=k.SUCCESS,r=o(h);for(var s in r)if(r.hasOwnProperty(s))u[s]=r[s];var t=r===null?null:r.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=r;function u(x){"use strict";this.$MercuryRoger0={};this.$MercuryRoger1=[];this.$MercuryRoger2=x;this.$MercuryRoger3=l.getForFBID(this.$MercuryRoger2);this.$MercuryRoger4=n.getForFBID(this.$MercuryRoger2);this.$MercuryRoger3.subscribe('update-roger',function(y,z){for(var aa in z){var ba=this.$MercuryRoger0[aa]||i.OrderedMap();ba=ba.withMutations(function(ca){for(var da in z[aa]){var ea=this.$MercuryRoger4.getThreadMetaNow(aa);if(ea&&ea.participants)if(ea.participants.indexOf(da)==-1){this.$MercuryRoger0.push(w(this.$MercuryRoger0));continue;}var fa=ca.get(da),ga=z[aa][da];if(!fa||ga>fa)ca.set(da,ga);}}.bind(this));this.$MercuryRoger0[aa]=ba.sort();}z&&this.inform('change',z);}.bind(this));g.subscribe(j.DUMP_EVENT,function(y,z){z.bad_read_receipts={receipts:this.$MercuryRoger1};}.bind(this));}u.prototype.getSeenBy=function(x,y){"use strict";if(!x)return [];var z=[],aa=this.$MercuryRoger0[x.thread_id];if(!aa)return z;aa.forEach(function(ba,ca){if(v(x,ba,ca,y))z.push(ca);});return z;};u.prototype.wasSeenByAll=function(x){"use strict";if(!x)return false;var y=this.$MercuryRoger0[x.thread_id];if(!y)return false;return y.every(function(z,aa){return v(x,z,aa);});};u.prototype.getSeenTimestamps=function(x){"use strict";var y=this.$MercuryRoger0[x];if(!y){y=i.OrderedMap();this.$MercuryRoger0[x]=y;}return y;};u.prototype.getSeenTimestamp=function(x,y){"use strict";var z=this.$MercuryRoger0[x];return z?z.get(y):null;};Object.assign(u,m);function v(x,y,z,aa){return !!(y>x.timestamp&&(x.status===(void 0)||x.status===q)&&(!aa||z!=x.author));}function w(x){return p(x,function(y){return y.toJS();});}e.exports=u;},null);
__d("MercuryDelayedRoger",["ArbiterMixin","LiveTimer","MercuryActionStatus","MercuryConfig","setTimeoutAcrossTransitions","MercuryMessages","MercuryRoger","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=b('MercuryMessages').get(),m=b('MercuryRoger').get(),n=b('MercuryThreadInformer').get(),o=b('MercuryThreads').get(),p={},q={},r=j['roger.seen_delay'],s={getSeenBy:function(y,z){if(q[y])return [];return m.getSeenBy(t(y),z);},wasSeenByAll:function(y){if(q[y])return false;return m.wasSeenByAll(t(y));}};Object.assign(s,g);function t(y){if(!p[y]){var z=o.getThreadMetaNow(y);if(z)p[y]={thread_id:y,author:z.participants[0],timestamp:z.timestamp};}return p[y];}function u(y){var z=false;l.getThreadMessagesRange(y,0,1,function(aa){var ba=aa[0];if(!ba)return;var ca=ba.timestamp;if(ba.action_id||ba.status==i.SUCCESS)ca-=h.getServerTimeOffset();var da=s.getSeenBy(y);if(q[y]){clearTimeout(q[y]);delete q[y];}var ea=ca+r,fa=ea-Date.now();if(fa>0)q[y]=k(function(){delete q[y];v(y);},fa);p[y]=ba;var ga=s.getSeenBy(y);if(da.length||ga.length)z=true;});return z;}function v(y){var z={};z[y]=true;w(z);}function w(y){s.inform('state-changed',y);s.inform('change');}function x(event,y){var z={};for(var aa in y)if(u(aa))z[aa]=true;for(var ba in z){w(z);break;}}m.subscribe('change',function(y,z){for(var aa in z)!q[aa]&&v(aa);});n.subscribe('messages-received',x);n.subscribe('messages-reordered',x);n.subscribe('messages-updated',x);e.exports=s;},null);
__d("MercuryFolders",["MessagingTag","arrayContains"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=[g.INBOX,g.OTHER,g.ACTION_ARCHIVED,g.SPAM],j={getSupportedFolders:function(){return i.concat();},isSupportedFolder:function(k){return h(i,k);},getFromMeta:function(k){var l=k.folder;if(k.is_archived)l=g.ACTION_ARCHIVED;return l;}};e.exports=j;},null);
__d("MercuryUnreadState",["MercuryFolders","LogHistory","KeyedCallbackManager","MercuryActionType","MercuryGlobalActionType","MercurySingletonMixin","MercuryThreadlistConstants","MessagingTag","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","arrayContains","copyProperties","createObjectFrom"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=(g.getSupportedFolders()||[]).filter(function(ma){return ma!=n.ACTION_ARCHIVED;}),v='unread_thread_hash',w='unseen_thread_list',x=m.MAX_UNREAD_COUNT,y=h.getInstance('mercury_unread_state');function z(ma){this._fbid=ma;this._serverRequests=o.getForFBID(this._fbid);this._threadInformer=p.getForFBID(this._fbid);this._threads=q.getForFBID(this._fbid);this._allReadTimestamp={};this._threadReadTimestamp={};this._initialUnreadCount={};this._maxCount={};this._unreadResources={};u.forEach(function(na){this._initialUnreadCount[na]=0;this._maxCount[na]=false;this._unreadResources[na]=new i();}.bind(this));this._serverRequests.subscribe('update-unread',function(na,oa){ea(this,oa);var pa=oa.global_actions||[];for(var qa=0;qa<pa.length;qa++){var ra=pa[qa];if(ra.action_type==k.MARK_ALL_READ)ha(this,ra.folder,ra.timestamp);}}.bind(this));this._serverRequests.subscribe('update-thread-ids',function(na,oa){ja(this,oa);}.bind(this));}s(z.prototype,{getUnreadCount:function(ma){if(this.exceedsMaxCount(ma)){y.error('unguarded_unread_count_fetch',{});return 0;}return da(this,ma);},exceedsMaxCount:function(ma){return this._maxCount[ma]||(da(this,ma)>x);},markFolderAsRead:function(ma){if(this._maxCount[ma]||da(this,ma)>0)this._serverRequests.markFolderAsRead(ma);},getIsThreadUnread:function(ma,na){var oa=na||n.INBOX,pa=ca(this,oa);return pa&&pa[ma];}});s(z,l);function aa(ma,na,oa){ma._unreadResources[na].setResource(v,oa);ma._unreadResources[na].setResource(w,Object.keys(oa));}function ba(ma,na,oa){var pa=ma._unreadResources[na].executeOrEnqueue(v,oa),qa=ma._unreadResources[na].getUnavailableResources(pa);if(qa.length)ma._serverRequests.fetchUnreadThreadIDs(na);}function ca(ma,na){return ma._unreadResources[na].getResource(v);}function da(ma,na){var oa=ma._unreadResources[na].getResource(w);if(oa){return oa.length;}else return ma._initialUnreadCount[na];}function ea(ma,na){var oa;(na.unread_thread_fbids||[]).forEach(function(pa){oa=pa.folder;if(!la(oa))return;var qa=pa.thread_fbids||[];qa=qa.concat(pa.other_user_fbids||[]);var ra=ia(ma,qa);aa(ma,oa,t(ra,true));if(ra.length>x)ma._maxCount[oa]=true;ma._threadInformer.updatedUnreadState();});(na.message_counts||[]).forEach(function(pa){if(pa.unread_count===(void 0))return;oa=pa.folder;if(pa.unread_count>x){ma._maxCount[oa]=true;aa(ma,oa,{});ma._threadInformer.updatedUnreadState();}else{ma._initialUnreadCount[oa]=pa.unread_count;if(ma._initialUnreadCount[oa]===0)aa(ma,oa,{});ma._threadInformer.updatedUnreadState();}});(na.actions||[]).forEach(function(pa){if(pa.is_forward)return;var qa=j,ra=pa.other_user_fbid?pa.other_user_fbid:pa.thread_fbid,sa=pa.thread_id?pa.thread_id:ra;if(pa.action_type==qa.DELETE_THREAD){u.forEach(function(ua){ga(ma,ua,sa);});}else if(pa.action_type==qa.CHANGE_ARCHIVED_STATUS||pa.action_type==qa.CHANGE_FOLDER){var ta=ma._threads.getThreadMetaNow(pa.thread_id);oa=g.getFromMeta(ta);if(la(oa)&&ta.unread_count>0)fa(ma,oa,sa);u.forEach(function(ua){if(ua!=oa)ga(ma,ua,sa);});}else{oa=ka(ma,pa);if(!la(oa))return;if(pa.action_type==qa.CHANGE_READ_STATUS){if(pa.mark_as_read){ga(ma,oa,sa,pa.timestamp);}else fa(ma,oa,sa,pa.timestamp);}else if(pa.action_type==qa.USER_GENERATED_MESSAGE||pa.action_type==qa.LOG_MESSAGE)if(pa.is_unread)fa(ma,oa,sa,pa.timestamp);}});}function fa(ma,na,oa,pa){if(ma._maxCount[na])return;ba(ma,na,function(qa){var ra=ma._allReadTimestamp[na]||0,sa=ma._threadReadTimestamp[oa]||0,ta=pa||Number.POSITIVE_INFINITY;if(ta>=ra&&ta>=sa&&!qa[oa]){qa[oa]=pa||0;aa(ma,na,qa);ma._threadInformer.updatedUnreadState();}});}function ga(ma,na,oa,pa){if(ma._maxCount[na])return;ba(ma,na,function(qa){if(pa){var ra=ma._threadReadTimestamp[oa];if(!ra||ra<pa)ma._threadReadTimestamp[oa]=pa;}var sa=qa[oa];if(pa&&typeof sa=='number'&&pa<sa)return;if(oa in qa){delete qa[oa];aa(ma,na,qa);ma._threadInformer.updatedUnreadState();}});}function ha(ma,na,oa){ma._maxCount[na]=false;aa(ma,na,{});ma._allReadTimestamp[na]=Math.max(ma._allReadTimestamp[na]||0,oa||0);ma._threadInformer.updatedUnreadState();}function ia(ma,na){return na.map(ma._serverRequests.convertThreadIDIfAvailable,ma._serverRequests);}function ja(ma,na){u.forEach(function(oa){var pa=ca(ma,oa);if(!pa)return;for(var qa in na){var ra=na[qa];if(pa[qa]){pa[ra]=pa[qa];delete pa[qa];}}aa(ma,oa,pa);});}function ka(ma,na){var oa=na.thread_id?ma._threads.getThreadMetaNow(na.thread_id):null;return oa?g.getFromMeta(oa):na.folder;}function la(ma){return r(u,ma);}e.exports=z;},null);