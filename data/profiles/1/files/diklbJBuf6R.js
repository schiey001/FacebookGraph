/*!CK:983163955!*//*1432309758,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["vbVbc"]); }

__d("PrivacyRemindersLoggingTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ONLY_ME_IMPRESSION:"only_me_impression",ONLY_ME_CONVERSION:"only_me_conversion",EVERYONE_IMPRESSION:"everyone_impression",EVERYONE_CONVERSION:"everyone_conversion",EVERYONE_TESTS_IMPRESSION:"everyone_tests_impression",EVERYONE_TESTS_CONVERSION:"everyone_tests_conversion",PUBLIC_POSTING_FILTER_NUX_IMPRESSION:"public_posting_filter_nux_impression",PUBLIC_POSTING_FILTER_NUX_CONVERSION:"public_posting_filter_nux_conversion",DELTA_EVERYONE_IMPRESSION:"delta_everyone_impression",DELTA_EVERYONE_CONVERSION:"delta_everyone_conversion",DELTA_EVERYONE_OK_BUTTON_CLICKED:"delta_everyone_ok_button_clicked",DELTA_EVERYONE_CHANGE_BUTTON_CLICKED:"delta_everyone_change_button_clicked"};},null);
__d("SuggestionConfig",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={GROUP_POST_COMPOSER:"grouppostcomposer",OG_SUGGESTION_BY_INPUT:"ogsuggestionbyinput",COMPOSER_ENTRY_BOOTSTRAP:"composerentrybootstrap",MTOUCH_COMPOSER_ENTRY_BOOTSTRAP:"mtouchcomposerentrybootstrap",MTOUCH_COMPOSER_LOAD_VERBS:"mtouchcomposerloadverbs"};},null);
__d("SuggestionUIPresentation",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FLYOUT:1,TAGGER_BADGE:2,ADD_TAG:3,SEMI_INLINE:4,TOP_OF_VERBS:5};},null);
__d("ComposerXAttachmentButtonBarState",["CSS","DOMQuery","csx","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={trackCityChanges:function(l){var m=l.getComponent('citysharericon');if(m)return m.instance.subscribe('change',function(){k.updateMessageBoxBarState(l);});},updateMessageBoxBarState:function(l){var m=l.getComponent('citysharericon');if(m){var n=h.find(l.getRoot(),"._1dsp");g.conditionClass(n,"_icv",!!m.instance.getValue());}}};e.exports=k;},null);
__d("ComposerXAttachmentPrefillMixin",["Event","InputSelection"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={_initPrefill:function(j,k){this._textArea=j;this._didInitialFocus=false;this._prefill=k;if(this._prefill)this._focusListener=g.listen(this._textArea,'focus',this._prefillOnFocus.bind(this));},_resetPrefill:function(){this._didInitialFocus=false;},_prefillOnFocus:function(){if(!this._didInitialFocus&&this._prefill&&this._textArea.value===''){this._textArea.value=this._prefill;h.set(this._textArea,0,0);}this._didInitialFocus=true;}};e.exports=i;},null);
__d("ComposerXAttachmentUtils",["BrowserSupport","Button","ComposerXController","DataStore","DOMQuery","Event","Focus","Keys","Run","StickyPlaceholderInput","UserAgent_DEPRECATED","csx","debounce"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t='composer_fixed_placeholder';function u(w,x){if(!j.get(w.element,t,false))w.instance.setPlaceholder(x);}var v={initMentions:function(w,x,y,z){u(w,x);if(!z||!z.dontFocusMentions)v.focusMentions(w);this.registerMentionsForComposerCancel(w,y);},focusMentions:function(w){var x=k.find(w.element,'textarea.input');m.set(x);},registerMentionsForComposerCancel:function(w,x){i.registerConditionForComposerCancel(x,w.instance.hasChanges.bind(w.instance));},setStickyPlaceholderForMentions:function(w,x){u(w,x);},setPlaceholderIsFixed:function(w,x){j.set(w.element,t,!!x);},setStickyPlaceholderForTypeahead:function(w,x){var y=k.find(w,'.textInput');p.setPlaceholderText(y,x);},listenForPostSubmission:function(w){l.listen(w,'keydown',function(event){var x=event.getModifiers(),y=q.osx()?x.meta:x.control,z=k.find(w.form,"._11b"+'[type="submit"]');if((event.keyCode===n.RETURN)&&y&&h.isEnabled(z)){w.blur();if(l.fire(z,'click'))l.fire(w.form,'submit');event.preventDefault();}});},disableSaveOnEmpty:function(w,x){var y=k.find(w,'.textInput'),z=s(function(ba){h.setEnabled(x,y.value.trim().length!==0);},50),aa=[];aa.push(l.listen(y,'keyup',z));if(g.hasClipboardEvents()){aa.push(l.listen(y,'cut',z));aa.push(l.listen(y,'paste',z));}else{aa.push(l.listen(y,'mouseout',z));aa.push(l.listen(y,'mousemove',z));}o.onUnload(function(){for(var ba=0;ba<aa.length;ba++)aa[ba].remove();aa=null;});}};e.exports=v;},null);
__d("XPrivacyAudienceAlignmentLoggingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/privacy\/audience_alignment\/log\/",{client_time:{type:"Int"},event:{type:"Enum",required:true,enumType:1},product:{type:"Enum",required:true,enumType:1},shown_duration:{type:"Float"},value:{type:"Int"}});},null);
__d("AudienceAlignment",["Arbiter","AsyncRequest","AudienceSelector","ComposerXStore","ContextualDialog","CSS","cx","DialogExpansion","DOM","Event","Focus","Keys","ModalMask","PrivacyConst","SelectorDeprecated","Style","XPrivacyAudienceAlignmentLoggingController","curry","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){b.__markCompiled&&b.__markCompiled();var z=false,aa,ba,ca,da;function ea(hb,ib){hb.setContext(ib);hb.show();}function fa(hb,ib){var jb=v.get(ib.getContentRoot(),'margin-top');hb.setWidth(this.aaa_dialog_width);hb.show();v.set(hb.getContentRoot(),'margin-top',jb);}var ga='wwwtux',ha='onlyme-wwwtux',ia='exposed',ja='public_sticky',ka='friends_sticky',la='only_me_sticky',ma='custom_selection',na='selector',oa='holdout',pa='dismissal',qa='learn_more',ra='blur',sa='posted';function ta(hb,event,ib){var jb=w.getURIBuilder().setEnum('product',hb).setEnum('event',event).setInt('client_time',Date.now());da&&jb.setFloat('shown_duration',(Date.now()-da)/1000);ib&&jb.setInt('value',ib);var kb=new h().setURI(jb.getURI());kb.send();}function ua(hb,ib,jb,kb,lb){if(z)return false;if(!o.contains(document.body,ib.getRoot()))return false;var mb=j.get(jb,'maininput');if(mb&&mb.instance.getValue())return false;if(!kb)return false;var nb=null;if(lb){nb=lb.getSelectedBaseValue();}else nb=parseInt(u.getValue(kb),10);return (nb===hb);}function va(){var hb=o.scry(document.body,'#pagelet_timeline_recent');if(hb.length>=1){var ib=o.scry(hb[0],'li.fbTimelineComposerCapsule');if(ib.length>=1)return ib[0];}return null;}function wa(hb,ib,jb,kb){var lb;if(kb){lb=kb.getMenuElement();}else{var mb=o.find(jb,'div.audienceSelector');lb=o.scry(mb,'div.wrap');}if(lb.length<1)return;var nb=va(),ob;if(kb){kb.subscribeOnce('open',function(){if(nb)l.addClass(nb,"_2wc-");k.setContext(ib,lb);ib.show();});}else ob=u.listen(mb,'open',function(){var rb=o.scry(lb[0],'div.uiSelectorMenuWrapper');if(rb.length>0){if(nb)l.addClass(nb,"_2wc-");k.setContext(ib,rb[0]);ib.setOffsetX(12);ib.show();}else s.hide();u.unsubscribe(ob);});if(kb){kb.getPopover().subscribeOnce('hide',function(){xa(ib,lb,nb,hb);});}else var pb=u.listen(mb,'close',function(){xa(ib,lb[0],nb,hb);u.unsubscribe(pb);});if(kb){l.addClass(lb,"_35mn");var qb=kb.getTriggerButtonElement();l.addClass(qb,"_35mn");}else l.addClass(lb[0],"_35mn");setTimeout(function(){s.show();v.set(s.getNode(),'opacity','0.3');v.set(s.getNode(),'background-color','rgb(0,0,0)');if(kb){kb.openSelectorExpanded();}else u.toggle(mb);},20);}function xa(hb,ib,jb,kb){s.hide();hb.hide();l.removeClass(ib,"_35mn");if(jb)l.removeClass(jb,"_2wc-");q.set(o.find(kb.getRoot(),'textarea.input'));}function ya(hb,ib,jb){hb.unsubscribe(ba);hb.hide();q.set(o.find(ib.getRoot(),'textarea.input'));ca=p.listen(ib.getRoot(),'submit',function(){ta(jb,sa);ca&&ca.remove();});y(ca);}function za(hb){var ib=bb(hb);return ib&&ib.element;}function ab(hb){var ib=bb(hb);return ib&&ib.instance&&ib.instance.getInstance().getInstance();}function bb(hb){return j.get(hb,'mainprivacywidget');}function cb(hb,ib,jb,kb,lb,mb){var nb=za(hb),ob=ab(hb),pb=fb(kb),qb=eb(kb);if(pb===null||!qb)return;ya(jb,ib,mb);if(ob){ob.selectOption(pb);}else i.setAudience(ib.getRoot(),kb);ea(lb,nb);ta(mb,qb);}function db(hb){switch(hb){case t.BaseValue.EVERYONE:return ga;case t.BaseValue.SELF:return ha;default:return null;}}function eb(hb){switch(hb){case t.BaseValue.EVERYONE:return ja;case t.BaseValue.ALL_FRIENDS:return ka;case t.BaseValue.SELF:return la;default:return null;}}function fb(hb){switch(hb){case t.BaseValue.EVERYONE:return t.PostParam.EVERYONE;case t.BaseValue.ALL_FRIENDS:return t.PostParam.FRIENDS;case t.BaseValue.SELF:return t.PostParam.ONLY_ME;default:return null;}}var gb={abort:function(){z=true;},startOnComposerFocus:function(hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb){var ac=db(hb);if(!ac)return;g.subscribe('composer/focus',function(){var bc=za(zb),cc=ab(zb);if(ua(hb,jb,zb,bc,cc)){da=Date.now();if(ib){ta(ac,oa);}else{ta(ac,ia);setTimeout(function(){kb.show();var dc=sb.parentElement;this.aaa_dialog_width=kb.getWidth()+dc.offsetWidth-490;var ec=new n(kb);ec.setTargetWidth(this.aaa_dialog_width);ec._onAfterShow();q.set(kb.getRoot());},100);}}});p.listen(sb,'click',x(cb,zb,jb,kb,rb,lb,ac));p.listen(ub,'click',x(cb,zb,jb,kb,tb,mb,ac));p.listen(vb,'click',function(){kb.subscribe('hide',function(){var bc=za(zb),cc=ab(zb);if(cc)cc.subscribeOnce('changed',function(event,dc){ta(ac,ma,dc.base_value);});if(nb)wa(jb,nb,bc,cc);});ya(kb,jb,ac);ta(ac,na);});if(wb)p.listen(wb,'click',function(){var bc=za(zb);ya(kb,jb,ac);ta(ac,pa);if(ob)ea(ob,bc);});ba=kb.subscribe('hide',function(){var bc=za(zb);q.set(o.find(jb.getRoot(),'textarea.input'));ta(ac,pa);if(pb)ea(pb,bc);});aa=kb.subscribe('blur',function(){ta(ac,ra);});p.listen(xb,'click',function(event){fa(qb,kb);ta(ac,qa);});p.listen(yb,'click',function(event){qb.hide();});if(wb)p.listen(qb.getRoot(),'keydown',function(event){if(p.getKeyCode(event)===r.ESC){qb.hide();p.kill(event);}});}};e.exports=gb;},null);
__d("ComposerXAttachmentWithPreviews",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={initPreviewButton:function(i,j){g.inform('page_composer_preview_form_initialized',i);}};e.exports=h;},null);
__d("PagesComposerEntryLogger",["Event","PagesBanzaiLogger"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this.$PagesComposerEntryLogger0=j;}i.prototype.registerForContentEntryEvents=function(j){"use strict";var k=function(){var l={page_id:this.$PagesComposerEntryLogger0,event_name:'composer_content_entry',pages_composer:1,target_id:this.$PagesComposerEntryLogger0};h.logData(l,h.VITAL_WAIT);this.unregister();};this.$PagesComposerEntryLogger1=g.listen(j,{paste:k.bind(this),keydown:k.bind(this)});};i.prototype.unregister=function(){"use strict";if(!this.$PagesComposerEntryLogger1)return;for(var event in this.$PagesComposerEntryLogger1)this.$PagesComposerEntryLogger1[event].remove();this.$PagesComposerEntryLogger1=null;};e.exports=i;},null);
__d("XPrivacyRemindersImpressionLoggingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/privacy\/reminders\/log_imp\/",{type:{type:"String",required:true}});},null);
__d("ComposerXBootloadStatusAttachment",["requireWeak","Arbiter","AsyncRequest","AudienceAlignment","BanzaiLogger","Bootloader","ComposerXAttachment","ComposerXAttachmentButtonBarState","ComposerXAttachmentPrefillMixin","ComposerXAttachmentUtils","ComposerXAttachmentWithPreviews","ComposerXController","ComposerXDragDrop","ComposerXMarauderLogger","ComposerXStore","CSS","DOM","DOMQuery","Event","Focus","NoNewerStoryInsertionWhileComposingGK","PagesComposerEntryLogger","Parent","FocusListener","PrivacyConst","PrivacyRemindersLoggingTypes","SelectorDeprecated","SubscriptionsHandler","SuggestionConfig","SuggestionUIPresentation","URI","XUIError","classWithMixins","copyProperties","createCancelableFunction","csx","cx","fbt","getActiveElement","mixin","requestAnimationFrame","XPrivacyRemindersDismissController","XPrivacyRemindersImpressionLoggingController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa){b.__markCompiled&&b.__markCompiled();var xa;g(['LitestandStoryInsertionStatus'],function(eb){xa=eb;});var ya={only_me:{PRIVACY_CONSTANT:[ea.BaseValue.SELF],LOG_IMPRESSION:fa.ONLY_ME_IMPRESSION,LOG_CONVERSION:fa.ONLY_ME_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:true},everyone:{PRIVACY_CONSTANT:[ea.BaseValue.EVERYONE],LOG_IMPRESSION:fa.EVERYONE_IMPRESSION,LOG_CONVERSION:fa.EVERYONE_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:true},delta_everyone:{PRIVACY_CONSTANT:[ea.BaseValue.EVERYONE],LOG_IMPRESSION:fa.DELTA_EVERYONE_IMPRESSION,LOG_CONVERSION:fa.DELTA_EVERYONE_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:true},everyone_tests:{PRIVACY_CONSTANT:[ea.BaseValue.EVERYONE],LOG_IMPRESSION:fa.EVERYONE_TESTS_IMPRESSION,LOG_CONVERSION:fa.EVERYONE_TESTS_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:true},public_posting_filter_nux:{PRIVACY_CONSTANT:[ea.BaseValue.EVERYONE],LOG_IMPRESSION:fa.PUBLIC_POSTING_FILTER_NUX_IMPRESSION,LOG_CONVERSION:fa.PUBLIC_POSTING_FILTER_NUX_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:true}},za={},ab=ma(m,ta(o,q));for(var bb in ab)if(ab.hasOwnProperty(bb))db[bb]=ab[bb];var cb=ab===null?null:ab.prototype;db.prototype=Object.create(cb);db.prototype.constructor=db;db.__superConstructor__=ab;function db(eb,fb){"use strict";ab.call(this);this._root=eb;this._config=fb;this._privacyReminders={};this._onSelectorChange=this._onSelectorChange.bind(this);if(xa&&aa.no_insertion_while_composing)xa.registerBlocker(function(){return this._isFocused();}.bind(this));}db.prototype.getRoot=function(){"use strict";return this._root;};db.prototype.getPrivacyInstance=function(){"use strict";return this._newPrivacyWidgetInstance;};db.prototype._getTextArea=function(){"use strict";return x.find(this.getComponent('maininput').element,'textarea.input');};db.prototype.initWithComponents=function(eb){"use strict";za[this._composerID]=this;this._attachmentIsActive=true;var fb=this._getTextArea(),gb=x.scry(ca.byClass(this.getRoot(),"_119"),'li.'+this.attachmentClassName)[0];this._focusListener=y.listen(fb,'focus',this._onFocus.bind(this,'area_focus'));if(this._config.prefill_text)this._initPrefill(fb,this._config.prefill_text);if(eb&&this._config.targetIsPage){this._pagesComposerEntryLogger=new ba(this._config.targetID);this._pagesComposerEntryLogger.registerForContentEntryEvents(fb);}if(this._fullVersion){this._fullInitWithComponents();}else if(!this._bootloading)if(this._isFocused()){this._onFocus('is_focused');}else if(gb)this._clickListener=y.listen(gb,'click',function(){z.set(fb);}.bind(this));this._dragEnterHandler=h.subscribe('dragenter',function(hb,ib){if(ib.element==this._root){j.abort();var jb=ib.event.dataTransfer.items,kb;if(jb)kb=s.filterImages(jb);if(kb&&kb.length>0){z.set(fb);}else{var lb=ca.byClass(this._root,'focus_target');da.expandInput(lb);this._onFocus('drag_focus');}}}.bind(this));this.getComponent('maininput').instance.setPlaceholder(this._config.mentionsPlaceholder);if(!eb)z.set(fb);if(this._config.plus_version){this._dragdrop=new s(this._root,this._composerID,this._config.targetID);this._dragdrop.enableURLDropping();}this._initPrivacyWidgetInstance();if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);if(this._config.previewButton)this.initPreviewButton(this._root,this._config.previewButton);};db.prototype._initPrivacyWidgetInstance=function(){"use strict";var eb=this.getComponent('mainprivacywidget');if(!eb)return;this._privacyWidgetElement=eb.element;this._newPrivacyWidgetInstance=eb.instance&&eb.instance.getInstance().getInstance();if(this._newPrivacyWidgetInstance){var fb=this.getComponent('maininput').instance&&this.getComponent('maininput').instance.getMentions(),gb=this.getComponent('tagExpansionButton');(gb&&gb.instance)&&gb.instance.listenToPrivacy(this._newPrivacyWidgetInstance,fb);}};db.prototype._fullInitWithComponents=function(eb){"use strict";this._bootloadCallback=oa(this._bootloadModules.bind(this));if(eb&&eb.show_tag_expansion_reminder){l.loadModules(["ComposerXPrivacyWidgetTags","URLScraper","SuggestionScraper","URI","ComposerTagReminder"],this._bootloadCallback);}else l.loadModules(["ComposerXPrivacyWidgetTags","URLScraper","SuggestionScraper","URI"],this._bootloadCallback);Object.keys(this._privacyReminders).forEach(this._showPrivacyReminder,this);if(this._setEveryonePrivacyImpression)this._showPrivacyReminder('everyone');if(this._privacyReminders.delta_everyone&&this._privacyReminders.delta_everyone.dialog){var fb=this._privacyReminders.delta_everyone.dialog.getContent();if(fb){var gb=x.scry(fb,'.photoText')[0],hb=x.scry(fb,'.postText')[0];h.subscribe('multi-upload/images-added',function(){gb&&v.show(gb);hb&&v.hide(hb);}.bind(this));h.subscribe('multi-upload/all-images-removed',function(){gb&&v.hide(gb);hb&&v.show(hb);}.bind(this));}}if(this._newPrivacyWidgetInstance){this._newPrivacyWidgetInstance.subscribe('changed',this._onSelectorChange);}else ga.subscribe('select',this._onSelectorChange);};db.prototype._bootloadModules=function(eb,fb,gb,hb,ib){"use strict";this._modulesAreBootloaded=true;this._tagger.init(this);this._privacyWidgetTags=new eb(this);if(ib){this._tagExpansionReminder=new ib(this);this._tagExpansionReminder.listen();}n.trackCityChanges(this);var jb=x.find(this.getComponent('maininput').element,'textarea.input');if(!this._scraper){this._scraper=new fb(jb);this._scraper.subscribe('match',function(mb,nb){var ob=this._getScraperEndpoint();ob.addQueryData({scrape_url:encodeURIComponent(nb.url),remove_url:this._config.remove_url,attachment_class:this._config.classname});r.getAttachment(this._root,ob.toString());}.bind(this));}this._scraper.enable();this._scraper.check();var kb=w.scry(this._root,"._4-jj"),lb=this.getComposerID();if(this._config.stream_context==='home'&&kb&&kb.length&&this._tagger&&lb)if(!this._suggestionScraper){this._suggestionScraper=new gb(this._tagger,kb[0],[ja.SEMI_INLINE,ja.TAGGER_BADGE,ja.TOP_OF_VERBS],lb);this._suggestionScraper.setBootloadTriggerConfig(ia.COMPOSER_ENTRY_BOOTSTRAP);}};db.prototype._showPrivacyReminder=function(eb){"use strict";var fb=this,gb=this._privacyReminders[eb],hb=ya[eb],ib=null;if(this._newPrivacyWidgetInstance){ib=this._newPrivacyWidgetInstance.getSelectedBaseValue();}else ib=parseInt(ga.getValue(this._privacyWidgetElement),10);if(!gb||!gb.dialog||gb.shown){if(ib===ea.BaseValue.EVERYONE&&this._setEveryonePrivacyImpression){this._sendSetEveryonePrivacyImpression();this._setEveryonePrivacyImpression=false;}return;}if(hb.PRIVACY_CONSTANT.indexOf(ib)===-1)return;gb.dialog.setContext(this._privacyWidgetElement).show();gb.shown=true;this._privacyReminderShown=true;if(hb.LOG_IMPRESSION){var jb=(wa.getURIBuilder()).setString('type',hb.LOG_IMPRESSION).getURI();new i(jb).send();}if(hb.LOG_IMPRESSION_TO_DISMISS_ENDPOINT)if(eb==='delta_everyone'||eb==='only_me'){var kb=(va.getURIBuilder()).setString('type',eb).getURI();new i(kb).send();}else new i('/ajax/privacy/reminders/dismiss').setData({type:eb,dismiss_type:'impression'}).send();var lb=function(event){var mb=v.hasClass(event.target,'layerConfirm')||x.scry(event.target,'^.layerConfirm').length===1,nb=v.hasClass(event.target,'layerButton')||x.scry(event.target,'^.layerButton').length===1;if(mb&&eb!=='public_posting_filter_nux'){if(eb==='delta_everyone'||eb==='only_me'){var ob=(wa.getURIBuilder()).setString('type',fa.DELTA_EVERYONE_OK_BUTTON_CLICKED).getURI();new i(ob).send();}return;}if(eb==='delta_everyone'||eb==='only_me'){var pb=(va.getURIBuilder()).setString('type',eb).getURI();new i(pb).send();}else new i('/ajax/privacy/reminders/dismiss').setData({type:eb,hide:nb}).send();gb.events.forEach(function(rb){rb.remove();});gb.events=[];gb.dialog.hide();this._privacyReminderShown=false;if(nb){ua(function(){if(this._newPrivacyWidgetInstance){this._newPrivacyWidgetInstance.openSelector();}else ga.toggle(x.scry(fb.getComponent('mainprivacywidget').element,'.uiSelector')[0]);}.bind(this));if(eb==='delta_everyone'){var qb=(wa.getURIBuilder()).setString('type',fa.DELTA_EVERYONE_CHANGE_BUTTON_CLICKED).getURI();new i(qb).send();}}}.bind(this);if(this._newPrivacyWidgetInstance){gb.conversionListener=this._newPrivacyWidgetInstance.subscribe('changed',function(mb,nb){var ob=this._newPrivacyWidgetInstance.getSelectedBaseValue();this._logPrivacyReminderConversion(gb,hb,ob);}.bind(this));}else gb.conversionListener=ga.subscribe('select',function(mb,nb){if(nb.selector==this._privacyWidgetElement.firstChild){var ob=parseInt(ga.getValue(nb.option),10);this._logPrivacyReminderConversion(gb,hb,ob);}}.bind(this));gb.events=[y.listen(gb.dialog.getContent(),'click',lb),y.listen(gb.dialog.getContext(),'click',lb)];};db.prototype._logPrivacyReminderConversion=function(eb,fb,gb){"use strict";if(fb.PRIVACY_CONSTANT.indexOf(gb)===-1){if(fb.LOG_CONVERSION){var hb=(wa.getURIBuilder()).setString('type',fb.LOG_CONVERSION).getURI();new i(hb).send();}if(this._newPrivacyWidgetInstance){this._newPrivacyWidgetInstance.unsubscribe(eb.conversionListener);}else ga.unsubscribe(eb.conversionListener);eb.conversionListener=null;}};db.prototype._onSelectorChange=function(eb,fb){"use strict";if(!this.getComponent('mainprivacywidget'))return;if(this._newPrivacyWidgetInstance||(fb.selector===this._privacyWidgetElement.firstChild))setTimeout(function(){Object.keys(this._privacyReminders).forEach(this._showPrivacyReminder,this);}.bind(this));if(this._tagExpansionReminder)this._tagExpansionReminder.updateReminderText(fb.post_param);};db.prototype.cleanup=function(){"use strict";this._attachmentIsActive=false;if(this._focusListener){this._focusListener.remove();this._focusListener=null;}if(this._clickListener){this._clickListener.remove();this._clickListener=null;}Object.keys(ya).forEach(function(eb){var fb=this._privacyReminders[eb];if(fb&&fb.dialog&&fb.shown){fb.dialog.hide();fb.events.forEach(function(gb){gb.remove();});fb.events=[];if(fb.conversionListener)if(this._newPrivacyWidgetInstance){this._newPrivacyWidgetInstance.unsubscribe(fb.conversionListener);}else ga.unsubscribe(fb.conversionListener);fb.conversionListener=null;}}.bind(this));if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}if(this._modulesAreBootloaded){this._tagger.cleanup();this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._scraper.disable();}if(this._bootloadCallback){this._bootloadCallback.cancel();this._bootloadCallback=null;}if(this._dragEnterHandler){this._dragEnterHandler.unsubscribe();this._dragEnterHandler=null;}if(this._pagesComposerEntryLogger)this._pagesComposerEntryLogger.unregister();};db.prototype.reset=function(){"use strict";var eb=ca.byClass(this._root,"child_was_focused");if(eb)v.removeClass(eb,"child_was_focused");if(this._tagger)this._tagger.reset();if(this._scraper)this._scraper.reset();if(this._newPrivacyWidgetInstance)this._newPrivacyWidgetInstance.informTagsChanged([]);this.getComponent('maininput').instance.setPlaceholder(this._config.mentionsPlaceholder);if(this._config.prefill_text)this._resetPrefill();};db.prototype.canSwitchAway=function(){"use strict";return !ca.byClass(this._root,'async_saving');};db.prototype.bootloadAttachments=function(){"use strict";if(this._bootloading)return;this._bootloading=true;r.getEndpoint(this._root,'/ajax/composerx/attachment/status/bootload/',true);};db.prototype.setBootloadedContent=function(eb){"use strict";this._bootloading=false;this._setEveryonePrivacyImpression=!!eb.set_everyone_privacy_impression;Object.keys(ya).forEach(function(ib){var jb=eb[ib+'_privacy_reminder'];if(jb)this._privacyReminders[ib]={dialog:jb};}.bind(this));if(eb.markup.privacy_widget){var fb=x.find(this._root,"._etn");w.setContent(fb,eb.markup.privacy_widget);var gb=x.find(this._root,"._1dwm");if(gb){gb.disabled=false;v.removeClass(gb,"_42fr");}}var hb=eb.placeholders.map(function(ib){return ib.component_name;});u.waitForComponents(this._composerID,hb,function(){var ib=x.find(this._root,"._3-6"),jb=x.find(this._root,"._3-7");w.setContent(ib,eb.markup.tagger_content);w.setContent(jb,eb.markup.tagger_icons);if(eb.markup.privacy_widget)this._initPrivacyWidgetInstance();r.addPlaceholders(this._root,this,eb.placeholders);this._tagger=eb.tagger;n.updateMessageBoxBarState(this);this._fullVersion=true;if(this._attachmentIsActive)this._fullInitWithComponents(eb);p.registerMentionsForComposerCancel(this.getComponent('maininput'),this.getComposerID());}.bind(this));};db.prototype._getScraperEndpoint=function(){"use strict";return new ka('/ajax/composerx/attachment/link/scraper/');};db.prototype._isFocused=function(){"use strict";return x.contains(this._root,sa());};db.prototype._onFocus=function(eb){"use strict";t.logEntry(this._composerID);k.log('WebComposerSampledWaterfallLoggerConfig',{event:'js_composer_focus',client_time:Date.now(),config:this._config,composerID:this._composerID,source:eb});this._prefillOnFocus();if(this._fullVersion||this._bootloading)return;h.inform('composer/focus',this._composerID);h.inform('composer/render_pab_nux');this.bootloadAttachments();};db.prototype.allowOGTagPreview=function(){"use strict";return true;};db.prototype._sendSetEveryonePrivacyImpression=function(){"use strict";new i('/ajax/privacy/reminders/set_everyone_privacy_impression').send();};db.prototype.onEmptyStatusCallback=function(){"use strict";var eb=this._getTextArea();z.set(eb);la.set({target:eb,message:ra._("This status update appears to be blank. Please write something or attach a link or photo to update your status."),position:'below',alignh:'left'});new ha().addSubscriptions(y.listen(this.getRoot(),'success',function(){la.clear(this._getTextArea());}.bind(this)),h.subscribe('composer/publish',function(event,fb){if(fb.composer_id!=this.getComposerID())return;la.clear(this._getTextArea());}.bind(this)));};db.setBootloadedContent=function(eb,fb){"use strict";var gb=za[eb];if(gb)gb.setBootloadedContent.call(gb,fb);};db.onEmptyStatusListener=function(eb){"use strict";var fb=za[eb];if(fb)fb.onEmptyStatusCallback.call(fb);};na(db.prototype,{_attachmentIsActive:false,_bootloading:false,_modulesAreBootloaded:false,_fullVersion:false,_focusListener:null,_privacyWidgetTags:null,_scraper:null,_dragdrop:null,_bootloadCallback:null,attachmentClassName:"_4j"});e.exports=db;},null);
__d("ComposerXMentionsInputReset",["DOMQuery","Input"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){var k=g.scry(j.element,'textarea.input')[0];j.instance.reset();h.reset(k);}e.exports=i;},null);
__d("ComposerXOGTaggerIconReset",["CSS","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){g.removeClass(j.element,"_4-jh");g.removeClass(j.element,"_509o");}e.exports=i;},null);
__d("ComposerXPrivacyWidgetReset",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){g.inform('Composer/changedtags',{withTags:[],mention:{},eventTag:false});}e.exports=h;},null);
__d("ComposerXTaggerIconReset",["CSS","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){g.removeClass(j.element,"_1dsa");g.removeClass(j.element,"_1dsb");g.removeClass(j.element,"_509o");}e.exports=i;},null);
__d("ViewportTrackingHelper",["Event","DOMDimensions","Vector"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={getScrollListener:function(k){return g.listen(window,'scroll',k);},looseIsVisible:function(k,l){if(!k.x&&!k.y&&!k.width&&!k.height)return false;var m=i.getScrollPosition().y,n=h.getViewportDimensions().height,o=n+l-m;return k.y<o;},isVisible:function(k,l){if(!k.x&&!k.y&&!k.width&&!k.height)return false;var m=h.getViewportDimensions().height,n=Math.max(k.y,0),o=Math.min(k.y+k.height,m),p=Math.min(k.height,l);return (o-n)>=p;},isDescendantOf:function(k,l){if(k===l)return k;while(k&&k.parentNode){if(k.parentNode===l)return k;k=k.parentNode;}return false;}};e.exports=j;},null);
__d("ViewportTracking",["Arbiter","AsyncSignal","Banzai","BanzaiScuba","CSS","cx","CurrentUser","DOM","DOMDimensions","Event","LitestandMessages","NavigationMessage","Run","SubscriptionsHandler","UserActivity","Vector","ViewportTrackingHelper","clickRefAction","collectDataAttributes","copyProperties","debounce","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();var da=97,ea=51,fa='vpv',ga='/feed/feed_tracking/vpv_waterfall_logging',ha=3,ia=2,ja=1,ka=0,la=1,ma=2,na=3,oa=4;function pa(){"use strict";}pa.prototype.init=function(qa){"use strict";this.useBanzai=true;this.viewportHeightRatio=qa.viewport_height_ratio?qa.viewport_height_ratio:.25;this.vpvDebug=!!qa.vpv_debug;this.vpvdDebug=!!qa.vpvd_debug;this.vpvdAnalysis=!!qa.vpvd_analysis;this.useWaterfallLogging=!!qa.waterfall_logging;this.loggedStoryIDs={};this.readStoryIDs={};this.annotatedStoryIDs={};this.minSizeToBeVisible=200;this.minFractionToBeVisibleForTimetracking=.5;this.scrollThrottlingInterval=100;this.mouseThrottlingInterval=100;this.keyboardThrottlingInterval=100;this.minTimeToReportImmediately=500;this.discardVPVDIntervalThreshold=90000;this.active_state_duration=1000;this.height_diff_to_change_state=25;this.focused_state_duration=3500;this.invalidateAllStoriesCache();this.cachedViewportHeight=o.getViewportDimensions().height;this.isTimetrackingEnabled=0;this.activeStories={};this.userInactiveLock=false;this.userActivityPollerTimeoutID=-1;this._headLoadStoryCount=0;this.getDataFromConfig(qa);if(this.isTimetrackingEnabled){this.lastMouseX=-1;this.lastMouseY=-1;this.lastStreamY=-1;this.latestStreamYChangedTimeStamp=-1;this.userFocus=ma;this.latestUserFocus=ma;this.latestUserActivity='init';this.focusedStory=null;this.latestFocusedStory=null;this.latestActiveStory=null;this.totalVPVDuration={};}this.isLoose=!!qa.is_loose;this.maxScrollPosition=0;if(qa.tracking_duration_config){this.scrollThrottlingInterval=qa.tracking_duration_config.scroll_throttling_interval;this.mouseThrottlingInterval=qa.tracking_duration_config.mouse_throttling_interval;this.keyboardThrottlingInterval=qa.tracking_duration_config.keyboard_throttling_interval;this.userActivityPollingInterval=qa.tracking_duration_config.user_activity_polling_interval;this.timeToBeConsideredInactive=qa.tracking_duration_config.time_to_be_considered_inactive;this.minFractionToBeVisibleForTimetracking=qa.tracking_duration_config.min_fraction_to_be_visible;this.minTimeToReportImmediately=qa.tracking_duration_config.min_time_to_report_immediately;this.active_state_duration=qa.tracking_duration_config.active_state_duration;this.height_diff_to_change_state=qa.tracking_duration_config.story_height_diff_to_change_state;this.focused_state_duration=qa.tracking_duration_config.focused_state_duration;this.discardVPVDIntervalThreshold=qa.tracking_duration_config.discard_vpvd_interval_threshold;}var ra,sa=aa(this.fireTimer,this.getTimeout(),this);if(this.isLoose){this.minSizeToBeVisible=0;ra=ca(function(){this.maxScrollPosition=Math.max(this.maxScrollPosition,v.getScrollPosition().y);sa();}.bind(this));}else ra=sa;this.initialStories=this.getStoriesInView();this.initialStoriesLogged=false;if(this.annotatedVPVLogging)this.initialStories.forEach(this.logAnnotatedVPV,this);if(this.useWaterfallLogging)this.getStoriesInView().forEach(function(wa){this.waterfallLogStep(wa,'100_all_stories_in_view_ignore_height',true);},this);this.vpvHeartBeatInterval=qa.vpv_heartbeat_interval;this.passVPVHeartbeatGK=qa.use_vpv_heartbeat;if(this.passVPVHeartbeatGK){this.intervalCount=1;this.fireTimerCount=1;this.storiesInView=this.initialStories?this.initialStories:this.getStoriesInView();this.vpvHeartBeatIntervalSignal=setInterval(function(){this._sendSignal('interval');}.bind(this),this.vpvHeartBeatInterval);}this.subscriptions=new t();this.subscriptions.addSubscriptions(this._getScrollListener(ra),p.listen(window,'resize',function(){this.invalidateVisibleStoriesCache();this.cachedViewportHeight=o.getViewportDimensions().height;ra();}.bind(this)),p.listen(window,'focus',function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,'window_focus');}.bind(this)),p.listen(window,'blur',function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(true,'window_blur');}.bind(this)),g.subscribe(r.NAVIGATION_BEGIN,this.cleanup.bind(this)),g.subscribe('Stream/totalHeadLoadedStories',function(wa,xa){this._headLoadStoryCount=xa.count;}.bind(this)),g.subscribe(q.STORIES_INSERTED,function(){if(!this.initialStoriesLogged){var wa=this.getStoriesInView();wa.forEach(this.logAnnotatedVPV,this);}else ra();if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,'stories_inserted');}.bind(this)));if(this.isTimetrackingEnabled){this.updateTimeTrackingData(false,'init');var ta=ca(function(event){this.invalidateVisibleStoriesCache();this.handleScroll(event);}.bind(this),this.scrollThrottlingInterval),ua=ca(function(event){this.handleKeyboard(event);}.bind(this),this.keyboardThrottlingInterval),va=ca(function(event){this.handleMouse(event);}.bind(this),this.mouseThrottlingInterval);this.subscriptions.addSubscriptions(p.listen(window,'scroll',ta),p.listen(document.documentElement,'DOMMouseScroll',ta),p.listen(document.documentElement,'mousewheel',ta));this.subscriptions.addSubscriptions(p.listen(document.documentElement,'keydown',ua));this.subscriptions.addSubscriptions(p.listen(document.documentElement,'mouseover',va),p.listen(document.documentElement,'mousemove',va));this.subscriptions.addSubscriptions(g.subscribe('Event/stop',function(wa,xa){this.handleMouse(xa.event);}.bind(this)));this.subscriptions.addSubscriptions(p.listen(document.documentElement,'click',function(event){this.handleMouse(event);}.bind(this)),g.subscribe('PhotoSnowlift.OPEN',function(){this.userFocus=na;this.handleLayers();}.bind(this)),g.subscribe('PhotoSnowlift.CLOSE',function(){this.userFocus=la;this.focusedStory=null;this.updateTimeTrackingData(false,'snowlift_close');}.bind(this)));this._userActivityPoller();}s.onLeave(this.cleanup.bind(this));s.onUnload(this.cleanup.bind(this));};pa.prototype._getScrollListener=function(qa){"use strict";return p.listen(window,'scroll',qa);};pa.prototype.cleanup=function(){"use strict";if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}if(this.isTimetrackingEnabled){clearTimeout(this.userActivityPollerTimeoutID);this.updateTimeTrackingData(true,'cleanup');}if(this.passVPVHeartbeatGK)clearInterval(this.vpvHeartBeatIntervalSignal);if(this.annotatedVPVLogging){var qa=this.getStoriesInView();qa.forEach(this.logAnnotatedVPV,this);}this.initialStories=[];this._headLoadStoryCount=0;};pa.prototype.fireTimer=function(){"use strict";if(this.useWaterfallLogging){var qa=this.getStoriesInViewIgnoreHeight();qa.forEach(function(ra){this.waterfallLogStep(ra,'100_all_stories_in_view_ignore_height');},this);}if(!this.initialStoriesLogged){this.initialStories.forEach(this.markStoryRead,this);this.initialStoriesLogged=true;}this.storiesInView=this.getStoriesInView();this.storiesInView.forEach(this.markStoryRead,this);if(this.passVPVHeartbeatGK)this._sendSignal('fireTimer');};pa.prototype.heartBeatIsEnabled=function(){"use strict";return false;};pa.prototype.getSessionID=function(){"use strict";return null;};pa.prototype._sendSignal=function(qa){"use strict";if(!this.heartBeatIsEnabled())return;var ra=-1;if(qa=='interval'){ra=this.intervalCount++;}else if(qa=='fireTimer')ra=this.fireTimerCount++;var sa=-1,ta=-1,ua=-1;if(this.storiesInView.length>0){sa=this.getStoryID(this.storiesInView[0]);ta=this.getQueryID(this.storiesInView[0]);ua=this.getFBFeedLocations(this.storiesInView[0]);}var va=new j('vpv_heartbeat_js');va.addInteger('qid',ta);va.addInteger('uid',m.getID());va.addInteger('firststoryid',sa);va.addInteger('time',Math.round(Date.now()/1000));va.addNormal('type',qa);va.addInteger('count',ra);va.addInteger('fbfeed_location',ua);va.post();};pa.prototype._userActivityPoller=function(){"use strict";if(!this.userInactiveLock&&!u.isActive(this.timeToBeConsideredInactive)){this.userInactiveLock=true;this.userFocus=ma;this.updateTimeTrackingData(false,'user_activity_inactive');u.subscribeOnce(function(){this.userFocus=la;this.updateTimeTrackingData(false,'user_activity_active');this.userInactiveLock=false;}.bind(this));}this.userActivityPollerTimeoutID=setTimeout(this._userActivityPoller.bind(this),this.userActivityPollingInterval);};pa.prototype.getQueryID=function(qa){"use strict";return -1;};pa.prototype.getFBFeedLocations=function(qa){"use strict";return -1;};pa.prototype.getFBFeedInsertionPosition=function(qa){"use strict";return -1;};pa.prototype.createVPVDTimer=function(qa){"use strict";var ra=document.createElement("Label");ra.setAttribute("for",qa);ra.setAttribute("class",'vpvd_debug_timer');return ra;};pa.prototype.updateVPVDTimer=function(qa){"use strict";var ra=this.activeStories[qa].story,sa=n.scry(ra,'.vpvd_debug_timer');if(!sa.length){sa=[this.createVPVDTimer(ra),this.createVPVDTimer(ra)];var ta=n.scry(ra,'.UFIRow');if(ta.length&&ta[ta.length-1].clientWidth>0){ta[ta.length-1].appendChild(sa[0]);}else ra.appendChild(sa[0]);ra.insertBefore(sa[1],ra.firstChild);}var ua=this.totalVPVDuration[qa],va=Math.floor(ua/1000)+'.'+Math.floor((ua%1000)/100);n.setContent(sa[0],va);n.setContent(sa[1],va);};pa.prototype.updateVPVDTimers=function(){"use strict";for(var qa in this.activeStories)if(this.activeStories.hasOwnProperty(qa))this.updateVPVDTimer(qa);};pa.prototype.logVpvdAnalysis=function(qa,ra,sa,ta,ua,va){"use strict";var wa=new j('vpv_duration');wa.addDenorm('qid',this.getQueryID(this.activeStories[qa].story));wa.addDenorm('uid',m.getID());wa.addDenorm('vsid',qa);wa.addInteger('time',Math.round(Date.now()/1000));wa.addInteger('duration',ta);wa.addInteger('total_duration',ua);wa.addNormal('story_state',this.activeStories[qa].state);wa.addNormal('is_active_state',sa);wa.addNormal('num_visible_stories',this.numVisibleStories);wa.addInteger('story_height',this.activeStories[qa].story_height);wa.addInteger('story_visible_height',this.activeStories[qa].height);wa.addInteger('state_visible_height',va);wa.addInteger('total_visible_height',this.totalVisibleHeight);wa.addInteger('total_height',this.totalHeight);wa.addNormal('user_focus',this.latestUserFocus);wa.addNormal('next_user_focus',this.userFocus);wa.addInteger('vpvd',ra);wa.addInteger('accumulated_vpvd',this.activeStories[qa].vpvd);wa.addNormal('user_activity',this.latestUserActivity);wa.addNormal('next_user_activity',this.userActivity);wa.addInteger('story_position_y',this.activeStories[qa].y);wa.addInteger('feed_insertion_position',this.getFBFeedInsertionPosition(this.activeStories[qa].story));wa.addNormal('visible_position',this.activeStories[qa].visible_position);wa.addNormal('is_focused_story',this.activeStories[qa].is_focused);wa.post();};pa.prototype.shouldDiscardStory=function(qa){"use strict";return this.activeStories[qa].height!=this.activeStories[qa].story_height&&this.activeStories[qa].height<this.totalHeight/2;};pa.prototype.calculateTotalHeight=function(){"use strict";this.totalHeight=0;for(var qa in this.activeStories)if(this.activeStories.hasOwnProperty(qa))this.totalHeight+=this.activeStories[qa].height;};pa.prototype.updateVPVDurations=function(qa){"use strict";if(this.latestUserFocus===ma||qa-this.latestTimeTrackingTimestamp>this.discardVPVDIntervalThreshold)return;var ra={1:0,2:0,3:0},sa=(qa-this.latestTimeTrackingTimestamp>=this.focused_state_duration);this.totalVisibleHeight=0;for(var ta in this.activeStories)if(this.activeStories.hasOwnProperty(ta))if(!(this.latestUserFocus===la&&sa&&this.shouldDiscardStory(ta))){ra[this.activeStories[ta].state]+=this.activeStories[ta].height;this.totalVisibleHeight+=this.activeStories[ta].height;}var ua=0,va=qa-this.latestTimeTrackingTimestamp;if(this.latestUserFocus===la){va=ra[ha]>0?this.focused_state_duration:this.active_state_duration;va=Math.min(va,qa-this.latestTimeTrackingTimestamp);ua=(qa-this.latestTimeTrackingTimestamp)-va;}var wa=0,xa=ha;for(var ya=ha;ya>=ja;ya--)if(ra[ya]>0){wa=ra[ya];xa=ya;break;}var za=ra[ha]+ra[ia]+ra[ja],ab=0;for(ta in this.activeStories)if(this.activeStories.hasOwnProperty(ta)){if(this.latestUserFocus===la&&sa&&this.shouldDiscardStory(ta))continue;if(wa>0&&this.activeStories[ta].state>=xa){ab=va*(this.activeStories[ta].height/wa);if(this.vpvdAnalysis&&va>0)this.logVpvdAnalysis(ta,ab,true,va,va+ua,wa);this.activeStories[ta].vpvd+=ab;this.totalVPVDuration[ta]+=ab;}if(za>0){ab=ua*(this.activeStories[ta].height/za);if(this.vpvdAnalysis&&ua>0)this.logVpvdAnalysis(ta,ab,false,ua,va+ua,za);this.activeStories[ta].vpvd+=ab;this.totalVPVDuration[ta]+=ab;}}};pa.prototype.updateActiveStory=function(qa,ra,sa,ta){"use strict";this.activeStories[qa].state=ra;this.activeStories[qa].ts=sa;this.activeStories[qa].height_snapshot=ta[qa].height;this.activeStories[qa].is_focused=this.focusedStory===ta[qa].story;this.activeStories[qa].story_height=ta[qa].story_height;if(this.vpvdAnalysis){this.activeStories[qa].visible_position=ta[qa].visible_position;this.activeStories[qa].y=ta[qa].y;}};pa.prototype.updateActiveStories=function(qa,ra){"use strict";for(var sa in qa)if(qa.hasOwnProperty(sa))if(sa in this.activeStories){this.activeStories[sa].height=qa[sa].height;var ta=qa[sa].height-this.activeStories[sa].height_snapshot;if(this.focusedStory===qa[sa].story){this.updateActiveStory(sa,ha,ra,qa);}else if(ta<=-this.height_diff_to_change_state){this.updateActiveStory(sa,this.shouldDiscardStory(sa)?ka:ja,ra,qa);}else if(ta>=this.height_diff_to_change_state||this.activeStories[sa].is_focused||this.activeStories[sa].height===this.activeStories[sa].story_height)this.updateActiveStory(sa,ia,ra,qa);}else{this.activeStories[sa]={evp_ts:ra,story:qa[sa].story,height:qa[sa].height,vpvd:0};if(!this.totalVPVDuration[sa])this.totalVPVDuration[sa]=0;this.updateActiveStory(sa,ia,ra,qa);}};pa.prototype.recordVPVDurations=function(qa,ra){"use strict";for(var sa in this.activeStories)if(this.activeStories.hasOwnProperty(sa))if(ra||!(sa in qa)){if(this.activeStories[sa].vpvd>this.focused_state_duration||this.activeStories[sa].vpvd===this.totalVPVDuration[sa])this.recordTimeStoryWasInView(this.activeStories[sa]);delete this.activeStories[sa];}};pa.prototype.updateTimeTrackingData=function(qa,ra){"use strict";this.userActivity=ra;if(!this.activeStories)this.activeStories={};var sa=Date.now();if(!this.latestTimeTrackingTimestamp)this.latestTimeTrackingTimestamp=sa;var ta=this.getVisibleStoriesFromCache();this.calculateTotalHeight();this.updateVPVDurations(sa);this.updateActiveStories(ta,sa);if(this.vpvdDebug)this.updateVPVDTimers();this.recordVPVDurations(ta,qa);if(qa){this.latestTimeTrackingTimestamp=0;}else this.latestTimeTrackingTimestamp=sa;this.latestUserActivity=this.userActivity;this.latestUserFocus=this.userFocus;if(this.focusedStory)this.latestActiveStory=this.focusedStory;this.latestFocusedStory=this.focusedStory;this.focusedStory=null;};pa.prototype.needsToUpdateTimeTrackingData=function(){"use strict";return !(this.latestUserFocus===this.userFocus&&(this.userFocus===ma||(this.userFocus===la&&!this.latestFocusedStory&&!this.focusedStory)));};pa.prototype.getfocusedStory=function(qa){"use strict";var ra=this.getVisibleStoriesFromCache();for(var sa in ra)if(ra.hasOwnProperty(sa))if(w.isDescendantOf(qa,ra[sa].story))return ra[sa].story;return null;};pa.prototype.handleLayers=function(){"use strict";if(this.userFocus===na||this.userFocus===oa){this.focusedStory=this.latestActiveStory;this.updateTimeTrackingData(false,'media_layer');return true;}return false;};pa.prototype.didInteractWithStream=function(qa){"use strict";return w.isDescendantOf(qa,this.getStream())||w.isDescendantOf(this.getStream(),qa);};pa.prototype.handleScroll=function(event){"use strict";if(this.handleLayers())return;var qa=Date.now(),ra=ba(this.getStream()).y;if(ra!=this.lastStreamY||qa-this.latestStreamYChangedTimeStamp<2.5*this.scrollThrottlingInterval||this.didInteractWithStream(event.target)){this.latestStreamYChangedTimeStamp=qa;this.userFocus=la;}else this.userFocus=ma;this.lastStreamY=ra;if(this.userFocus===la||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,'scroll');};pa.prototype.handleKeyboard=function(event){"use strict";if(this.handleLayers())return;if(this.didInteractWithStream(event.target)){this.userFocus=la;this.focusedStory=this.getfocusedStory(event.target);}else if(k.hasClass(event.target,'shareInput')){this.userFocus=la;this.focusedStory=this.latestActiveStory;}else this.userFocus=ma;if(this.userFocus===la||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,'keyboard');};pa.prototype.handleMouse=function(event){"use strict";if(this.handleLayers())return;if(event.type!='click'&&event.clientX===this.lastMouseX&&event.clientY===this.lastMouseY)return;if(event.type==='click')this.invalidateVisibleStoriesCache();if(this.didInteractWithStream(event.target)){this.userFocus=la;this.focusedStory=this.getfocusedStory(event.target);}else this.userFocus=ma;this.lastMouseX=event.clientX;this.lastMouseY=event.clientY;if(this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,event.type);};pa.prototype.getStoriesInView=function(){"use strict";var qa=this.getAllStories(),ra=[],sa=false;for(var ta=0;ta<qa.length;ta++){var ua=qa[ta],va=this.getStoryID(ua);if(this.hasBeenVisible(va))continue;if(this.isVisible(ua)){if(ua.getAttribute('data-insertion-position')===null)ua.setAttribute('data-insertion-position',ta-this._headLoadStoryCount);ra.push(ua);sa=true;}else if(sa)break;}return ra;};pa.prototype.getStoriesInViewIgnoreHeight=function(){"use strict";var qa=this.getAllStories(),ra=false,sa=[];for(var ta=0;ta<qa.length;ta++){var ua=qa[ta];if(this.isVisible(ua,false,0)){sa.push(ua);ra=true;}else if(ra)break;}return sa;};pa.prototype.getAllStoriesFromCache=function(){"use strict";if(this.cachedAllStories===null)this.cachedAllStories=this.getAllStories();return this.cachedAllStories;};pa.prototype.invalidateAllStoriesCache=function(){"use strict";this.cachedAllStories=null;this.invalidateVisibleStoriesCache();};pa.prototype.getVisibleStoriesFromCache=function(){"use strict";if(this.cachedVisibleStories===null)this.cachedVisibleStories=this.getAllStoriesInView();return this.cachedVisibleStories;};pa.prototype.invalidateVisibleStoriesCache=function(){"use strict";this.cachedVisibleStories=null;};pa.prototype.getAllStoriesInView=function(){"use strict";var qa=this.getAllStoriesFromCache(),ra={},sa=false,ta=0,ua=qa.length,va=1,wa=qa.length;if(this._indexOfLastVisibleStoryOnPreviousPass>ua/2){ta=ua-1;ua=-1;va=-va;}for(var xa=ta;xa!=ua;xa+=va){var ya=qa[xa],za=this.getHeightIfVisible(ya,false,Math.min(this.minSizeToBeVisible,this.minFractionToBeVisibleForTimetracking*o.getElementDimensions(ya).height));if(za>0||ya===this.focusedStory){if(ya.getAttribute('data-insertion-position')===null)ya.setAttribute('data-insertion-position',xa-this._headLoadStoryCount);var ab=this.getStoryID(ya);ra[ab]={story:ya,height:za,story_height:o.getElementDimensions(ya).height};sa=true;if(this.vpvdAnalysis){ra[ab].y=ba(ya).y;ra[ab].visible_position=xa;wa=Math.min(wa,xa);}}else if(sa){this._indexOfLastVisibleStoryOnPreviousPass=xa-va;break;}}if(this.vpvdAnalysis){this.numVisibleStories=0;for(ab in ra)if(ra.hasOwnProperty(ab)){ra[ab].visible_position-=wa;this.numVisibleStories++;}}return ra;};pa.prototype.getTimetrackingDataToLog=function(qa){"use strict";var ra={evt:da,vpvd_start_timestamp:qa.evp_ts,vpvd_time_delta:Math.round(qa.vpvd),story_height:o.getElementDimensions(qa.story).height,viewport_height:this.cachedViewportHeight};return {ft:ra};};pa.prototype.recordTimeStoryWasInView=function(qa){"use strict";if(this.isTimetrackingEnabled&&qa.vpvd>0){var ra=this.getTimetrackingDataToLog(qa),sa=y(qa.story,['ft']);z(ra.ft,sa.ft);var ta=!!sa.ft.ei&&(ra.ft.vpvd_time_delta>this.minTimeToReportImmediately);delete ra.ei;this.sendDataToLog(qa.story,ra,ta);}};pa.prototype.hasBeenVisible=function(qa){"use strict";return qa in this.readStoryIDs;};pa.prototype.isVisible=function(qa,ra,sa){"use strict";return this.getHeightIfVisible(qa,ra,sa)>0;};pa.prototype.getHeightIfVisible=function(qa,ra,sa){"use strict";if(ra===(void 0))ra=this.isLoose;if(sa===(void 0))sa=this.minSizeToBeVisible;var ta=v.getScrollPosition().y,ua=o.getViewportDimensions().height,va=ba(qa),wa=o.getElementDimensions(qa),xa=ua+this.maxScrollPosition-ta;if(!va.x&&!va.y&&!wa.x&&!wa.y)return false;if(ra&&va.y<xa)return true;var ya=Math.max(va.y,0),za=Math.min(va.y+wa.height,ua),ab=Math.min(wa.height,sa);return (za-ya)>=ab?(za-ya):0;};pa.prototype.getHeightInViewport=function(qa){"use strict";var ra=o.getViewportDimensions().height,sa=ba(qa),ta=o.getElementDimensions(qa);if(!sa.x&&!sa.y&&!ta.x&&!ta.y)return false;var ua=Math.max(sa.y,0),va=Math.min(sa.y+ta.height,ra);return va-ua;};pa.prototype.sendDataToLog=function(qa,ra,sa){"use strict";if(this.useBanzai){var ta={};if(sa)ta.delay=3000;var ua=this.getSessionID();if(ua)ra.ft.session_id=ua;if(this.useWaterfallLogging&&ra.ft.evt==ea){ra.ft.should_waterfall_logging=1;ra.ft["interface"]='www';var va=!this.initialStoriesLogged;this.waterfallLogStep(qa,'200_sent_to_banzai',va);}i.post('feed_tracking',ra,ta);}else x(fa,qa,null,'FORCE',ra);};pa.prototype.waterfallLogStep=function(qa,ra,sa){"use strict";var ta=this.getStoryID(qa);if(this.loggedStoryIDs[ra]&&this.loggedStoryIDs[ra][ta])return;var ua=this.getWaterfallData(qa,ra,sa);new h(ga,ua).send();if(!this.loggedStoryIDs[ra])this.loggedStoryIDs[ra]={};this.loggedStoryIDs[ra][ta]=true;};pa.prototype.getWaterfallData=function(qa,ra,sa){"use strict";var ta=this.getDataToLog(qa),ua=y(qa,['ft']);z(ta.ft,ua.ft);var va=ta.ft;va.height_in_viewport=this.getHeightInViewport(qa);va.step=ra;va.is_initial_story=sa?1:0;va["interface"]='www';return va;};pa.prototype.addSeenClassToStory=function(qa){"use strict";k.addClass(qa,"_50nb");k.removeClass(qa,"_50mx");k.removeClass(qa,"_2z-5");};pa.prototype.markStoryRead=function(qa){"use strict";var ra=this.getStoryID(qa);if(!ra||this.hasBeenVisible(ra))return;this.readStoryIDs[ra]=true;this.annotatedStoryIDs[ra]=true;var sa=this.getDataToLog(qa),ta=y(qa,['ft']);z(sa.ft,ta.ft);delete sa.ei;this.sendDataToLog(qa,sa,false);k.addClass(qa,"_x72");if(this.vpvDebug)k.addClass(qa,"_5m7s");this.addSeenClassToStory(qa);};pa.prototype.logAnnotatedVPV=function(qa){"use strict";var ra=this.getStoryID(qa);if(!ra||ra in this.annotatedStoryIDs)return;this.annotatedStoryIDs[ra]=true;var sa=this.getDataToLog(qa),ta=y(qa,['ft']);z(sa.ft,ta.ft);delete sa.ei;sa.ft.vpv_ft_only=1;this.sendDataToLog(qa,sa,false);};e.exports=pa;},null);
__d("XFamilyMentionsNUXDialogController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/family_mentions\/nux_dialog\/",{__asyncDialog:{type:"Int"}});},null);
__d("FamilyRelationshipMentions",["AsyncDialog","AsyncRequest","FamilyMentionsData","XFamilyMentionsNUXDialogController"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=(function(){var l={},m=false;l.shouldShowNUX=function(n){if(i.hasAcceptedNUX||m)return false;var o=n.family_names;if(o==(void 0))return false;for(var p=0;p<o.length;p++)if(o[p]==n.text)return true;return false;};l.showNUX=function(n,o){var p=j.getURIBuilder().getURI();g.send(new h(p),function(q){q.subscribe('cancel',function(){n.text=n.default_name;o(n);});q.subscribe('confirm',function(){m=true;new h().setURI('/ajax/family_mentions/confirm_nux').send();o(n);q.finishHide();});});};return l;})();e.exports=k;},null);
__d("MentionsTypeaheadAreaView",["ContextualTypeaheadView","FamilyRelationshipMentions","Parent"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();for(var j in g)if(g.hasOwnProperty(j))l[j]=g[j];var k=g===null?null:g.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=g;function l(){"use strict";if(g!==null)g.apply(this,arguments);}l.prototype.getContext=function(){"use strict";return i.byClass(this.element,'uiMentionsInput');};l.prototype.shouldValidateTypeaheadSelection=function(m){"use strict";return h.shouldShowNUX(m);};l.prototype.validateTypeaheadSelection=function(m,n){"use strict";h.showNUX(m,n);};e.exports=l;},null);